var O=Object.defineProperty;var B=(t,e,s)=>e in t?O(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var g=(t,e,s)=>(B(t,typeof e!="symbol"?e+"":e,s),s);import"../common.006007ed.js";import{M,g as D,m as b,j as k,n as A}from"../three.988821a1.js";import{M as G,H,A as S}from"../Vis.es.824ecc78.js";import"../vis-three.8be35a0c.js";const r=class extends S{constructor({objects:e,engine:s}){super();this.oldObjects=[].concat(r.cacheSection),this.newObjects=[].concat(e),this.engine=s,r.cacheSection=[].concat(e)}next(){this.engine.setSelectionBox({objects:this.newObjects}),r.status=!0}prev(){this.engine.setSelectionBox({objects:this.oldObjects}),r.status=!0}};let n=r;g(n,"status",!1),g(n,"cacheSection",[]);class K extends S{constructor({transformControls:e}){super();this.nextState={mode:"translate",space:"world",tranform:"",objectMap:new Map},this.prevState={mode:"translate",space:"world",tranform:"",objectMap:new Map},this.transfromControls=e}generate(e){const s=this.transfromControls,p=s.mode,d=p==="rotate"?"rotation":p==="translate"?"position":p,z=s.getTransObjectSet(),h=this[`${e}State`];h.mode=p,h.tranform=d,h.space=s.space;const L=h.objectMap;z.forEach(o=>{L.set(o,{x:o[d].x,y:o[d].y,z:o[d].z})}),this[e]=function(){const o=this.transfromControls,l=this[`${e}State`];o.mode=l.mode,o.space=l.space;const u=l.tranform,x=[];l.objectMap.forEach((f,a)=>{a[u].x=f.x,a[u].y=f.y,a[u].z=f.z,a.updateMatrixWorld(),x.push(a)}),o.setAttach(...x)}}}const c=new G().setDom(document.getElementById("app")).setSize().setStats(!0).play(),m=new H(50);c.keyboardManager.register({shortcutKey:["ctrl","z"],desp:"undo",keyup:t=>{t==null||t.preventDefault(),m.undo()}}).register({shortcutKey:["ctrl","y"],desp:"redo",keyup:t=>{t==null||t.preventDefault(),m.redo()}});const y=c.scene,j=new M(new D(10,10,10),new b({color:"rgb(255, 105, 100)"}));j.position.x=10;y.add(j);const C=new M(new k(5,32,32),new b({color:"rgb(255, 205, 100)"}));C.position.x=-10;y.add(C);const E=new A("rgb(255, 255, 255)",1,300,0);E.position.y=30;y.add(E);c.addEventListener("selected",t=>{if(n.status){n.status=!1;return}!n.cacheSection.length&&!t.objects.length||m.apply(new n({objects:t.objects,engine:c}))});const w=c.transformControls;let i="";w.addEventListener("mouseDown",t=>{i=new K({transformControls:w}),i.generate("prev")});w.addEventListener("mouseUp",t=>{i.generate("next"),m.apply(i),i=""});
