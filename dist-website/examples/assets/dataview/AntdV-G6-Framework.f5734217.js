import{C as F,D as K,g as o,E as l}from"../Vis.es.7c5541b7.js";import{D as U}from"../three.b54e9ae7.js";import{r as X,a as Z,i as ee,G as Y}from"../G6.bd27ca46.js";import{v as te}from"../v4.90f1a8cc.js";import"../vis-three.36482fbe.js";import"../Antd.4efcd57f.js";const ae={A:"#9CFC72",B:"#44A5FF",C:"#FFBE4C"},ne={nodes:[{id:"1",label:"Company1"},{id:"2",label:"Company2"},{id:"3",label:"Company3"},{id:"4",label:"Company4"},{id:"5",label:"Company5"},{id:"8",label:"Company8"},{id:"9",label:"Company9"}],edges:[{source:"1",target:"2",data:{type:"A",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"1",target:"3",data:{type:"B",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"2",target:"5",data:{type:"C",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"3",target:"4",data:{type:"C",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"1",target:"8",data:{type:"B",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"1",target:"9",data:{type:"C",amount:"100,000 Yuan",date:"2019-08-03"}}]};X("round-rect",{drawShape:function(t,i){const n=t.style.width,a=t.style.stroke,c=i.addShape("rect",{attrs:{x:-n/2,y:-15,width:n,height:30,radius:15,stroke:a,lineWidth:3,fillOpacity:1},name:"rect-shape"});return i.addShape("circle",{attrs:{x:-n/2,y:0,r:3,fill:a},name:"circle-shape"}),i.addShape("circle",{attrs:{x:n/2,y:0,r:3,fill:a},name:"circle-shape2"}),c},getAnchorPoints:function(){return[[0,.5],[1,.5]]},update:function(t,i){const a=i.getContainer().get("children"),c=a[0],m=a[1],p=a[2],g=t.style.stroke;g&&(c.attr("stroke",g),m.attr("fill",g),p.attr("fill",g))}},"single-node");Z("fund-polyline",{itemType:"edge",draw:function(t,i){const n=t.startPoint,a=t.endPoint,c=a.y-n.y,m=c!==0?Math.min(500/Math.abs(c),20):0,p=m>15?0:16,g=c<0?p:-p,y={x:n.x+m,y:a.y+g},u={x:y.x+p,y:a.y},A={x:(y.x-n.x)*(a.y-n.y)/(y.y-n.y)+n.x,y:a.y};let T=[["M",n.x,n.y],["L",y.x,y.y],["Q",A.x,A.y,u.x,u.y],["L",a.x,a.y]];Math.abs(c)<=5&&(T=[["M",n.x,n.y],["L",a.x,a.y]]);const z=(t==null?void 0:t.style)&&t.style.endArrow?t.style.endArrow:!1;ee(z)&&(z.fill=stroke);const P=i.addShape("path",{attrs:{path:T,stroke:ae[t.data&&t.data.type],lineWidth:3,endArrow:z},name:"path-shape"}),b=0,G=8,J=i.addShape("text",{attrs:{text:t.data&&t.data.amount,x:u.x+b,y:a.y-G-2,fontSize:14,textAlign:"left",textBaseline:"middle",fill:"white"},name:"text-shape-amount"});return i.addShape("text",{attrs:{text:t.data&&t.data.type,x:u.x+b,y:a.y-G-J.getBBox().height-2,fontSize:10,textAlign:"left",textBaseline:"middle",fill:"white"},name:"text-shape-type"}),i.addShape("text",{attrs:{text:t.data&&t.data.date,x:u.x+b,y:a.y+G+4,fontSize:12,fontWeight:300,textAlign:"left",textBaseline:"middle",fill:"white"},name:"text-shape-date"}),P}});const v=document.createElement("div");v.style.width="1024px";v.style.height="1024px";v.style.position="absolute";v.style.opacity=0;v.className="g6-tree";document.body.appendChild(v);const I=new Y({container:v,layout:{type:"dagre",rankdir:"LR",nodesep:30,ranksep:100},fitView:!0,modes:{default:["drag-canvas"]},defaultNode:{type:"round-rect",labelCfg:{style:{fill:"white",fontSize:10}},style:{stroke:"#72CC4A",width:150}},defaultEdge:{type:"fund-polyline"}});I.data(ne);I.render();const k=["rgb(91, 143, 249)","rgb(90, 216, 166)","rgb(93, 112, 146)","rgb(246, 189, 22)","rgb(232, 104, 74)","rgb(109, 200, 236)","rgb(146, 112, 202)","rgb(255, 157, 77)","rgb(38, 154, 153)","rgb(227, 137, 163)"],x=document.createElement("div");x.style.width="1024px";x.style.height="1024px";x.style.position="absolute";x.style.opacity=0;x.className="g6-tree";document.body.appendChild(x);const h=new Y({container:x,linkCenter:!0,fitView:!0,modes:{default:[{type:"edge-tooltip",formatText:function(t){return"source: "+t.sourceName+"<br/> target: "+t.targetName}}]},defaultNode:{style:{opacity:.8,lineWidth:1,stroke:"#999"}},defaultEdge:{size:1,color:"#e2e2e2",style:{opacity:.6,lineAppendWidth:3}}});h.on("edge:mouseenter",function(e){const t=e.item;h.setItemState(t,"hover",!0)});h.on("edge:mouseleave",function(e){const t=e.item;h.setItemState(t,"hover",!1)});const se=1024,$=1024;fetch("https://gw.alipayobjects.com/os/basement_prod/70cde3be-22e8-4291-98f1-4d5a5b75b62f.json").then(e=>e.json()).then(e=>{const t=e.edges,i=e.nodes,n=new Map,a=new Map;let c=0;const m=i.length,p=10,g=[p,$*.7],y=[se-p,$*.7],u=y[0]-g[0],A=y[1]-g[1],T=u/m,z=A/m;i.forEach(function(s,C){s.x=g[0]+C*T,s.y=g[1]+C*z,n.set(s.id,s),s.cluster&&a.get(s.cluster)===void 0&&(a.set(s.cluster,c),c++);const O=a.get(s.cluster);s.style?s.style.fill=k[O%k.length]:s.style={fill:k[O%k.length]},s.label=s.name,s.labelCfg={position:"bottom",offset:5,style:{rotate:Math.PI/2,textAlign:"start",fill:"white"}}}),t.forEach(s=>{s.type="arc";const C=n.get(s.source),O=n.get(s.target),W=(O.x-C.x)/T,q=(W<0?-1:1)*10*Math.ceil(Math.abs(W));s.curveOffset=q,s.color=C.style.fill,s.sourceName=C.name,s.targetName=O.name});let P=-9999,b=9999;i.forEach(function(s){P<s.value&&(P=s.value),b>s.value&&(b=s.value)}),ie(i,"size","value",[b,P],[3,25]),h.data(e),h.render(),typeof window!="undefined"&&(window.onresize=()=>{!h||h.get("destroyed")||!container||!container.scrollWidth||!container.scrollHeight||h.changeSize(container.scrollWidth,container.scrollHeight)})});function ie(e,t,i,n,a){const c=a[1]-a[0],m=n[1]-n[0];e.forEach(function(p){p[t]=(p[i]-n[0])*c/m+a[0]})}const oe=new F({width:512,height:256,bgColor:"rgb(0, 0, 0)"}).draw(e=>{e.textBaseline="middle",e.textAlign="center",e.fillStyle="rgb(0, 255, 0)",e.font=" bold 54px \u5FAE\u8F6F\u96C5\u9ED1",e.fillText("\u6811\u67B6\u6784\u56FE\u8C31",256,128)}),re=new F({width:512,height:256,bgColor:"rgb(0, 0, 0)"}).draw(e=>{e.textBaseline="middle",e.textAlign="center",e.fillStyle="rgb(0, 255, 0)",e.font=" bold 54px \u5FAE\u8F6F\u96C5\u9ED1",e.fillText("\u98DE\u7EBF\u67B6\u6784\u56FE\u8C31",256,128)}),le=new F({width:256,height:256,bgColor:"rgb(0, 0, 0)"}).draw(e=>{const t=e.createLinearGradient(0,0,0,256);t.addColorStop(0,"rgb(0, 0, 255)"),t.addColorStop(1,"rgb(0, 100, 0)"),e.fillStyle=t,e.fillRect(0,0,256,256)}),N=new K().install("CSS3DRenderer").complete().setDom(document.getElementById("app")).setSize();N.registerResources({hookAlpha:le.getDom(),treeGraph:I.get("canvas").cfg.el,arcGraph:h.get("canvas").cfg.el,treeTips:oe.getDom(),arcTips:re.getDom()});o.injectEngine=N;const ce=o("PerspectiveCamera",{far:1e4,position:{x:500,y:-300,z:500}});N.setCamera(ce.vid).setSize();const de=o("Scene");N.setScene(de.vid);o.injectScene=!0;o("AmbientLight");const R=70,S=70,r=R/2,d=10,f=S*2,pe=o("CustomGeometry",{attribute:{position:[-r,0,-r,r,0,-r,r,0,r,-r,0,r,-r*d,f,-r*d,r*d,f,-r*d,r*d,f,r*d,-r*d,f,r*d],uv:[0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1],index:[0,4,5,5,1,0,1,5,6,6,2,1,2,6,7,7,3,2,3,7,4,4,0,3]},rotation:{x:Math.PI/2},position:{z:1}}),ge=o("CanvasTexture",{url:"hookAlpha"}),he=o("MeshBasicMaterial",{color:"rgb(53, 193, 221)",side:U,alphaMap:ge.vid,transparent:!0}),V=o("Mesh",{geometry:pe.vid,material:he.vid,visible:!1}),H=o("PlaneGeometry",{width:100,height:50,rotation:{x:Math.PI/2}}),me=o("CanvasTexture",{url:"treeTips"}),fe=o("MeshBasicMaterial",{alphaMap:me.vid,transparent:!0}),E=o("Mesh",{geometry:H.vid,material:fe.vid,position:{z:f+10,y:-r*d+20,x:r*d-50},visible:!1}),j=o("CSS3DPlane",{element:"treeGraph",width:1024,height:1024,scale:{x:.7,y:.7,z:.7},position:{z:f+10},visible:!1}),ye=o("CanvasTexture",{url:"arcTips"}),ue=o("MeshBasicMaterial",{alphaMap:ye.vid,transparent:!0}),L=o("Mesh",{geometry:H.vid,material:ue.vid,position:{z:f+120,y:-r*d+20,x:r*d-50},visible:!1}),w=o("CSS3DPlane",{element:"arcGraph",width:1024,height:1024,scale:{x:.7,y:.7,z:.7},position:{z:f+120},visible:!1}),be=o("Group",{children:[V.vid,E.vid,j.vid,L.vid,w.vid]}),B=6,M=10,D=5,Q=[],_=[];for(let e=0;e<=B*M-1;e+=1){const t=document.createElement("div");t.className="app-brick",t.innerHTML=`<span class="title">title:${e}</span>
        <span class="tips">tips:${e}</span>`,document.body.appendChild(t),N.registerResources({[`dom${e}`]:t});const i=te();Q.push(i);const n={x:M*(S+D)*(e%M/M)-M*(S+D)/2,y:B*(S+D)*(Math.floor(e/M)/B)-B*(S+D)/2,z:0},a=o("CSS3DPlane",{vid:i,element:`dom${e}`,width:R,height:S,position:n,click:[l.generateConfig("focusObject",{params:{target:i,space:"local",offset:{y:-850,z:500}}}),l.generateConfig("moveTo",{params:{target:be.vid,position:{x:n.x,y:n.y,z:n.z},duration:0}}),l.generateConfig("moveFromTo",{params:{target:w.vid,to:{x:0,y:0,z:f+120},delay:500}}),l.generateConfig("moveFromTo",{params:{target:E.vid,to:JSON.parse(JSON.stringify(E.position)),delay:500}}),l.generateConfig("moveFromTo",{params:{target:j.vid,to:JSON.parse(JSON.stringify(j.position)),delay:500}}),l.generateConfig("moveFromTo",{params:{target:L.vid,to:JSON.parse(JSON.stringify(L.position)),delay:500}}),l.generateConfig("moveFromTo",{params:{target:w.vid,to:JSON.parse(JSON.stringify(w.position)),delay:500}}),l.generateConfig("fadeObject",{params:{target:V.vid,direction:"in",delay:500}}),l.generateConfig("fadeObject",{params:{target:L.vid,direction:"in",delay:500}}),l.generateConfig("visibleObject",{params:{target:w.vid,visible:!1}}),l.generateConfig("visibleObject",{params:{target:w.vid,visible:!0,delay:500}}),l.generateConfig("fadeObject",{params:{target:E.vid,direction:"in",delay:500}}),l.generateConfig("visibleObject",{params:{target:j.vid,visible:!1}}),l.generateConfig("visibleObject",{params:{target:j.vid,visible:!0,delay:500}}),l.generateConfig("addClass",{params:{target:i,className:"app-brick-focus"}})]});_.push(a)}_.forEach(e=>{const t=l.generateConfig("addClass",{params:{target:Q.filter(i=>i!==e.vid),className:"app-brick-fade"}});e.click.push(t)});
