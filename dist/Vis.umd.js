(function(g,l){typeof exports=="object"&&typeof module!="undefined"?l(exports,require("three"),require("three/examples/jsm/libs/stats.module"),require("three/examples/jsm/postprocessing/EffectComposer"),require("three/examples/jsm/postprocessing/RenderPass"),require("three/examples/jsm/controls/TransformControls"),require("three/examples/jsm/loaders/OBJLoader"),require("three/examples/jsm/loaders/MTLLoader"),require("three/examples/jsm/loaders/RGBELoader"),require("three/examples/jsm/loaders/GLTFLoader"),require("three/examples/jsm/loaders/DRACOLoader"),require("three/examples/jsm/loaders/KTX2Loader.js"),require("three/examples/jsm/libs/meshopt_decoder.module.js"),require("uuid"),require("three-csg-ts"),require("three/examples/jsm/renderers/CSS3DRenderer"),require("@tweenjs/tween.js"),require("keyboardjs"),require("three/examples/jsm/postprocessing/Pass"),require("three/examples/jsm/shaders/LuminosityHighPassShader"),require("three/src/lights/LightShadow"),require("three/examples/jsm/postprocessing/SMAAPass"),require("three/examples/jsm/postprocessing/UnrealBloomPass")):typeof define=="function"&&define.amd?define(["exports","three","three/examples/jsm/libs/stats.module","three/examples/jsm/postprocessing/EffectComposer","three/examples/jsm/postprocessing/RenderPass","three/examples/jsm/controls/TransformControls","three/examples/jsm/loaders/OBJLoader","three/examples/jsm/loaders/MTLLoader","three/examples/jsm/loaders/RGBELoader","three/examples/jsm/loaders/GLTFLoader","three/examples/jsm/loaders/DRACOLoader","three/examples/jsm/loaders/KTX2Loader.js","three/examples/jsm/libs/meshopt_decoder.module.js","uuid","three-csg-ts","three/examples/jsm/renderers/CSS3DRenderer","@tweenjs/tween.js","keyboardjs","three/examples/jsm/postprocessing/Pass","three/examples/jsm/shaders/LuminosityHighPassShader","three/src/lights/LightShadow","three/examples/jsm/postprocessing/SMAAPass","three/examples/jsm/postprocessing/UnrealBloomPass"],l):(g=typeof globalThis!="undefined"?globalThis:g||self,l(g.Vis={},g.three,g.Stats,g.EffectComposer,g.RenderPass,g.TransformControls,g.OBJLoader,g.MTLLoader,g.RGBELoader,g.GLTFLoader,g.DRACOLoader,g.KTX2Loader_js,g.meshopt_decoder_module_js,g.uuid,g.threeCsgTs,g.CSS3DRenderer,g.tween_js,g.keyboardjs,g.Pass,g.LuminosityHighPassShader,g.LightShadow,g.SMAAPass,g.UnrealBloomPass))})(this,function(g,l,De,Vt,Wt,oo,so,io,ao,co,lo,uo,po,ee,_t,Ee,I,ho,Ar,Dr,fo,mo,go){"use strict";var xl=Object.defineProperty;var Ol=(g,l,De)=>l in g?xl(g,l,{enumerable:!0,configurable:!0,writable:!0,value:De}):g[l]=De;var c=(g,l,De)=>(Ol(g,typeof l!="symbol"?l+"":l,De),De);function Pr(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var yo=Pr(De),ct=Pr(ho);class te{constructor(){c(this,"listeners",new Map)}addEventListener(t,e){const n=this.listeners;n.has(t)||n.set(t,new Set),n.get(t).add(e)}hasEventListener(t,e){const n=this.listeners;return n.has(t)?n.get(t).has(e):!1}removeEventListener(t,e){const n=this.listeners;!n.has(t)||!n.get(t).has(e)||n.get(t).delete(e)}dispatchEvent(t){var o;const e=t.type,n=this.listeners;if(n.has(e))try{(o=n.get(e))==null||o.forEach(s=>{s.call(this,t)})}catch(s){console.error(s)}}clear(){this.listeners.clear()}useful(){return Boolean([...this.listeners.keys()].length)}once(t,e){const n=function(o){e.call(this,o),this.removeEventListener(t,n)};this.addEventListener(t,n)}emit(t,e={}){var o;const n=this.listeners;if(n.has(t))try{(o=n.get(t))==null||o.forEach(s=>{s.call(this,e)})}catch(s){console.error(s)}}on(t,e){this.addEventListener(t,e)}has(t,e){return this.hasEventListener(t,e)}off(t,e){if(e)this.removeEventListener(t,e);else{const n=this.listeners;if(!n.has(t))return;n.delete(t)}}}class jr extends te{constructor(e=0){super();c(this,"clock",new l.Clock);c(this,"animationFrame",-1);c(this,"fps",0);c(this,"timer",null);c(this,"playFun",()=>{});c(this,"render",()=>{this.dispatchEvent({type:"render",delta:this.clock.getDelta(),total:this.clock.getElapsedTime()})});c(this,"play",()=>{if(this.hasRendering()){console.warn("render manager is rendering.");return}this.dispatchEvent({type:"play"}),this.playFun()});c(this,"stop",()=>{this.animationFrame!==-1&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=-1),this.timer&&(clearTimeout(this.timer),this.timer=null),this.dispatchEvent({type:"stop"})});c(this,"hasRendering",()=>Boolean(this.animationFrame!==-1||this.timer));c(this,"hasVaildRender",()=>this.useful());this.setFPS(e)}setFPS(e){return this.animationFrame!==-1&&cancelAnimationFrame(this.animationFrame),this.timer&&clearTimeout(this.timer),this.fps=e,e<=0?(this.fps=0,this.playFun=()=>{this.render(),this.animationFrame=requestAnimationFrame(this.playFun)}):this.playFun=()=>{this.timer=setTimeout(()=>{this.playFun()},e),this.render()},this.playFun(),this}dispose(){this.hasRendering()&&this.stop(),this.clear()}}const Eo=function(){return this.renderManager?(console.warn("has installed render manager plugin."),!1):(this.renderManager=new jr,this.render=function(){return this.renderManager.render(),this},this.play=function(){return this.renderManager.play(),this},this.stop=function(){return this.renderManager.stop(),this},this.addEventListener("dispose",()=>{this.renderManager.dispose()}),!0)};class Ir extends te{constructor(e,n){super();c(this,"object");c(this,"domElement");c(this,"enabled",!0);c(this,"target",new l.Vector3);c(this,"minDistance",0);c(this,"maxDistance",1/0);c(this,"minZoom",0);c(this,"maxZoom",1/0);c(this,"minPolarAngle",0);c(this,"maxPolarAngle",Math.PI);c(this,"minAzimuthAngle",-1/0);c(this,"maxAzimuthAngle",1/0);c(this,"enableDamping",!1);c(this,"dampingFactor",.05);c(this,"enableZoom",!0);c(this,"zoomSpeed",1);c(this,"enableRotate",!0);c(this,"rotateSpeed",1);c(this,"enablePan",!0);c(this,"panSpeed",1);c(this,"screenSpacePanning",!0);c(this,"keyPanSpeed",7);c(this,"autoRotate",!1);c(this,"autoRotateSpeed",2);c(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"});c(this,"mouseButtons",{LEFT:null,MIDDLE:l.MOUSE.DOLLY,RIGHT:l.MOUSE.ROTATE});c(this,"touches",{ONE:l.TOUCH.ROTATE,TWO:l.TOUCH.DOLLY_PAN});c(this,"target0");c(this,"position0");c(this,"zoom0");c(this,"_domElementKeyEvents",null);c(this,"spherical");c(this,"reset");c(this,"update");c(this,"onContextMenu");c(this,"onPointerDown");c(this,"onPointerCancel");c(this,"onMouseWheel");c(this,"onPointerMove");c(this,"onPointerUp");c(this,"onKeyDown");this.object=e||new l.PerspectiveCamera,this.domElement=n||document.createElement("div"),this.domElement.style.touchAction="none",this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.update=(()=>{const f=new l.Vector3,C=new l.Quaternion().setFromUnitVectors(this.object.up,new l.Vector3(0,1,0)),z=C.clone().invert(),_=new l.Vector3,Le=new l.Quaternion,Ae=2*Math.PI;return()=>{const no=this.object.position;f.copy(no).sub(this.target),f.applyQuaternion(C),a.setFromVector3(f),this.autoRotate&&s===o.NONE&&A(q()),this.enableDamping?(a.theta+=u.theta*this.dampingFactor,a.phi+=u.phi*this.dampingFactor):(a.theta+=u.theta,a.phi+=u.phi);let ge=this.minAzimuthAngle,ye=this.maxAzimuthAngle;return isFinite(ge)&&isFinite(ye)&&(ge<-Math.PI?ge+=Ae:ge>Math.PI&&(ge-=Ae),ye<-Math.PI?ye+=Ae:ye>Math.PI&&(ye-=Ae),ge<=ye?a.theta=Math.max(ge,Math.min(ye,a.theta)):a.theta=a.theta>(ge+ye)/2?Math.max(ge,a.theta):Math.min(ye,a.theta)),a.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=h,a.radius=Math.max(this.minDistance,Math.min(this.maxDistance,a.radius)),this.enableDamping===!0?this.target.addScaledVector(p,this.dampingFactor):this.target.add(p),f.setFromSpherical(a),f.applyQuaternion(z),no.copy(this.target).add(f),this.object.lookAt(this.target),this.enableDamping===!0?(u.theta*=1-this.dampingFactor,u.phi*=1-this.dampingFactor,p.multiplyScalar(1-this.dampingFactor)):(u.set(0,0,0),p.set(0,0,0)),h=1,m||_.distanceToSquared(this.object.position)>i||8*(1-Le.dot(this.object.quaternion))>i?(this.dispatchEvent({type:"change"}),_.copy(this.object.position),Le.copy(this.object.quaternion),m=!1,!0):!1}})();const o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=o.NONE;const i=1e-6,a=new l.Spherical,u=new l.Spherical;let h=1;const p=new l.Vector3;let m=!1;const T=new l.Vector2,b=new l.Vector2,v=new l.Vector2,S=new l.Vector2,R=new l.Vector2,w=new l.Vector2,D=new l.Vector2,j=new l.Vector2,$=new l.Vector2,O=[],E={},q=()=>2*Math.PI/60/60*this.autoRotateSpeed,P=()=>Math.pow(.95,this.zoomSpeed),A=f=>{u.theta-=f},$n=f=>{u.phi-=f},Vn=function(){const f=new l.Vector3;return function(z,_){f.setFromMatrixColumn(_,0),f.multiplyScalar(-z),p.add(f)}}(),Wn=(()=>{const f=new l.Vector3;return(C,z)=>{this.screenSpacePanning===!0?f.setFromMatrixColumn(z,1):(f.setFromMatrixColumn(z,0),f.crossVectors(this.object.up,f)),f.multiplyScalar(C),p.add(f)}})(),Je=(()=>{const f=new l.Vector3;return(C,z)=>{const _=this.domElement;if(this.object instanceof l.PerspectiveCamera){const Le=this.object.position;f.copy(Le).sub(this.target);let Ae=f.length();Ae*=Math.tan(this.object.fov/2*Math.PI/180),Vn(2*C*Ae/_.clientHeight,this.object.matrix),Wn(2*z*Ae/_.clientHeight,this.object.matrix)}else this.object instanceof l.OrthographicCamera?(Vn(C*(this.object.right-this.object.left)/this.object.zoom/_.clientWidth,this.object.matrix),Wn(z*(this.object.top-this.object.bottom)/this.object.zoom/_.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}})(),xr=f=>{this.object instanceof l.PerspectiveCamera?h/=f:this.object instanceof l.OrthographicCamera?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*f)),this.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)},_n=f=>{this.object instanceof l.PerspectiveCamera?h*=f:this.object instanceof l.OrthographicCamera?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/f)),this.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)};function Yn(f){T.set(f.clientX,f.clientY)}function ul(f){D.set(f.clientX,f.clientY)}function Qn(f){S.set(f.clientX,f.clientY)}const dl=f=>{b.set(f.clientX,f.clientY),v.subVectors(b,T).multiplyScalar(this.rotateSpeed);const C=this.domElement;A(2*Math.PI*v.x/C.clientHeight),$n(2*Math.PI*v.y/C.clientHeight),T.copy(b),this.update()},pl=f=>{j.set(f.clientX,f.clientY),$.subVectors(j,D),$.y>0?xr(P()):$.y<0&&_n(P()),D.copy(j),this.update()},hl=f=>{R.set(f.clientX,f.clientY),w.subVectors(R,S).multiplyScalar(this.panSpeed),Je(w.x,w.y),S.copy(R),this.update()},fl=f=>{f.deltaY<0?_n(P()):f.deltaY>0&&xr(P()),this.update()},ml=f=>{let C=!1;switch(f.code){case this.keys.UP:Je(0,this.keyPanSpeed),C=!0;break;case this.keys.BOTTOM:Je(0,-this.keyPanSpeed),C=!0;break;case this.keys.LEFT:Je(this.keyPanSpeed,0),C=!0;break;case this.keys.RIGHT:Je(-this.keyPanSpeed,0),C=!0;break}C&&(f.preventDefault(),this.update())};function Xn(){if(O.length===1)T.set(O[0].pageX,O[0].pageY);else{const f=.5*(O[0].pageX+O[1].pageX),C=.5*(O[0].pageY+O[1].pageY);T.set(f,C)}}function Kn(){if(O.length===1)S.set(O[0].pageX,O[0].pageY);else{const f=.5*(O[0].pageX+O[1].pageX),C=.5*(O[0].pageY+O[1].pageY);S.set(f,C)}}function Jn(){const f=O[0].pageX-O[1].pageX,C=O[0].pageY-O[1].pageY,z=Math.sqrt(f*f+C*C);D.set(0,z)}const gl=()=>{this.enableZoom&&Jn(),this.enablePan&&Kn()},yl=()=>{this.enableZoom&&Jn(),this.enableRotate&&Xn()},Zn=f=>{if(O.length==1)b.set(f.pageX,f.pageY);else{const z=Lr(f),_=.5*(f.pageX+z.x),Le=.5*(f.pageY+z.y);b.set(_,Le)}v.subVectors(b,T).multiplyScalar(this.rotateSpeed);const C=this.domElement;A(2*Math.PI*v.x/C.clientHeight),$n(2*Math.PI*v.y/C.clientHeight),T.copy(b)},qn=f=>{if(O.length===1)R.set(f.pageX,f.pageY);else{const C=Lr(f),z=.5*(f.pageX+C.x),_=.5*(f.pageY+C.y);R.set(z,_)}w.subVectors(R,S).multiplyScalar(this.panSpeed),Je(w.x,w.y),S.copy(R)},eo=f=>{const C=Lr(f),z=f.pageX-C.x,_=f.pageY-C.y,Le=Math.sqrt(z*z+_*_);j.set(0,Le),$.set(0,Math.pow(j.y/D.y,this.zoomSpeed)),xr($.y),D.copy(j)},El=f=>{this.enableZoom&&eo(f),this.enablePan&&qn(f)},Sl=f=>{this.enableZoom&&eo(f),this.enableRotate&&Zn(f)};this.onPointerDown=f=>{this.enabled!==!1&&(O.length===0&&(this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp)),Rl(f),f.pointerType==="touch"?wl(f):bl(f))};let Or=!1;this.onPointerMove=f=>{this.enabled!==!1&&(Or||(this.domElement.setPointerCapture(f.pointerId),Or=!0),f.pointerType==="touch"?Tl(f):Ml(f))},this.onPointerUp=f=>{this.enabled!==!1&&(Or=!1,f.pointerType==="touch"?Cl():vl(f),to(f),O.length===0&&(this.domElement.releasePointerCapture(f.pointerId),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)))},this.onPointerCancel=f=>{to(f)};const bl=f=>{let C;switch(f.button){case 0:C=this.mouseButtons.LEFT;break;case 1:C=this.mouseButtons.MIDDLE;break;case 2:C=this.mouseButtons.RIGHT;break;default:C=-1}switch(C){case l.MOUSE.DOLLY:if(this.enableZoom===!1)return;ul(f),s=o.DOLLY;break;case l.MOUSE.ROTATE:if(f.ctrlKey||f.metaKey||f.shiftKey){if(this.enablePan===!1)return;Qn(f),s=o.PAN}else{if(this.enableRotate===!1)return;Yn(f),s=o.ROTATE}break;case l.MOUSE.PAN:if(f.ctrlKey||f.metaKey||f.shiftKey){if(this.enableRotate===!1)return;Yn(f),s=o.ROTATE}else{if(this.enablePan===!1)return;Qn(f),s=o.PAN}break;default:s=o.NONE}s!==o.NONE&&this.dispatchEvent({type:"start"})},Ml=f=>{if(this.enabled!==!1)switch(s){case o.ROTATE:if(this.enableRotate===!1)return;dl(f);break;case o.DOLLY:if(this.enableZoom===!1)return;pl(f);break;case o.PAN:if(this.enablePan===!1)return;hl(f);break}},vl=f=>{this.dispatchEvent({type:"end"}),s=o.NONE};this.onMouseWheel=f=>{this.enabled===!1||this.enableZoom===!1||s!==o.NONE||(f.preventDefault(),this.dispatchEvent({type:"start"}),fl(f),this.dispatchEvent({type:"end"}))},this.onKeyDown=f=>{this.enabled===!1||this.enablePan===!1||ml(f)};const wl=f=>{switch(ro(f),O.length){case 1:switch(this.touches.ONE){case l.TOUCH.ROTATE:if(this.enableRotate===!1)return;Xn(),s=o.TOUCH_ROTATE;break;case l.TOUCH.PAN:if(this.enablePan===!1)return;Kn(),s=o.TOUCH_PAN;break;default:s=o.NONE}break;case 2:switch(this.touches.TWO){case l.TOUCH.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;gl(),s=o.TOUCH_DOLLY_PAN;break;case l.TOUCH.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;yl(),s=o.TOUCH_DOLLY_ROTATE;break;default:s=o.NONE}break;default:s=o.NONE}s!==o.NONE&&this.dispatchEvent({type:"start"})},Tl=f=>{switch(ro(f),s){case o.TOUCH_ROTATE:if(this.enableRotate===!1)return;Zn(f),this.update();break;case o.TOUCH_PAN:if(this.enablePan===!1)return;qn(f),this.update();break;case o.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;El(f),this.update();break;case o.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;Sl(f),this.update();break;default:s=o.NONE}},Cl=f=>{this.dispatchEvent({type:"end"}),s=o.NONE};this.onContextMenu=f=>{this.enabled!==!1&&f.preventDefault()};function Rl(f){O.push(f)}const to=f=>{delete E[f.pointerId];for(let C=0;C<O.length;C++)if(O[C].pointerId==f.pointerId){O.splice(C,1);return}};function ro(f){let C=E[f.pointerId];C===void 0&&(C=new l.Vector2,E[f.pointerId]=C),C.set(f.pageX,f.pageY)}function Lr(f){const C=f.pointerId===O[0].pointerId?O[1]:O[0];return E[C.pointerId]}this.spherical=a,this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),this.domElement.addEventListener("wheel",this.onMouseWheel,{passive:!1}),this.reset=()=>{this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent({type:"change"}),this.update(),s=o.NONE},this.update()}getPolarAngle(){return this.spherical.phi}getAzimuthalAngle(){return this.spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this.onKeyDown),this._domElementKeyEvents=e}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}setCamera(e){this.object=e}setDom(e){this.dispose(),this.domElement=e,this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),this.domElement.addEventListener("wheel",this.onMouseWheel,{passive:!1})}dispose(){this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointercancel",this.onPointerCancel),this.domElement.removeEventListener("wheel",this.onMouseWheel),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp),this._domElementKeyEvents!==null&&this._domElementKeyEvents.removeEventListener("keydown",this.onKeyDown)}}var V=(r=>(r.DEFAULT="default",r.TOP="top",r.BOTTOM="bottom",r.LEFT="left",r.RIGHT="right",r.FRONT="front",r.BACK="back",r))(V||{});const So=function(r={}){var o;if(!this.webGLRenderer)return console.error("must install some renderer before BasicViewpoint plugin."),!1;!r.viewpoint&&(r.viewpoint="default"),!r.perspective&&(r.perspective={}),!r.perspective.position&&(r.perspective.position={x:60,y:60,z:60}),!r.perspective.lookAt&&(r.perspective.lookAt={x:0,y:0,z:0}),!r.perspective.up&&(r.perspective.up={x:0,y:1,z:0}),!r.orthograpbic&&(r.orthograpbic={}),!r.orthograpbic.up&&(r.orthograpbic.up={x:0,y:1,z:0});const t=new l.PerspectiveCamera;t.position.set(r.perspective.position.x,r.perspective.position.y,r.perspective.position.z),t.lookAt(r.perspective.lookAt.x,r.perspective.lookAt.y,r.perspective.lookAt.z),t.up.set(r.perspective.up.x,r.perspective.up.y,r.perspective.up.z);const e=r.orthograpbic.distance||1e4,n=new l.OrthographicCamera(-window.innerWidth/8,window.innerWidth/8,-window.innerHeight/8,window.innerHeight/8,0,e);return n.up.set(r.perspective.up.x,r.perspective.up.y,r.perspective.up.z),this.setViewpoint=function(s){return this.dispatchEvent({type:"setViewpoint",viewpoint:s}),this},this.addEventListener("setSize",s=>{const i=s.width,a=s.height,u=i/a;t.aspect=u,t.updateProjectionMatrix(),n.left=-e*u,n.right=e*u,n.top=e,n.bottom=-e,n.zoom=e/a*5,n.updateProjectionMatrix()}),(o=r.orthograpbic.allowRotate)!=null,this.addEventListener("setViewpoint",s=>{const i=s.viewpoint;if(i==="default"){this.setCamera(t);return}i==="top"?n.position.set(0,e/2,0):i==="bottom"?n.position.set(0,-e/2,0):i==="right"?n.position.set(e/2,0,0):i==="left"?n.position.set(-e/2,0,0):i==="front"?n.position.set(0,0,e/2):i==="back"&&n.position.set(0,0,-e/2),this.setCamera(n)}),this.completeSet.add(()=>{r.viewpoint==="default"?this.setCamera(t):this.setCamera(n),this.objectHelperManager&&this.objectHelperManager.addFilteredObject(t,n)}),!0},bo=function(r){return this.orbitControls?(console.warn("this has installed orbitControls plugin."),!1):this.renderManager?(this.orbitControls=new Ir(this.camera,this.dom),this.addEventListener("setCamera",t=>{t.options.orbitControls&&this.orbitControls.setCamera(t.camera)}),this.addEventListener("setDom",t=>{this.orbitControls.setDom(t.dom)}),this.renderManager.addEventListener("render",()=>{this.orbitControls.update()}),this.completeSet.add(()=>{this.setViewpoint&&this.addEventListener("setViewpoint",t=>{const e=t.viewpoint;this.orbitControls.target.set(0,0,0),e===V.DEFAULT?this.orbitControls.enableRotate=!0:e===V.TOP?this.orbitControls.enableRotate=!1:e===V.BOTTOM?this.orbitControls.enableRotate=!1:e===V.RIGHT?this.orbitControls.enableRotate=!1:e===V.LEFT?this.orbitControls.enableRotate=!1:e===V.FRONT?this.orbitControls.enableRotate=!1:e===V.BACK&&(this.orbitControls.enableRotate=!1)})}),!0):(console.warn("this must install renderManager before install orbitControls plugin."),!1)};class Mo{constructor(t){c(this,"REVISION");c(this,"dom");c(this,"addPanel");c(this,"showPanel");c(this,"begin");c(this,"end");c(this,"update");c(this,"domElement");c(this,"setMode");const e=yo.default();this.REVISION=e.REVISION,this.dom=e.dom,this.domElement=e.domElement,this.begin=e.begin.bind(e),this.end=e.end.bind(e),this.update=e.update.bind(e),this.addPanel=e.addPanel.bind(e),this.showPanel=e.showPanel.bind(e),this.setMode=e.setMode.bind(e);const n=this.domElement;n.style.position="absolute",n.style.top="0",n.style.left="35px",t&&(n.style.top=`${t.top}px`,n.style.left=`${t.left}px`,n.style.right=`${t.right}px`,n.style.bottom=`${t.bottom}px`)}}const vo=function(r){if(this.stats)return console.warn("this has installed stats plugin."),!1;if(!this.renderManager)return console.warn("this must install renderManager before install stats plugin."),!1;const t=new Mo(r);this.stats=t;const e=()=>{this.stats.update()};return this.setStats=function(n){if(n)this.dom.appendChild(this.stats.domElement),this.renderManager.addEventListener("render",e);else try{this.dom.removeChild(this.stats.domElement),this.renderManager.removeEventListener("render",e)}catch{}return this},!0},wo=function(r={}){if(this.effectComposer)return console.warn("this has installed effect composer plugin."),!1;if(!this.webGLRenderer)return console.error("must install some renderer before this plugin."),!1;let t;if(r.WebGLMultisampleRenderTarget||r.MSAA){const n=this.webGLRenderer,o=n.getPixelRatio(),s=n.getDrawingBufferSize(new l.Vector2);Number(window.__THREE__)>137?t=new Vt.EffectComposer(n,new l.WebGLRenderTarget(s.width*o,s.height*o,{format:r.format||l.RGBAFormat,samples:r.samples||4})):t=new Vt.EffectComposer(n,new l.WebGLMultisampleRenderTarget(s.width*o,s.height*o,{format:r.format||l.RGBAFormat}))}else t=new Vt.EffectComposer(this.webGLRenderer);this.effectComposer=t;let e;return this.scene&&this.camera&&(e=new Wt.RenderPass(this.scene,this.camera),t.addPass(e)),this.addEventListener("setCamera",n=>{if(!e&&this.scene){e=new Wt.RenderPass(this.scene,n.camera),t.addPass(e);return}else e&&(e.camera=n.camera)}),this.addEventListener("setScene",n=>{if(!e&&this.camera){e=new Wt.RenderPass(n.scene,this.camera),t.addPass(e);return}else e&&(e.scene=n.scene)}),this.addEventListener("setSize",n=>{t.setSize(n.width,n.height)}),this.renderManager?(this.renderManager.removeEventListener("render",this.render),this.renderManager.addEventListener("render",n=>{this.effectComposer.render(n.delta)})):this.render=function(){return this.effectComposer.render(),this},!0};class To extends te{constructor(e){super();c(this,"dom");c(this,"mouse");c(this,"canMouseMove");c(this,"mouseEventTimer");c(this,"throttleTime");c(this,"pointerDownHandler");c(this,"pointerMoveHandler");c(this,"pointerUpHandler");c(this,"mouseDownHandler");c(this,"mouseUpHandler");c(this,"clickHandler");c(this,"dblclickHandler");c(this,"contextmenuHandler");this.dom=e.dom,this.mouse=new l.Vector2,this.canMouseMove=!0,this.mouseEventTimer=null,this.throttleTime=e.throttleTime||1e3/60;const n=s=>{const i={mouse:{x:this.mouse.x,y:this.mouse.y}};for(const a in s)i[a]=s[a];return i},o=s=>{this.dispatchEvent(n(s))};this.pointerMoveHandler=s=>{!this.canMouseMove||(this.canMouseMove=!1,this.mouseEventTimer=window.setTimeout(()=>{const i=this.mouse,a=this.dom,u=a.getBoundingClientRect();i.x=(s.clientX-u.left)/a.offsetWidth*2-1,i.y=-((s.clientY-u.top)/a.offsetHeight)*2+1,this.canMouseMove=!0,this.dispatchEvent(n(s))},this.throttleTime))},this.mouseDownHandler=o,this.mouseUpHandler=o,this.pointerDownHandler=o,this.pointerUpHandler=o,this.clickHandler=o,this.dblclickHandler=o,this.contextmenuHandler=o}setDom(e){if(this.dom){const n=this.dom;n.removeEventListener("mousedown",this.mouseDownHandler),n.removeEventListener("mouseup",this.mouseUpHandler),n.removeEventListener("pointerdown",this.pointerDownHandler),n.removeEventListener("pointermove",this.pointerMoveHandler),n.removeEventListener("pointerup",this.pointerUpHandler),n.removeEventListener("click",this.clickHandler),n.removeEventListener("dblclick",this.dblclickHandler),n.removeEventListener("contextmenu",this.contextmenuHandler)}return e.addEventListener("mousedown",this.mouseDownHandler),e.addEventListener("mouseup",this.mouseUpHandler),e.addEventListener("pointerdown",this.pointerDownHandler),e.addEventListener("pointermove",this.pointerMoveHandler),e.addEventListener("pointerup",this.pointerUpHandler),e.addEventListener("click",this.clickHandler),e.addEventListener("dblclick",this.dblclickHandler),e.addEventListener("contextmenu",this.contextmenuHandler),this.dom=e,this}getNormalMouse(){return this.mouse}}const Co=function(r){if(this.pointerManager)return console.warn("this has installed pointerManager plugin."),!1;const t=new To(Object.assign(r||{},{dom:this.dom}));return this.addEventListener("setDom",e=>{t.setDom(e.dom)}),this.pointerManager=t,!0};var Yt=(r=>(r.POINTERDOWN="pointerdown",r.POINTERUP="pointerup",r.POINTERMOVE="pointermove",r.POINTERENTER="pointerenter",r.POINTERLEAVE="pointerleave",r.CLICK="click",r.DBLCLICK="dblclick",r.CONTEXTMENU="contextmenu",r))(Yt||{});class Ro extends te{constructor(e){super();c(this,"raycaster");c(this,"scene");c(this,"camera");c(this,"filter",new Set);c(this,"recursive",!1);c(this,"penetrate",!1);c(this,"propagation",!1);c(this,"delegation",!1);this.raycaster=new l.Raycaster,this.camera=e.camera,this.scene=e.scene,e.recursive&&(this.recursive=e.recursive),e.penetrate&&(this.penetrate=e.penetrate)}setScene(e){return this.scene=e,this}setCamera(e){return this.camera=e,this}addFilterObject(e){return this.filter.add(e),this}removeFilterObject(e){return this.filter.delete(e),this}intersectObject(e){this.raycaster.setFromCamera(e,this.camera);const n=this.filter,o=this.scene.children.filter(s=>!n.has(s));return this.raycaster.intersectObjects(o,this.recursive)}use(e){const n=function(u,h){return Object.assign({},u,h)},o=(u,h)=>{const p=this.intersectObject(u.mouse);if(p.length)if(this.penetrate)for(const m of p)m.object.dispatchEvent(n(u,{type:h,intersection:m}));else{const m=p[0];m.object.dispatchEvent(n(u,{type:h,intersection:m}))}this.dispatchEvent(n(u,{type:h,intersections:p}))},s=["pointerdown","pointerup","mousedown","mouseup","pointermove","click","dblclick","contextmenu"];for(const u of s)e.addEventListener(u,h=>{o(h,u)});const i=new Map;let a=null;return e.addEventListener("pointermove",u=>{const h=this.intersectObject(u.mouse);if(this.penetrate){if(!h.length){i.forEach(p=>{p.object.dispatchEvent(n(u,{type:"pointerleave",intersection:p})),p.object.dispatchEvent(n(u,{type:"mouseleave",intersection:p}))}),i.clear();return}for(const p of h)i.has(p.object)?(p.object.dispatchEvent(n(u,{type:"pointermove",intersection:p})),p.object.dispatchEvent(n(u,{type:"mousemove",intersection:p})),i.delete(p.object)):(p.object.dispatchEvent(n(u,{type:"pointerenter",intersection:p})),p.object.dispatchEvent(n(u,{type:"mouseenter",intersection:p})));for(const p of i.values())p.object.dispatchEvent(n(u,{type:"pointerleave",intersection:p})),p.object.dispatchEvent(n(u,{type:"mouseleave",intersection:p}));i.clear();for(const p of h)i.set(p.object,p)}else{if(!h.length){a&&(a.object.dispatchEvent(n(u,{type:"pointerleave",intersection:a})),a.object.dispatchEvent(n(u,{type:"mouseleave",intersection:a})),a=null);return}const p=h[0];if(!a){p.object.dispatchEvent(n(u,{type:"pointerenter",intersection:p})),p.object.dispatchEvent(n(u,{type:"mouseenter",intersection:p})),a=p;return}if(p.object!==a.object){a.object.dispatchEvent(n(u,{type:"pointerleave",intersection:p})),a.object.dispatchEvent(n(u,{type:"mouseleave",intersection:p})),p.object.dispatchEvent(n(u,{type:"pointerenter",intersection:p})),p.object.dispatchEvent(n(u,{type:"mouseenter",intersection:p})),a=p;return}p.object===a.object&&(p.object.dispatchEvent(n(u,{type:"pointermove",intersection:p})),p.object.dispatchEvent(n(u,{type:"mousemove",intersection:p})))}this.dispatchEvent(n(u,{type:"pointermove",intersections:h})),this.dispatchEvent(n(u,{type:"mousemove",intersections:h}))}),this}}const xo=function(r){if(this.eventManager)return console.warn("engine has installed eventManager plugin."),!1;if(!this.pointerManager)return console.error("must install pointerManager before this plugin."),!1;const t=new Ro(Object.assign({scene:this.scene,camera:this.camera},r));return t.use(this.pointerManager),this.eventManager=t,this.addEventListener("setCamera",e=>{this.eventManager.setCamera(e.camera)}),this.addEventListener("setScene",e=>{this.eventManager.setScene(e.scene)}),!0};var Gr=(r=>(r.OBJECTCHANGED="objectChanged",r))(Gr||{});class Br extends oo.TransformControls{constructor(e,n){!e&&(e=new l.PerspectiveCamera),!n&&(n=document.body);super(e,n);c(this,"target");c(this,"transObjectSet");this.domElement.removeEventListener("pointerdown",this._onPointerDown),this._onPointerDown=h=>{var p;!this.enabled||!((p=this.object)!=null&&p.parent)||(this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(h)),this.pointerDown(this._getPointer(h)))},this.domElement.addEventListener("pointerdown",this._onPointerDown),this.target=new l.Object3D,this.transObjectSet=new Set;let o="";const s=this.target,i=this.transObjectSet,a={x:0,y:0,z:0},u=new WeakMap;this.addEventListener("mouseDown",h=>{o=h.target.mode,o==="translate"&&(o="position"),o==="rotate"&&(o="rotation"),a.x=s[o].x,a.y=s[o].y,a.z=s[o].z,i.forEach(p=>{u.set(p,p.matrixAutoUpdate),p.matrixAutoUpdate=!1})}),this.addEventListener("objectChange",h=>{const p=s[o].x-a.x,m=s[o].y-a.y,T=s[o].z-a.z;a.x=s[o].x,a.y=s[o].y,a.z=s[o].z,i.forEach(b=>{b[o].x+=p,b[o].y+=m,b[o].z+=T,b.updateMatrix(),b.updateMatrixWorld()}),this.dispatchEvent({type:"objectChanged",transObjectSet:i,mode:o,target:s})}),this.addEventListener("mouseUp",h=>{i.forEach(p=>{p.matrixAutoUpdate=u.get(p),u.delete(p)})})}setDom(e){return this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),e.addEventListener("pointerdown",this._onPointerDown),e.addEventListener("pointermove",this._onPointerHover),e.addEventListener("pointerup",this._onPointerUp),this.domElement=e,this}setCamera(e){return this.camera=e,this}getTarget(){return this.target}getTransObjectSet(){return this.transObjectSet}setAttach(...e){if(this.transObjectSet.clear(),!e.length||!e[0])return this.detach(),this;this.attach(this.target);const n=this.target;if(e.length===1){const a=e[0];return a.matrixWorld.decompose(n.position,n.quaternion,n.scale),n.updateMatrix(),n.updateMatrixWorld(),this.transObjectSet.add(a),this}const o=[],s=[],i=[];return e.forEach(a=>{o.push(a.matrixWorld.elements[12]),s.push(a.matrixWorld.elements[13]),i.push(a.matrixWorld.elements[14])}),n.rotation.set(0,0,0),n.scale.set(0,0,0),n.position.x=(Math.max(...o)-Math.min(...o))/2+Math.min(...o),n.position.y=(Math.max(...s)-Math.min(...s))/2+Math.min(...s),n.position.z=(Math.max(...i)-Math.min(...i))/2+Math.min(...i),n.updateMatrix(),n.updateMatrixWorld(),e.forEach(a=>{this.transObjectSet.add(a)}),this}}const Oo=function(r){if(this.transformControls)return console.warn("this has installed transformControls plugin."),!1;if(!this.pointerManager)return console.warn("this must install pointerManager before install transformControls plugin."),!1;if(!this.eventManager)return console.warn("this must install eventManager before install transformControls plugin."),!1;const t=new Br(this.camera,this.dom);return t.detach(),this.transformControls=t,this.scene.add(this.transformControls),this.scene.add(this.transformControls.target),this.transformControls.addEventListener("mouseDown",()=>{this.transing=!0}),this.setTransformControls=function(e){return e?this.scene.add(this.transformControls):this.scene.remove(this.transformControls),this},this.addEventListener("setCamera",e=>{e.options.transformControls&&t.setCamera(e.camera)}),this.addEventListener("setDom",e=>{t.setDom(e.dom)}),this.addEventListener("setScene",e=>{const n=e.scene;n.add(this.transformControls.target),n.add(this.transformControls)}),this.selectionBox?this.addEventListener("selected",e=>{t.setAttach(...e.objects)}):this.eventManager.addEventListener("click",e=>{if(this.transing){this.transing=!1;return}if(e.button===0){const o=e.intersections.map(s=>s.object)[0]||null;o?t.setAttach(o):t.detach()}}),this.eventManager.addFilterObject(t),this.completeSet.add(()=>{if(this.IS_ENGINESUPPORT){const e=s=>{const i=this.compilerManager.getObjectSymbol(s);return i?this.dataSupportManager.getConfigBySymbol(i):null};let n=null,o;t.addEventListener(Gr.OBJECTCHANGED,s=>{const i=s;i.transObjectSet.forEach(a=>{n=e(a),o=i.mode,n&&(n[o].x=a[o].x,n[o].y=a[o].y,n[o].z=a[o].z)})})}}),!0},Lo=function(r={}){if(this.webGLRenderer)return console.warn("this has installed webglRenderer plugin."),!1;this.webGLRenderer=new l.WebGLRenderer(r);const t=this.webGLRenderer.domElement;return t.style.position="absolute",t.style.top="0",t.style.left="0",t.classList.add("vis-webgl"),this.getScreenshot=async function(e={}){const n={width:this.dom.offsetWidth,height:this.dom.offsetHeight};!e.width&&(e.width=this.dom.offsetWidth),!e.height&&(e.height=this.dom.offsetHeight),!e.mine&&(e.mine="image/png");let o=!1;this.renderManager.hasRendering()&&(this.renderManager.stop(),o=!0);let s="";const i=this.webGLRenderer.getContext(),u=i.getParameter(i.MAX_RENDERBUFFER_SIZE)/4;if(e.width>u||e.height>u){const h=[],p=Math.ceil(e.width/u),m=Math.ceil(e.height/u),T=e.width/p,b=e.height/m,v=document.createElement("canvas");v.setAttribute("width",e.width.toString()),v.setAttribute("height",e.height.toString());const S=v.getContext("2d");if(!S)return console.warn("can not support canvas 2d;"),s;this.setSize(T,b);for(let w=0;w<p;w+=1)for(let D=0;D<m;D+=1)h.push({x:T*w,y:b*D});const R=[];h.forEach(w=>{this.camera.setViewOffset(e.width,e.height,w.x,w.y,T,b),this.renderManager.render();const D=this.webGLRenderer.domElement.toDataURL(e.mine);R.push(new Promise((j,$)=>{const O=new Image;O.src=D,O.onload=()=>{S.drawImage(O,w.x,w.y,T,b),j(null)}}))}),this.setSize(n.width,n.height),await Promise.all(R).catch(w=>{console.warn(w)}),s=v.toDataURL(e.mine),this.camera.clearViewOffset()}else this.setSize(e.width,e.height),this.renderManager.render(),s=this.webGLRenderer.domElement.toDataURL(e.mine),this.setSize(n.width,n.height);return o&&this.renderManager.play(),s},this.addEventListener("setDom",e=>{e.dom.appendChild(this.webGLRenderer.domElement)}),this.addEventListener("setSize",e=>{this.webGLRenderer.setSize(e.width,e.height,!0)}),this.addEventListener("dispose",()=>{this.webGLRenderer.dispose()}),this.renderManager?(this.renderManager.removeEventListener("render",this.render),this.renderManager.addEventListener("render",e=>{this.webGLRenderer.render(this.scene,this.camera)})):this.render=function(){return this.webGLRenderer.render(this.scene,this.camera),this},!0},Ke=class extends l.Loader{constructor(t){super(t)}load(t,e,n,o){this.path!==void 0&&(t=this.path+t),this.manager.itemStart(t),t=this.manager.resolveURL(t);const s=l.Cache.get(t);if(s!==void 0)return setTimeout(()=>{e&&e(s),this.manager.itemEnd(t)},0),s;const i=document.createElement("video");return i.preload=Ke.preload,i.autoplay=Ke.autoplay,i.loop=Ke.loop,i.muted=Ke.muted,i.src=t,i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.zIndex="-1",document.body.appendChild(i),i.oncanplay=()=>{l.Cache.add(t,i),this.manager.itemEnd(t),e&&e(i)},i.onerror=a=>{this.manager.itemEnd(t),o&&o(a)},i}};let Se=Ke;c(Se,"autoplay",!0),c(Se,"preload","auto"),c(Se,"muted",!0),c(Se,"loop",!0);class Ur extends te{constructor(e){super();c(this,"resourceMap");c(this,"loaderMap");c(this,"urlList",[]);c(this,"loadTotal");c(this,"loadSuccess");c(this,"loadError");c(this,"isError");c(this,"isLoading");c(this,"isLoaded");c(this,"loadDetailMap");c(this,"path","");this.resourceMap=new Map,this.loadTotal=0,this.loadSuccess=0,this.loadError=0,this.isError=!1,this.isLoading=!1,this.isLoaded=!1,this.loadDetailMap={};const n=new l.ImageLoader,o=new Se,s=new co.GLTFLoader;s.setDRACOLoader(new lo.DRACOLoader),s.setKTX2Loader(new uo.KTX2Loader),s.setMeshoptDecoder(po.MeshoptDecoder),this.loaderMap={jpg:n,png:n,jpeg:n,obj:new so.OBJLoader,mtl:new io.MTLLoader,mp4:o,webm:o,ogg:o,hdr:new ao.RGBELoader,gltf:s,glb:s},e&&(this.loaderMap=Object.assign(this.loaderMap,e.loaderExtends))}loaded(){return this.dispatchEvent({type:"loaded",loadTotal:this.loadTotal,loadSuccess:this.loadSuccess,loadError:this.loadError,resourceMap:this.resourceMap}),this}checkLoaded(){return this.loadTotal===this.loadSuccess+this.loadError&&(this.isError=!0,this.isLoaded=!0,this.isLoading=!1,this.loaded()),this}setPath(e){return this.path=e,this}setRequestHeader(e){return Object.values(this.loaderMap).forEach(n=>{n.setRequestHeader(e)}),this}setResponseType(e){return Object.values(this.loaderMap).forEach(n=>{n.setResponseType&&n.setResponseType(e)}),this}getLoader(e){return this.loaderMap[e]?this.loaderMap[e]:null}load(e){var i;if(this.reset(),this.isLoading=!0,this.dispatchEvent({type:"beforeLoad",urlList:[...e]}),e.length<=0)return this.checkLoaded(),console.warn("url list is empty."),this;this.loadTotal+=e.length;const n=this.resourceMap,o=this.loaderMap,s=this.loadDetailMap;for(const a of e){let u,h;typeof a=="string"?(u=a,h=((i=u.split(".").pop())==null?void 0:i.toLocaleLowerCase())||""):(u=a.url,h=a.ext.toLocaleLowerCase(),h.startsWith(".")&&(h=h.slice(1)));const p={url:u,progress:0,error:!1,message:u};if(s[u]=p,n.has(u)){p.progress=1,this.loadSuccess+=1,this.dispatchEvent({type:"detailLoaded",detail:p}),this.dispatchEvent({type:"loading",loadTotal:this.loadTotal,loadSuccess:this.loadSuccess,loadError:this.loadError}),this.checkLoaded();continue}if(!h){p.message=`url: ${u} \u5730\u5740\u6709\u8BEF\uFF0C\u65E0\u6CD5\u83B7\u53D6\u6587\u4EF6\u683C\u5F0F\u3002`,console.warn(p.message),p.error=!0,this.isError=!0,this.loadError+=1,this.dispatchEvent({type:"detailLoaded",detail:p}),this.dispatchEvent({type:"loading",loadTotal:this.loadTotal,loadSuccess:this.loadSuccess,loadError:this.loadError});continue}const m=o[h];if(!m){p.message=`url: ${u} \u4E0D\u652F\u6301\u6B64\u6587\u4EF6\u683C\u5F0F\u52A0\u8F7D\u3002`,console.warn(p.message),p.error=!0,this.isError=!0,this.loadError+=1,this.dispatchEvent({type:"detailLoaded",detail:p}),this.dispatchEvent({type:"loading",loadTotal:this.loadTotal,loadSuccess:this.loadSuccess,loadError:this.loadError});continue}const T=u.replace(/\\/g,"/").split("/"),b=T.pop(),v=this.path+T.join("/")+"/";m.setPath(v).loadAsync(b,S=>{p.progress=Number((S.loaded/S.total).toFixed(2)),this.dispatchEvent({type:"detailLoading",detail:p})}).then(S=>{p.progress=1,this.loadSuccess+=1,this.resourceMap.set(u,S),this.urlList.push(a),this.dispatchEvent({type:"detailLoaded",detail:p}),this.dispatchEvent({type:"loading",loadTotal:this.loadTotal,loadSuccess:this.loadSuccess,loadError:this.loadError}),this.checkLoaded()}).catch(S=>{p.error=!0,p.message=JSON.stringify(S),this.loadError+=1,this.dispatchEvent({type:"detailLoaded",detail:p}),this.dispatchEvent({type:"loading",loadTotal:this.loadTotal,loadSuccess:this.loadSuccess,loadError:this.loadError}),this.checkLoaded()})}return this}reset(){return this.loadTotal=0,this.loadSuccess=0,this.loadError=0,this.isError=!1,this.isLoading=!1,this.isLoaded=!1,this.loadDetailMap={},this}register(e,n){return this.loaderMap[e]=n,this}hasLoaded(e){return this.resourceMap.has(e)}getResource(e){return this.resourceMap.get(e)}getLoadDetailMap(){return this.loadDetailMap}setLoadDetailMap(e){return this.loadDetailMap=e,this}remove(e){}toJSON(){return JSON.stringify(this.urlList)}exportConfig(){return JSON.parse(JSON.stringify(this.urlList))}dispose(){return this.resourceMap.clear(),this}}const Ao=function(r){if(this.loaderManager)return console.warn("engine has installed loaderManager plugin."),!1;const t=new Ur(r);return this.loaderManager=t,this.loadResources=(e,n)=>{if(this.resourceManager){const o=s=>{n(void 0,s),this.resourceManager.removeEventListener("mapped",o)};try{this.resourceManager.addEventListener("mapped",o)}catch(s){n(s)}}else{const o=s=>{n(void 0,s),this.loaderManager.removeEventListener("loaded",o)};try{this.loaderManager.addEventListener("loaded",o)}catch(s){n(s)}}return this.loaderManager.load(e),this},this.loadResourcesAsync=e=>new Promise((n,o)=>{if(this.resourceManager){const s=i=>{n(i),this.resourceManager.removeEventListener("mapped",s)};try{this.resourceManager.addEventListener("mapped",s)}catch(i){o(i)}}else{const s=i=>{n(i),this.loaderManager.removeEventListener("loaded",s)};try{this.loaderManager.addEventListener("loaded",s)}catch(i){o(i)}}this.loaderManager.load(e)}),!0};var d=(r=>(r.BOXGEOMETRY="BoxGeometry",r.SPHEREGEOMETRY="SphereGeometry",r.LOADGEOMETRY="LoadGeometry",r.PLANEGEOMETRY="PlaneGeometry",r.CIRCLEGEOMETRY="CircleGeometry",r.CONEGEOMETRY="ConeGeometry",r.CYLINDERGEOMETRY="CylinderGeometry",r.DODECAHEDRONGEOMETRY="DodecahedronGeometry",r.TORUSGEOMETRY="TorusGeometry",r.RINGGEOMETRY="RingGeometry",r.EDGESGEOMETRY="EdgesGeometry",r.LINECURVEGEOMETRY="LineCurveGeometry",r.SPLINECURVEGEOMETRY="SplineCurveGeometry",r.CUBICBEZIERCURVEGEOMETRY="CubicBezierCurveGeometry",r.QUADRATICBEZIERCURVEGEOMETRY="QuadraticBezierCurveGeometry",r.CUSTOMGEOMETRY="CustomGeometry",r.LINETUBEGEOMETRY="LineTubeGeometry",r.SPLINETUBEGEOMETRY="SplineTubeGeometry",r.LINESHAPEGEOMETRY="LineShapeGeometry",r.OBJECT3D="Object3D",r.MESH="Mesh",r.LINE="Line",r.POINTS="Points",r.SPRITE="Sprite",r.GROUP="Group",r.CSS3DOBJECT="CSS3DObject",r.CSS3DSPRITE="CSS3DSprite",r.CSS3DPLANE="CSS3DPlane",r.IMAGETEXTURE="ImageTexture",r.CUBETEXTURE="CubeTexture",r.CANVASTEXTURE="CanvasTexture",r.VIDEOTEXTURE="VideoTexture",r.LOADTEXTURE="LoadTexture",r.MESHBASICMATERIAL="MeshBasicMaterial",r.MESHSTANDARDMATERIAL="MeshStandardMaterial",r.MESHPHONGMATERIAL="MeshPhongMaterial",r.SPRITEMATERIAL="SpriteMaterial",r.LINEBASICMATERIAL="LineBasicMaterial",r.POINTSMATERIAL="PointsMaterial",r.SHADERMATERIAL="ShaderMaterial",r.MESHPHYSICALMATERIAL="MeshPhysicalMaterial",r.AMBIENTLIGHT="AmbientLight",r.SPOTLIGHT="SpotLight",r.POINTLIGHT="PointLight",r.DIRECTIONALLIGHT="DirectionalLight",r.HEMISPHERELIGHT="HemisphereLight",r.PERSPECTIVECAMERA="PerspectiveCamera",r.ORTHOGRAPHICCAMERA="OrthographicCamera",r.WEBGLRENDERER="WebGLRenderer",r.CSS3DRENDERER="CSS3DRenderer",r.SCENE="Scene",r.TRNASFORMCONTROLS="TransformControls",r.ORBITCONTROLS="OrbitControls",r.SMAAPASS="SMAAPass",r.UNREALBLOOMPASS="UnrealBloomPass",r.SELECTIVEBLOOMPASS="SelectiveBloomPass",r.SCRIPTANIMATION="ScriptAnimation",r.KEYFRAMEANIMATION="KeyframeAnimation",r))(d||{}),y=(r=>(r.OBJECT3D="object3D",r.CAMERA="camera",r.LIGHT="light",r.GEOMETRY="geometry",r.TEXTURE="texture",r.MATERIAL="material",r.RENDERER="renderer",r.SCENE="scene",r.SPRITE="sprite",r.CONTROLS="controls",r.LINE="line",r.MESH="mesh",r.POINTS="points",r.GROUP="group",r.CSS3D="css3D",r.PASS="pass",r.ANIMATION="animation",r))(y||{}),lt=(r=>(r.CAMERA="camera",r.LIGHT="light",r.SCENE="scene",r.SPRITE="sprite",r.LINE="line",r.MESH="mesh",r.POINTS="points",r.GROUP="group",r.CSS3D="css3D",r.OBJECT3D="object3D",r))(lt||{});const Do={[d.IMAGETEXTURE]:y.TEXTURE,[d.CUBETEXTURE]:y.TEXTURE,[d.CANVASTEXTURE]:y.TEXTURE,[d.VIDEOTEXTURE]:y.TEXTURE,[d.MESHBASICMATERIAL]:y.MATERIAL,[d.MESHSTANDARDMATERIAL]:y.MATERIAL,[d.MESHPHONGMATERIAL]:y.MATERIAL,[d.SPRITEMATERIAL]:y.MATERIAL,[d.LINEBASICMATERIAL]:y.MATERIAL,[d.POINTSMATERIAL]:y.MATERIAL,[d.SHADERMATERIAL]:y.MATERIAL,[d.AMBIENTLIGHT]:y.LIGHT,[d.SPOTLIGHT]:y.LIGHT,[d.POINTLIGHT]:y.LIGHT,[d.DIRECTIONALLIGHT]:y.LIGHT,[d.BOXGEOMETRY]:y.GEOMETRY,[d.SPHEREGEOMETRY]:y.GEOMETRY,[d.LOADGEOMETRY]:y.GEOMETRY,[d.CUSTOMGEOMETRY]:y.GEOMETRY,[d.PLANEGEOMETRY]:y.GEOMETRY,[d.CIRCLEGEOMETRY]:y.GEOMETRY,[d.CONEGEOMETRY]:y.GEOMETRY,[d.CIRCLEGEOMETRY]:y.GEOMETRY,[d.EDGESGEOMETRY]:y.GEOMETRY,[d.CYLINDERGEOMETRY]:y.GEOMETRY,[d.LINECURVEGEOMETRY]:y.GEOMETRY,[d.SPLINECURVEGEOMETRY]:y.GEOMETRY,[d.CUBICBEZIERCURVEGEOMETRY]:y.GEOMETRY,[d.QUADRATICBEZIERCURVEGEOMETRY]:y.GEOMETRY,[d.LINETUBEGEOMETRY]:y.GEOMETRY,[d.SPLINETUBEGEOMETRY]:y.GEOMETRY,[d.TORUSGEOMETRY]:y.GEOMETRY,[d.RINGGEOMETRY]:y.GEOMETRY,[d.LINESHAPEGEOMETRY]:y.GEOMETRY,[d.SPRITE]:y.SPRITE,[d.LINE]:y.LINE,[d.MESH]:y.MESH,[d.POINTS]:y.POINTS,[d.GROUP]:y.GROUP,[d.CSS3DOBJECT]:y.CSS3D,[d.CSS3DSPRITE]:y.CSS3D,[d.CSS3DPLANE]:y.CSS3D,[d.PERSPECTIVECAMERA]:y.CAMERA,[d.ORTHOGRAPHICCAMERA]:y.CAMERA,[d.WEBGLRENDERER]:y.RENDERER,[d.SCENE]:y.SCENE,[d.TRNASFORMCONTROLS]:y.CONTROLS,[d.ORBITCONTROLS]:y.CONTROLS,[d.SMAAPASS]:y.PASS,[d.UNREALBLOOMPASS]:y.PASS,[d.SCRIPTANIMATION]:y.ANIMATION,[d.KEYFRAMEANIMATION]:y.ANIMATION},Ne=r=>{const t=e=>r.toLocaleLowerCase().includes(e.toLocaleLowerCase());for(const e of Object.values(y))if(t(e))return e;return null},le=()=>({vid:"",name:"",type:d.OBJECT3D,castShadow:!0,receiveShadow:!0,lookAt:"",visible:!0,matrixAutoUpdate:!0,renderOrder:0,position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},up:{x:0,y:1,z:0},parent:"",children:[],pointerdown:[],pointermove:[],pointerup:[],pointerenter:[],pointerleave:[],click:[],dblclick:[],contextmenu:[]}),ut=function(){return Object.assign(le(),{type:"Light",color:"rgb(255, 255, 255)",intensity:1})},Po=function(){return Object.assign(le(),{type:d.AMBIENTLIGHT,color:"rgb(255, 255, 255)",intensity:1})},jo=function(){return Object.assign(ut(),{type:d.POINTLIGHT,distance:30,decay:.01})},Io=function(){return Object.assign(ut(),{type:d.SPOTLIGHT,distance:30,angle:Math.PI/180*45,penumbra:.01,decay:.01})},Go=function(){return Object.assign(ut(),{type:d.DIRECTIONALLIGHT,shadow:{mapSize:{width:512,height:512},camera:{near:.5,far:500}}})},Bo=function(){return Object.assign(ut(),{type:d.HEMISPHERELIGHT,color:"rgb(255, 255, 255)",groundColor:"rgb(0, 0, 0)"})},Y=function(){return{vid:"",type:"Geometry",position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},groups:[]}},Uo=function(){return Object.assign(Y(),{type:d.BOXGEOMETRY,width:5,height:5,depth:5,widthSegments:1,heightSegments:1,depthSegments:1})},Ho=function(){return Object.assign(Y(),{type:d.SPHEREGEOMETRY,radius:3,widthSegments:32,heightSegments:32,phiStart:0,phiLength:Math.PI*2,thetaStart:0,thetaLength:Math.PI})},No=function(){return Object.assign(Y(),{type:d.PLANEGEOMETRY,width:5,height:5,widthSegments:1,heightSegments:1})},zo=function(){return Object.assign(Y(),{type:d.CIRCLEGEOMETRY,radius:3,segments:8,thetaStart:0,thetaLength:Math.PI*2})},Fo=function(){return Object.assign(Y(),{type:d.CONEGEOMETRY,radius:3,height:5,radialSegments:8,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:Math.PI*2})},ko=function(){return Object.assign(Y(),{type:d.TORUSGEOMETRY,radius:3,tube:.4,radialSegments:8,tubularSegments:6,arc:Math.PI*2})},$o=function(){return Object.assign(Y(),{type:d.RINGGEOMETRY,innerRadius:2,outerRadius:3,thetaSegments:8,phiSegments:8,thetaStart:0,thetaLength:Math.PI*2})},Vo=function(){return Object.assign(Y(),{type:d.LOADGEOMETRY,url:""})},Wo=function(){return Object.assign(Y(),{type:d.CUSTOMGEOMETRY,attribute:{position:[],color:[],index:[],normal:[],uv:[],uv2:[]}})},_o=function(){return Object.assign(Y(),{type:d.CYLINDERGEOMETRY,radiusTop:3,radiusBottom:3,height:5,radialSegments:8,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:Math.PI*2})},Yo=function(){return Object.assign(Y(),{type:"",radius:3,detail:0})},Qo=function(){return Object.assign(Y(),{type:d.LOADGEOMETRY,url:"",thresholdAngle:1})},dt=function(){return Object.assign(Y(),{path:[],divisions:36,space:!0})},Xo=function(){return Object.assign(dt(),{type:d.LINECURVEGEOMETRY})},Ko=function(){return Object.assign(dt(),{type:d.SPLINECURVEGEOMETRY})},Jo=function(){return Object.assign(dt(),{type:d.CUBICBEZIERCURVEGEOMETRY})},Zo=function(){return Object.assign(dt(),{type:d.QUADRATICBEZIERCURVEGEOMETRY})},Hr=function(){return Object.assign(Y(),{type:"TubeGeometry",path:[],tubularSegments:64,radius:1,radialSegments:8,closed:!1})},qo=function(){return Object.assign(Hr(),{type:d.LINETUBEGEOMETRY})},es=function(){return Object.assign(Hr(),{type:d.SPLINETUBEGEOMETRY})},ts=function(){return Object.assign(Y(),{path:[],curveSegments:12})},rs=function(){return Object.assign(ts(),{type:d.LINESHAPEGEOMETRY})},Ze=function(){return{vid:"",type:"Texture",name:"",mapping:l.UVMapping,wrapS:l.ClampToEdgeWrapping,wrapT:l.ClampToEdgeWrapping,magFilter:l.LinearFilter,minFilter:l.LinearMipmapLinearFilter,anisotropy:1,format:l.RGBAFormat,flipY:!0,offset:{x:0,y:0},repeat:{x:1,y:1},rotation:0,center:{x:0,y:0},matrixAutoUpdate:!0,encoding:l.LinearEncoding,needsUpdate:!1}},ns=function(){return Object.assign(Ze(),{type:d.IMAGETEXTURE,url:""})},os=function(){return Object.assign(Ze(),{type:d.VIDEOTEXTURE,url:"",minFilter:l.LinearFilter})},ss=function(){return Object.assign(Ze(),{type:d.CUBETEXTURE,cube:{nx:"",ny:"",nz:"",px:"",py:"",pz:""},mapping:l.CubeReflectionMapping,flipY:!1})},is=function(){return Object.assign(Ze(),{type:d.CANVASTEXTURE,url:"",needsUpdate:!1})},as=function(){return Object.assign(Ze(),{type:d.LOADTEXTURE,url:""})},Pe=function(){return{vid:"",type:"Material",alphaTest:0,colorWrite:!0,depthTest:!0,depthWrite:!0,fog:!0,name:"",needsUpdate:!1,opacity:1,dithering:!1,shadowSide:null,side:l.FrontSide,toneMapped:!0,transparent:!1,visible:!0,blendDst:l.OneMinusSrcAlphaFactor,blendDstAlpha:null,blendEquation:l.AddEquation,blendEquationAlpha:null,blending:l.NormalBlending,blendSrc:l.SrcAlphaFactor,blendSrcAlpha:null,polygonOffset:!1,polygonOffsetFactor:0,polygonOffsetUnits:0}},cs=function(){return Object.assign(Pe(),{type:d.MESHBASICMATERIAL,color:"rgb(255, 255, 255)",combine:l.MultiplyOperation,aoMapIntensity:1,fog:!0,lightMapIntensity:1,reflectivity:1,refractionRatio:.98,wireframe:!1,wireframeLinecap:"round",wireframeLinejoin:"round",wireframeLinewidth:1,map:"",envMap:"",alphaMap:"",aoMap:"",lightMap:"",specularMap:""})},Nr=function(){return Object.assign(Pe(),{type:d.MESHSTANDARDMATERIAL,aoMapIntensity:1,bumpScale:1,color:"rgb(255, 255, 255)",displacementScale:1,displacementBias:0,emissive:"rgb(0, 0, 0)",emissiveIntensity:1,envMapIntensity:1,flatShading:!1,lightMapIntensity:1,metalness:0,normalMapType:l.TangentSpaceNormalMap,refractionRatio:.98,roughness:1,wireframe:!1,wireframeLinecap:"round",wireframeLinejoin:"round",roughnessMap:"",normalMap:"",metalnessMap:"",map:"",lightMap:"",envMap:"",emissiveMap:"",displacementMap:"",bumpMap:"",alphaMap:"",aoMap:""})},ls=function(){return Object.assign(Nr(),{type:d.MESHPHYSICALMATERIAL,attenuationColor:"rgb(255, 255, 255)",attenuationDistance:0,clearcoat:0,clearcoatNormalScale:{x:1,y:1},clearcoatRoughness:0,ior:1.5,reflectivity:.5,sheen:0,sheenRoughness:1,sheenColor:"rgb(255, 255, 255)",specularIntensity:0,specularColor:"rgb(255, 255, 255)",thickness:0,transmission:0,clearcoatMap:"",clearcoatNormalMap:"",clearcoatRoughnessMap:"",sheenRoughnessMap:"",sheenColorMap:"",specularIntensityMap:"",specularColorMap:"",thicknessMap:"",transmissionMap:""})},us=function(){return Object.assign(Pe(),{type:d.MESHPHONGMATERIAL,aoMapIntensity:1,bumpScale:1,color:"rgb(255, 255, 255)",displacementScale:1,displacementBias:0,emissive:"rgb(0, 0, 0)",emissiveIntensity:1,envMapIntensity:1,flatShading:!1,lightMapIntensity:1,normalMapType:l.TangentSpaceNormalMap,refractionRatio:.98,wireframe:!1,wireframeLinecap:"round",wireframeLinejoin:"round",specular:"rgb(17, 17, 17)",shininess:30,combine:l.MultiplyOperation,normalMap:"",map:"",lightMap:"",envMap:"",emissiveMap:"",displacementMap:"",bumpMap:"",alphaMap:"",aoMap:"",specularMap:""})},ds=function(){return Object.assign(Pe(),{type:d.SPRITEMATERIAL,color:"rgb(255, 255, 255)",rotation:0,map:"",alphaMap:"",sizeAttenuation:!0})},ps=function(){return Object.assign(Pe(),{type:d.LINEBASICMATERIAL,color:"rgb(255, 255, 255)",linecap:"round",linejoin:"round",linewidth:1})},hs=function(){return Object.assign(Pe(),{type:d.POINTSMATERIAL,map:"",alphaMap:"",color:"rgb(255, 255, 255)",sizeAttenuation:!0,size:1})},fs=function(){return Object.assign(Pe(),{type:d.SHADERMATERIAL,shader:"defaultShader",uniforms:{}})},ms=function(){return Object.assign(le(),{type:d.PERSPECTIVECAMERA,adaptiveWindow:!1,fov:45,aspect:1920/1080,near:5,far:50})},gs=function(){return Object.assign(le(),{type:d.ORTHOGRAPHICCAMERA,adaptiveWindow:!1,left:-window.innerWidth,right:window.innerWidth,top:window.innerHeight,bottom:-window.innerHeight,near:5,far:50,zoom:1})};d.WEBGLRENDERER+"",d.CSS3DRENDERER+"",d.SCENE+"";const N=function(r){return`DEFUALT-${r}`},zr=function(){return{vid:"",type:"Renderer",size:null}},ys=function(){return Object.assign(zr(),{vid:N(d.WEBGLRENDERER),type:d.WEBGLRENDERER,clearColor:"rgba(0, 0, 0, 0)",outputEncoding:l.LinearEncoding,physicallyCorrectLights:!1,shadowMap:{enabled:!1,autoUpdate:!0,needsUpdate:!1,type:l.PCFShadowMap},toneMapping:l.NoToneMapping,toneMappingExposure:1,pixelRatio:window.devicePixelRatio,adaptiveCamera:!1,viewport:null,scissor:null})},Es=function(){return Object.assign(zr(),{vid:N(d.CSS3DRENDERER),type:d.CSS3DRENDERER})},Ss=function(){return Object.assign(le(),{vid:N(d.SCENE),type:d.SCENE,background:"",environment:"",fog:{type:"",color:"rgb(150, 150, 150)",near:1,far:200,density:.003}})},bs=function(){return{vid:N(d.TRNASFORMCONTROLS),type:d.TRNASFORMCONTROLS,axis:"XYZ",enabled:!0,mode:"translate",snapAllow:!1,rotationSnap:Math.PI/180*10,translationSnap:5,scaleSnap:.1,showX:!0,showY:!0,showZ:!0,size:1,space:"world"}},Ms=function(){return{vid:N(d.ORBITCONTROLS),type:d.ORBITCONTROLS,autoRotate:!1,autoRotateSpeed:2,enableDamping:!1,dampingFactor:.05,enabled:!0,enablePan:!0,enableRotate:!0,enableZoom:!0,maxAzimuthAngle:1/0,maxDistance:1/0,maxPolarAngle:Math.PI,maxZoom:1/0,minAzimuthAngle:-1/0,minDistance:0,minPolarAngle:0,minZoom:0,panSpeed:1,rotateSpeed:1,zoomSpeed:1,screenSpacePanning:!0,target:null}},pt=function(){return Object.assign(le(),{material:"",geometry:""})},vs=function(){return Object.assign(pt(),{type:"Sprite",material:"",center:{x:.5,y:.5}})},ws=function(){return Object.assign(pt(),{type:d.MESH,geometry:"",material:""})},Ts=function(){return Object.assign(pt(),{type:d.POINTS,geometry:"",material:""})},Cs=function(){return Object.assign(pt(),{type:d.LINE,geometry:"",material:""})},Rs=function(){return Object.assign(le(),{type:d.GROUP,children:[]})},Qt=function(){return{vid:"",type:"Pass"}},xs=function(){return Object.assign(Qt(),{type:d.SMAAPASS})},Os=function(){return Object.assign(Qt(),{type:d.UNREALBLOOMPASS,strength:1.5,threshold:0,radius:0})},Ls=function(){return Object.assign(Qt(),{type:d.SELECTIVEBLOOMPASS,strength:1,threshold:0,radius:0,renderScene:"",renderCamera:"",selectedObjects:[]})},Fr=function(){return{vid:"",type:"",name:"",target:"",attribute:"",play:!0}},As=function(){return Object.assign(Fr(),{type:d.SCRIPTANIMATION,script:{name:""}})},Ds=function(){return Object.assign(Fr(),{type:d.KEYFRAMEANIMATION,script:{name:""}})},Xt=function(){return Object.assign(le(),{type:d.CSS3DOBJECT,element:"",width:50,height:50})},Ps=function(){return Object.assign(Xt(),{type:d.CSS3DPLANE})},js=function(){return Object.assign(Xt(),{type:d.CSS3DSPRITE,rotation2D:0})},F={[d.IMAGETEXTURE]:ns,[d.CUBETEXTURE]:ss,[d.CANVASTEXTURE]:is,[d.VIDEOTEXTURE]:os,[d.LOADTEXTURE]:as,[d.MESHBASICMATERIAL]:cs,[d.MESHSTANDARDMATERIAL]:Nr,[d.MESHPHONGMATERIAL]:us,[d.SPRITEMATERIAL]:ds,[d.LINEBASICMATERIAL]:ps,[d.POINTSMATERIAL]:hs,[d.SHADERMATERIAL]:fs,[d.MESHPHYSICALMATERIAL]:ls,[d.AMBIENTLIGHT]:Po,[d.SPOTLIGHT]:Io,[d.POINTLIGHT]:jo,[d.DIRECTIONALLIGHT]:Go,[d.HEMISPHERELIGHT]:Bo,[d.BOXGEOMETRY]:Uo,[d.SPHEREGEOMETRY]:Ho,[d.LOADGEOMETRY]:Vo,[d.CUSTOMGEOMETRY]:Wo,[d.PLANEGEOMETRY]:No,[d.CIRCLEGEOMETRY]:zo,[d.CONEGEOMETRY]:Fo,[d.CYLINDERGEOMETRY]:_o,[d.EDGESGEOMETRY]:Qo,[d.LINECURVEGEOMETRY]:Xo,[d.SPLINECURVEGEOMETRY]:Ko,[d.CUBICBEZIERCURVEGEOMETRY]:Jo,[d.QUADRATICBEZIERCURVEGEOMETRY]:Zo,[d.DODECAHEDRONGEOMETRY]:Yo,[d.SPLINETUBEGEOMETRY]:es,[d.LINETUBEGEOMETRY]:qo,[d.TORUSGEOMETRY]:ko,[d.RINGGEOMETRY]:$o,[d.LINESHAPEGEOMETRY]:rs,[d.OBJECT3D]:le,[d.SPRITE]:vs,[d.LINE]:Cs,[d.MESH]:ws,[d.POINTS]:Ts,[d.GROUP]:Rs,[d.CSS3DOBJECT]:Xt,[d.CSS3DSPRITE]:js,[d.CSS3DPLANE]:Ps,[d.PERSPECTIVECAMERA]:ms,[d.ORTHOGRAPHICCAMERA]:gs,[d.WEBGLRENDERER]:ys,[d.CSS3DRENDERER]:Es,[d.SCENE]:Ss,[d.TRNASFORMCONTROLS]:bs,[d.ORBITCONTROLS]:Ms,[d.SMAAPASS]:xs,[d.UNREALBLOOMPASS]:Os,[d.SELECTIVEBLOOMPASS]:Ls,[d.SCRIPTANIMATION]:As,[d.KEYFRAMEANIMATION]:Ds};class je{}class Kt extends je{constructor(){super(...arguments);c(this,"selector",(e,n,o)=>n instanceof HTMLImageElement&&o.get(Kt)||null)}parse({url:e,resource:n,configMap:o,resourceMap:s}){const i=F[d.IMAGETEXTURE]();i.url=e,s.set(e,n),o.set(e,i)}}class Jt extends je{constructor(){super(...arguments);c(this,"selector",(e,n,o)=>n instanceof HTMLCanvasElement&&o.get(Jt)||null)}parse({url:e,resource:n,configMap:o,resourceMap:s}){const i=F[d.CANVASTEXTURE]();i.url=e,s.set(e,n),o.set(e,i)}}class Zt extends je{constructor(){super(...arguments);c(this,"selector",(e,n,o)=>n instanceof HTMLVideoElement&&o.get(Zt)||null)}parse({url:e,resource:n,configMap:o,resourceMap:s}){const i=F[d.VIDEOTEXTURE]();i.url=e,s.set(e,n),o.set(e,i)}}function Is(r,t){return r in t}function Gs(r,t){return Object.values(r).includes(t)}function Bs(r){return t=>{const e=(n,o)=>{for(const s in o){if(n[s]===void 0){console.warn(` config can not set key: ${s}`);continue}typeof o[s]=="object"&&o[s]!==null&&!Array.isArray(o[s])?e(n[s],o[s]):n[s]=o[s]}};return t&&e(r,t),r}}function W(r,t,e,n){const o=(s,i,a)=>{for(const u in s)if(i[u]!==void 0&&!(a&&a[u])){if(typeof s[u]=="object"&&typeof s[u]!==null){a&&typeof a[u]=="object"&&typeof a[u]!==null?o(s[u],i[u],a[u]):o(s[u],i[u]);continue}i[u]=s[u]}};o(r,t,e),n&&n()}const ze=function(r){return typeof r=="object"&&r!==null},qe=function(r){return typeof r=="object"&&r!==null&&Array.isArray(r)},be=function(r,t){return r&&t?`${r}.${t}`:r||t},qt=new WeakMap,ht=function(r){Array.isArray(r)&&!qt.has(r)&&qt.set(r,r.concat([]))},kr=function(r){return qt.get(r)};var Us=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",isValidKey:Is,isValidEnum:Gs,generateConfigFunction:Bs,syncObject:W,isObject:ze,isArray:qe,extendPath:be,cacheArray:ht,getCacheArray:kr});class ft extends je{constructor(){super(...arguments);c(this,"selector",(e,n,o)=>n.isObject3D&&o.get(ft)||null)}parse(e){this.parseObject3D(e)}parseColor(e){return`rgb(${Math.round(255*e.r)}, ${Math.round(255*e.g)}, ${Math.round(255*e.b)})`}attributeEnhance(e){const n={};for(const o in e)o.startsWith("_")?n[o.slice(1)]=e[o]:n[o]=e[o];return n}parseTexture({url:e,resource:n,configMap:o,resourceMap:s}){s.set(e,n);const i=F[d.LOADTEXTURE]();o.set(e,i),i.vid=ee.v4(),i.url=e,W(n,i,{type:!0,vid:!0,url:!0})}parseMaterial({url:e,resource:n,configMap:o,resourceMap:s}){if(s.set(e,n),!F[n.type]){console.warn("can not found support config in vis for this resource",n);return}const i=F[n.type]();o.set(e,i),i.vid=ee.v4(),W(this.attributeEnhance(n),i,{type:!0,vid:!0});for(const a in n)if(!!n[a]){if(n[a].isColor)i[a]=this.parseColor(n[a]);else if(a.toLocaleLowerCase().endsWith("map")&&n[a]){const u=`${e}.${a}`;this.parseTexture({url:u,resource:n[a],configMap:o,resourceMap:s}),i[a]=o.get(u).vid}}}parseGeometry({url:e,resource:n,configMap:o,resourceMap:s}){s.set(e,n),n.computeBoundingBox();const i=n.boundingBox,a=i.getCenter(new l.Vector3),u=F[d.LOADGEOMETRY]();u.vid=ee.v4(),u.url=e,u.position.x=a.x/(i.max.x-i.min.x)*2,u.position.y=a.y/(i.max.y-i.min.y)*2,u.position.z=a.z/(i.max.z-i.min.z)*2,o.set(e,u)}parseObject3D({url:e,resource:n,configMap:o,resourceMap:s}){if(s.set(e,n),!F[n.type]){console.warn("can not found support config in vis for this resource",n);return}const i=F[n.type]();if(i.vid=ee.v4(),W(n,i,{type:!0,vid:!0,children:!0,geometry:!0,material:!0,parent:!0,lookAt:!0}),i.rotation.x=n.rotation.x,i.rotation.y=n.rotation.y,i.rotation.z=n.rotation.z,o.set(e,i),n.material)if(Array.isArray(n.material))i.material=[],n.material.forEach((a,u,h)=>{const p=`${e}.material.${u}`;this.parseMaterial({url:p,resource:a,configMap:o,resourceMap:s}),i.material.push(o.get(p).vid)});else{const a=`${e}.material`;this.parseMaterial({url:a,resource:n.material,configMap:o,resourceMap:s}),i.material=o.get(a).vid}if(n.geometry){const a=`${e}.geometry`;this.parseGeometry({url:a,resource:n.geometry,configMap:o,resourceMap:s}),i.geometry=o.get(a).vid}n.children&&n.children.length&&n.children.forEach((a,u,h)=>{const p=`${e}.children.${u}`;this.parseObject3D({url:p,resource:a,configMap:o,resourceMap:s}),i.children.push(o.get(p).vid)})}}class er extends je{constructor(){super(...arguments);c(this,"selector",(e,n,o)=>n instanceof HTMLElement&&o.get(er)||null)}parse({url:e,resource:n,configMap:o,resourceMap:s}){const i=F[d.CSS3DPLANE]();i.element=e,s.set(e,n),o.set(e,i)}}class tr extends je{constructor(){super(...arguments);c(this,"selector",(e,n,o)=>n instanceof l.Texture&&o.get(tr)||null)}parse({url:e,resource:n,configMap:o,resourceMap:s}){const i=F[d.LOADTEXTURE]();i.url=e,s.set(e,n),o.set(e,i)}}class rr extends je{constructor(){super();c(this,"object3DParser",new ft);c(this,"selector",(e,n,o)=>n.parser&&n.animations&&n.scene&&n.scenes&&o.get(rr)||null)}parse({url:e,resource:n,configMap:o,resourceMap:s}){this.object3DParser.parse({url:`${e}.scene`,resource:n.scene,configMap:o,resourceMap:s})}}var $r=(r=>(r.MAPPED="mapped",r))($r||{});class Vr extends te{constructor(e={}){super();c(this,"configMap",new Map);c(this,"resourceMap",new Map);c(this,"paserMap",new Map);this.addParser(new Kt).addParser(new Jt).addParser(new Zt).addParser(new ft).addParser(new er).addParser(new tr).addParser(new rr);const n=new Map;for(const o in e)n.has(o)&&console.warn(`resourceManager construct params rescource already exist: ${o}, that will be cover.`),n.set(o,e[o]);this.mappingResource(n)}addParser(e){return this.paserMap.has(e.constructor)?this:(this.paserMap.set(e.constructor,e),this)}mappingResource(e,n){const o=this.configMap,s=this.resourceMap,i=[...this.paserMap.values()],a={};for(const[u,h]of e.entries()){if((n==null?void 0:n.parser)&&n.parser[u]){n.parser[u].parse({url:u,resource:h,configMap:o,resourceMap:s});continue}if((n==null?void 0:n.selector)&&n.selector[u]){const m=n.selector[u](u,h,this.paserMap);if(!m){console.warn("resource manager hanlder can not found this resource parser: ",h,n.selector[u]);continue}m.parse({url:u,resource:h,configMap:o,resourceMap:s}),a[u]=this.getResourceConfig(u);continue}let p=null;for(const m of i)if(p=m.selector(u,h,this.paserMap),p)break;if(!p){console.warn("resouce manager can not found some handler to parser this resource:",h);continue}p.parse({url:u,resource:h,configMap:o,resourceMap:s}),a[u]=this.getResourceConfig(u)}return this.dispatchEvent({type:"mapped",configMap:o,resourceMap:s,resourceConfig:a}),this}getResourceConfig(e){const n=this.configMap,o={};return[...n.keys()].filter(s=>s.startsWith(e)).forEach(s=>{const i=n.get(s);if(!i)console.error(`unknow error: can not found config by url: ${s}`);else{const a=Ne(i.type);a?(!o[a]&&(o[a]=[]),o[a].push(i)):console.error(`unknow error: can not found module by type: ${i.type}`,i)}}),o}hasResource(e){return this.resourceMap.has(e)}remove(e){const n=this.configMap,o=this.resourceMap;return[...n.keys()].filter(s=>s.startsWith(e)).forEach(s=>{n.delete(s);const i=o.get(s);i.dispose&&i.dispose(),o.delete(s)}),this}dispose(){this.resourceMap.forEach((e,n)=>{e.dispose&&e.dispose()}),this.resourceMap.clear(),this.configMap.clear()}}const Hs=function(r){if(this.resourceManager)return console.warn("engine has installed resourceManager plugin."),!1;const t=new Vr(r.resources);return this.resourceManager=t,this.loaderManager&&this.loaderManager.addEventListener("loaded",e=>{this.resourceManager.mappingResource(e.resourceMap)}),this.registerResources=e=>{const n=new Map;return Object.keys(e).forEach(o=>{n.set(o,e[o])}),this.resourceManager.mappingResource(n),this},this.addEventListener("dispose",()=>{this.resourceManager.dispose()}),!0},Fe=(r,t)=>t===1/0?"Infinity":t===-1/0?"-Infinity":t,nr=(r,t)=>t==="Infinity"?1/0:t==="-Infinity"?-1/0:t,et=r=>JSON.parse(JSON.stringify(r,Fe),nr);var mt={stringify:Fe,parse:nr,clone:et},Ns=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",stringify:Fe,parse:nr,clone:et,default:mt});class Wr{constructor(){c(this,"rule");c(this,"memberSet");this.rule=function(){},this.memberSet=new Set}apply(t){return this.memberSet.add(t),this}cancel(t){return this.memberSet.delete(t),this}setRule(t){return this.rule=t,this}translate(t){const e=this.rule;return this.memberSet.forEach(n=>{e(t,n)}),this}}var or=function(r,t){return or=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])},or(r,t)};function gt(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");or(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function sr(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function yt(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,s=[],i;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(a){i={error:a}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(i)throw i.error}}return s}function Et(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return r.concat(s||Array.prototype.slice.call(t))}function ue(r){return typeof r=="function"}function _r(r){var t=function(n){Error.call(n),n.stack=new Error().stack},e=r(t);return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var ir=_r(function(r){return function(e){r(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(n,o){return o+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function ar(r,t){if(r){var e=r.indexOf(t);0<=e&&r.splice(e,1)}}var St=function(){function r(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var t,e,n,o,s;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var a=sr(i),u=a.next();!u.done;u=a.next()){var h=u.value;h.remove(this)}}catch(S){t={error:S}}finally{try{u&&!u.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}else i.remove(this);var p=this.initialTeardown;if(ue(p))try{p()}catch(S){s=S instanceof ir?S.errors:[S]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var T=sr(m),b=T.next();!b.done;b=T.next()){var v=b.value;try{Xr(v)}catch(S){s=s!=null?s:[],S instanceof ir?s=Et(Et([],yt(s)),yt(S.errors)):s.push(S)}}}catch(S){n={error:S}}finally{try{b&&!b.done&&(o=T.return)&&o.call(T)}finally{if(n)throw n.error}}}if(s)throw new ir(s)}},r.prototype.add=function(t){var e;if(t&&t!==this)if(this.closed)Xr(t);else{if(t instanceof r){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(t)}},r.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},r.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},r.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&ar(e,t)},r.prototype.remove=function(t){var e=this._finalizers;e&&ar(e,t),t instanceof r&&t._removeParent(this)},r.EMPTY=function(){var t=new r;return t.closed=!0,t}(),r}(),Yr=St.EMPTY;function Qr(r){return r instanceof St||r&&"closed"in r&&ue(r.remove)&&ue(r.add)&&ue(r.unsubscribe)}function Xr(r){ue(r)?r():r.unsubscribe()}var cr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},lr={setTimeout:function(r,t){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];var o=lr.delegate;return o!=null&&o.setTimeout?o.setTimeout.apply(o,Et([r,t],yt(e))):setTimeout.apply(void 0,Et([r,t],yt(e)))},clearTimeout:function(r){var t=lr.delegate;return((t==null?void 0:t.clearTimeout)||clearTimeout)(r)},delegate:void 0};function zs(r){lr.setTimeout(function(){throw r})}function Kr(){}var bt=null;function Mt(r){if(cr.useDeprecatedSynchronousErrorHandling){var t=!bt;if(t&&(bt={errorThrown:!1,error:null}),r(),t){var e=bt,n=e.errorThrown,o=e.error;if(bt=null,n)throw o}}else r()}var Jr=function(r){gt(t,r);function t(e){var n=r.call(this)||this;return n.isStopped=!1,e?(n.destination=e,Qr(e)&&e.add(n)):n.destination=Vs,n}return t.create=function(e,n,o){return new dr(e,n,o)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(St),Fs=Function.prototype.bind;function ur(r,t){return Fs.call(r,t)}var ks=function(){function r(t){this.partialObserver=t}return r.prototype.next=function(t){var e=this.partialObserver;if(e.next)try{e.next(t)}catch(n){vt(n)}},r.prototype.error=function(t){var e=this.partialObserver;if(e.error)try{e.error(t)}catch(n){vt(n)}else vt(t)},r.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(e){vt(e)}},r}(),dr=function(r){gt(t,r);function t(e,n,o){var s=r.call(this)||this,i;if(ue(e)||!e)i={next:e!=null?e:void 0,error:n!=null?n:void 0,complete:o!=null?o:void 0};else{var a;s&&cr.useDeprecatedNextContext?(a=Object.create(e),a.unsubscribe=function(){return s.unsubscribe()},i={next:e.next&&ur(e.next,a),error:e.error&&ur(e.error,a),complete:e.complete&&ur(e.complete,a)}):i=e}return s.destination=new ks(i),s}return t}(Jr);function vt(r){zs(r)}function $s(r){throw r}var Vs={closed:!0,next:Kr,error:$s,complete:Kr},Ws=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function _s(r){return r}function Ys(r){return r.length===0?_s:r.length===1?r[0]:function(e){return r.reduce(function(n,o){return o(n)},e)}}var Zr=function(){function r(t){t&&(this._subscribe=t)}return r.prototype.lift=function(t){var e=new r;return e.source=this,e.operator=t,e},r.prototype.subscribe=function(t,e,n){var o=this,s=Xs(t)?t:new dr(t,e,n);return Mt(function(){var i=o,a=i.operator,u=i.source;s.add(a?a.call(s,u):u?o._subscribe(s):o._trySubscribe(s))}),s},r.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},r.prototype.forEach=function(t,e){var n=this;return e=qr(e),new e(function(o,s){var i=new dr({next:function(a){try{t(a)}catch(u){s(u),i.unsubscribe()}},error:s,complete:o});n.subscribe(i)})},r.prototype._subscribe=function(t){var e;return(e=this.source)===null||e===void 0?void 0:e.subscribe(t)},r.prototype[Ws]=function(){return this},r.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ys(t)(this)},r.prototype.toPromise=function(t){var e=this;return t=qr(t),new t(function(n,o){var s;e.subscribe(function(i){return s=i},function(i){return o(i)},function(){return n(s)})})},r.create=function(t){return new r(t)},r}();function qr(r){var t;return(t=r!=null?r:cr.Promise)!==null&&t!==void 0?t:Promise}function Qs(r){return r&&ue(r.next)&&ue(r.error)&&ue(r.complete)}function Xs(r){return r&&r instanceof Jr||Qs(r)&&Qr(r)}var Ks=_r(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),wt=function(r){gt(t,r);function t(){var e=r.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return t.prototype.lift=function(e){var n=new en(this,this);return n.operator=e,n},t.prototype._throwIfClosed=function(){if(this.closed)throw new Ks},t.prototype.next=function(e){var n=this;Mt(function(){var o,s;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var i=sr(n.currentObservers),a=i.next();!a.done;a=i.next()){var u=a.value;u.next(e)}}catch(h){o={error:h}}finally{try{a&&!a.done&&(s=i.return)&&s.call(i)}finally{if(o)throw o.error}}}})},t.prototype.error=function(e){var n=this;Mt(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=e;for(var o=n.observers;o.length;)o.shift().error(e)}})},t.prototype.complete=function(){var e=this;Mt(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var n=e.observers;n.length;)n.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(e){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,e)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var n=this,o=this,s=o.hasError,i=o.isStopped,a=o.observers;return s||i?Yr:(this.currentObservers=null,a.push(e),new St(function(){n.currentObservers=null,ar(a,e)}))},t.prototype._checkFinalizedStatuses=function(e){var n=this,o=n.hasError,s=n.thrownError,i=n.isStopped;o?e.error(s):i&&e.complete()},t.prototype.asObservable=function(){var e=new Zr;return e.source=this,e},t.create=function(e,n){return new en(e,n)},t}(Zr),en=function(r){gt(t,r);function t(e,n){var o=r.call(this)||this;return o.destination=e,o.source=n,o}return t.prototype.next=function(e){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.next)===null||o===void 0||o.call(n,e)},t.prototype.error=function(e){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.error)===null||o===void 0||o.call(n,e)},t.prototype.complete=function(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)},t.prototype._subscribe=function(e){var n,o;return(o=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&o!==void 0?o:Yr},t}(wt);const Tt=new WeakMap,Js=function(r,t,e,n,o){const s=Reflect.get(r,t,e);return typeof t!="symbol"&&!n.isIgnore(o)&&(o=be(o,t),n.next({operate:"get",path:o,key:t,value:r[t]})),s},Zs=function(r,t,e,n,o,s){if(typeof t=="symbol"||o.isIgnore(s))return Reflect.set(r,t,e,n);if(s=be(s,t),ze(e)&&!Tt.has(e)&&(e=pr(o,e,s)),r[t]===void 0){qe(e)&&ht(e);const a=Reflect.set(r,t,e);return o.next({operate:"add",path:s,key:t,value:e}),a}const i=Reflect.set(r,t,e);if(qe(r)&&t==="length"){const a=kr(r);if(!a)return console.error("array value is not be cached:",r),i;const u=a.length-e.length;if(u>0){let h=0;for(const p of a)if(!e.includes(p)&&(o.next({operate:"delete",path:s,key:t,value:p}),h+=1,h===u))break}return ht(r),i}return o.next({operate:"set",path:s,key:t,value:e}),i},qs=function(r,t,e,n){if(typeof t=="symbol"||e.isIgnore(n))return Reflect.deleteProperty(r,t);n=be(n,t);const o=r[t],s=Reflect.deleteProperty(r,t);return qe(o)||e.next({operate:"delete",path:n,key:t,value:o}),s},pr=function(r,t,e=""){if(typeof t!="object"||Tt.has(t)||r.isIgnore(e))return t;const n={get:(s,i,a)=>Js(s,i,a,r,e),set:(s,i,a,u)=>Zs(s,i,a,u,r,e),deleteProperty:(s,i)=>qs(s,i,r,e)};if(ze(t))for(const s in t){const i=be(e,s);r.isIgnore(i)||ze(t[s])&&(qe(t[s])&&ht(t[s]),t[s]=pr(r,t[s],i))}const o=new Proxy(t,n);return Tt.set(o,r),o};class ei extends wt{constructor(e,n){super();c(this,"ignore",{});c(this,"raw");this.raw=e,n&&(this.ignore=n)}isIgnore(e){let n=this.ignore;for(const o of e.split(".")){if(n[o]===void 0)return!1;if(typeof n[o]=="boolean"&&n[o])return!0;n=n[o]}return!1}setIgnore(e){this.ignore=e}mergeIgnore(e){this.ignore=Object.assign(this.ignore,e)}}const tn=function(r,t){const e=new ei(r,t);return pr(e,r)},hr=function(r){return Tt.get(r)},ti=function(r,t,e){return Reflect.get(r,t,e)},ri=function(r,t,e,n,o){if(typeof t=="symbol")return Reflect.set(r,t,e,n);if(r[t]===void 0){const s=Reflect.set(r,t,e);return o.add(e),o.next({operate:"add",path:t,key:t,value:e}),s}return Reflect.set(r,t,e,n)},ni=function(r,t,e){if(typeof t=="symbol")return Reflect.deleteProperty(r,t);const n=r[t],o=Reflect.deleteProperty(r,t);return e.next({operate:"delete",path:t,key:t,value:n}),e.remove(n.vid),o},br=class extends wt{constructor(){super();c(this,"container");c(this,"subscriptions",new Map);this.container=new Proxy(br.generator(),{get:ti,set:(e,n,o,s)=>ri(e,n,o,s,this),deleteProperty:(e,n)=>ni(e,n,this)})}add(e){const n=hr(e);if(!n){console.error("DataContainer: this config can not Obasrvable",e);return}this.subscriptions.set(n.raw.vid,n.subscribe(o=>{o.operate!=="get"&&this.next({operate:o.operate,path:be(n.raw.vid,o.path),key:o.key,value:o.value})})),this.container[n.raw.vid]=e}remove(e){this.subscriptions.delete(e)}};let tt=br;c(tt,"generator",()=>({}));class se{constructor(t,e=[]){c(this,"dataContainer",new tt);c(this,"translater");this.translater=new Wr().setRule(t),this.dataContainer.subscribe(n=>{this.translater.translate(n)});for(const n of e)this.dataContainer.add(n)}getData(){return this.dataContainer.container}existSymbol(t){return Boolean(this.dataContainer.container[t])}addConfig(t){return this.dataContainer.container[t.vid]=t,this}getConfig(t){return this.dataContainer.container[t]}removeConfig(t){const e=this.dataContainer.container;e[t]!==void 0&&delete e[t]}addCompiler(t){return t.setTarget(this.dataContainer.container),t.compileAll(),this.translater.apply(t),this}toJSON(t=!0){return t?JSON.stringify(this.exportConfig(),Fe):JSON.stringify(Object.values(this.dataContainer.container),Fe)}exportConfig(t=!0){if(t){const e=this.dataContainer.container,n=[],o={},s=(i,a,u={})=>{for(const h in i){if(["vid","type"].includes(h)){u[h]=i[h];continue}if(typeof i[h]=="object"&&i[h]!==null){if(Array.isArray(i[h])){if(!i[h].length)continue;u[h]=i[h].map(p=>typeof p=="object"&&p!==null?et(p):p);continue}u[h]={},a[h]?(s(i[h],a[h],u[h]),Object.keys(u[h]).length===0&&delete u[h]):u[h]=et(i[h])}else a[h]!==i[h]&&(u[h]=i[h])}};for(const i of Object.values(e)){if(!o[i.type]){if(!F[i.type]){console.error(`can not font some config with: ${i.type}`);continue}o[i.type]=F[i.type]()}const a={};s(i,o[i.type],a),n.push(a)}return n}else return Object.values(et(this.dataContainer.container))}load(t){const e=this.dataContainer.container,n={},o=(s,i)=>{for(const a in i)typeof s[a]=="object"&&s[a]!==null&&typeof i[a]=="object"&&i[a]!==null?o(s[a],i[a]):s[a]===void 0&&(s[a]=i[a])};for(const s of t){if(!n[s.type]){if(!F[s.type]){console.error(`can not font some config with: ${s.type}`);continue}n[s.type]=F[s.type]()}o(s,n[s.type]),e[s.vid]=s}return this}remove(t){const e=this.dataContainer.container;for(const n of t)e[n.vid]!==void 0&&delete e[n.vid];return this}getModule(){return this.MODULE}}const de=(r,t,e=ee.validate)=>{const{operate:n,key:o,path:s,value:i}=r;let a=o;const u=s.split(".");if(s.length&&(a=u.shift(),u.pop()),!e(a)){console.warn(`${t.MODULE} Rule: vid is illeage: ${a}`);return}if(n==="add"&&!u.length){t.add(i);return}if(r.operate==="delete"&&!u.length){t.remove(i);return}if(r.operate==="set"&&!u.length&&o===a){t.cover(i);return}t.compile(a,{operate:n,key:o,path:u,value:i})},oi=function(r,t){de(r,t)};class rn extends se{constructor(e=[]){super(oi,e);c(this,"MODULE",y.TEXTURE)}}const si=function(r,t){de(r,t)};class nn extends se{constructor(e=[]){super(si,e);c(this,"MODULE",y.MATERIAL)}}class ke extends se{constructor(e,n=[]){super(e,n);c(this,"MODULE",y.GROUP)}}const pe=function(r,t){r.key!=="parent"&&de(r,t)},ii=function(r,t){pe(r,t)};class on extends ke{constructor(e=[]){super(ii,e);c(this,"MODULE",y.LIGHT)}}const ai=function(r,t){de(r,t)};class sn extends se{constructor(e=[]){super(ai,e);c(this,"MODULE",y.GEOMETRY)}}const ci=function(r,t){pe(r,t)};class an extends ke{constructor(e=[]){super(ci,e);c(this,"MODULE",y.CAMERA)}}const li=function(r,t){de(r,t,e=>ee.validate(e)||[N(d.WEBGLRENDERER),N(d.CSS3DRENDERER)].includes(e))};class cn extends se{constructor(e=[]){super(li,e);c(this,"MODULE",y.RENDERER)}}const ui=function(r,t){de(r,t,e=>ee.validate(e)||[N(d.SCENE)].includes(e))};class ln extends ke{constructor(e=[]){super(ui,e);c(this,"MODULE",y.SCENE)}}const di=function(r,t){de(r,t,e=>ee.validate(e)||[N(d.TRNASFORMCONTROLS),N(d.ORBITCONTROLS)].includes(e))};class un extends se{constructor(e=[]){super(di,e);c(this,"MODULE",y.CONTROLS)}}class Ct extends se{constructor(e,n=[]){super(e,n);c(this,"MODULE",y.MESH)}}const pi=function(r,t){r.key!=="geometry"&&pe(r,t)};class dn extends Ct{constructor(e=[]){super(pi,e);c(this,"MODULE",y.SPRITE)}}const hi=function(r,t){pe(r,t)};class pn extends Ct{constructor(e=[]){super(hi,e);c(this,"MODULE",y.LINE)}}const fi=function(r,t){pe(r,t)};class hn extends Ct{constructor(e=[]){super(fi,e);c(this,"MODULE",y.MESH)}}const mi=function(r,t){pe(r,t)};class fn extends Ct{constructor(e=[]){super(mi,e);c(this,"MODULE",y.POINTS)}}const gi=function(r,t){pe(r,t)};class mn extends ke{constructor(e=[]){super(gi,e);c(this,"MODULE",y.GROUP)}}const yi=function(r,t){de(r,t)};class gn extends se{constructor(e=[]){super(yi,e);c(this,"MODULE",y.PASS)}}const Ei=function(r,t){r.key==="name"&&r.path.length===1||de(r,t)};class yn extends se{constructor(e=[]){super(Ei,e);c(this,"MODULE",y.ANIMATION)}}const Si=function(r,t){pe(r,t)};class En extends ke{constructor(e=[]){super(Si,e);c(this,"MODULE",y.CSS3D)}}const bi=function(r,t){pe(r,t)};class Sn extends ke{constructor(e=[]){super(bi,e);c(this,"MODULE",y.OBJECT3D)}}class bn{constructor(t){c(this,"object3DDataSupport",new Sn);c(this,"cameraDataSupport",new an);c(this,"lightDataSupport",new on);c(this,"geometryDataSupport",new sn);c(this,"textureDataSupport",new rn);c(this,"materialDataSupport",new nn);c(this,"rendererDataSupport",new cn);c(this,"sceneDataSupport",new ln);c(this,"controlsDataSupport",new un);c(this,"spriteDataSupport",new dn);c(this,"lineDataSupport",new pn);c(this,"meshDataSupport",new hn);c(this,"pointsDataSupport",new fn);c(this,"groupDataSupport",new mn);c(this,"css3DDataSupport",new En);c(this,"passDataSupport",new gn);c(this,"animationDataSupport",new yn);c(this,"dataSupportMap");t&&Object.keys(t).forEach(n=>{this[n]!==void 0&&(this[n]=t[n])});const e=new Map;Object.keys(this).forEach(n=>{const o=this[n];o instanceof se&&e.set(o.MODULE,o)}),this.dataSupportMap=e}getDataSupport(t){return this.dataSupportMap.has(t)?this.dataSupportMap.get(t):(console.warn(`can not found this type in dataSupportManager: ${t}`),null)}getSupportData(t){return this.dataSupportMap.has(t)?this.dataSupportMap.get(t).getData():(console.warn(`can not found this type in dataSupportManager: ${t}`),null)}getConfigBySymbol(t){const e=this.dataSupportMap.values();for(const n of e){const o=n.getConfig(t);if(o)return o}return null}removeConfigBySymbol(...t){const e=this.dataSupportMap.values();for(const n of t)for(const o of e)if(o.existSymbol(n)){o.removeConfig(n);break}return this}getModuleBySymbol(t){const e=this.dataSupportMap.values();for(const n of e)if(n.existSymbol(t))return n.MODULE;return null}applyConfig(...t){for(const e of t){const n=Ne(e.type);n?this.dataSupportMap.get(n).addConfig(e):console.warn(`dataSupportManager can not found this config module: ${e.type}`)}return this}load(t){return this.dataSupportMap.forEach((n,o)=>{t[o]&&n.load(t[o])}),this}remove(t){return this.dataSupportMap.forEach((n,o)=>{t[o]&&n.remove(t[o])}),this}toJSON(t={},e=!0){return JSON.stringify(this.exportConfig(t,e),Fe)}exportConfig(t={},e=!0){return this.dataSupportMap.forEach((o,s)=>{t[s]=o.exportConfig(e)}),t}}const Mi=function(r){if(this.dataSupportManager)return console.warn("engine has installed dataSupportManager plugin."),!1;const t=new bn(r);return this.dataSupportManager=t,this.applyConfig=function(...e){return this.dataSupportManager.applyConfig(...e),this},this.getConfigBySymbol=function(e){return this.dataSupportManager.getConfigBySymbol(e)},this.removeConfigBySymbol=function(...e){return this.dataSupportManager.removeConfigBySymbol(...e),this},this.toJSON=function(){if(this.loaderManager){const e={assets:JSON.parse(this.loaderManager.toJSON())};return this.dataSupportManager.toJSON(e)}return this.dataSupportManager.toJSON()},this.exportConfig=function(){let e={};return this.loaderManager&&(e={assets:this.loaderManager.exportConfig()}),this.dataSupportManager.exportConfig(e)},!0},oe=class{constructor(){c(this,"target",{});c(this,"map",new Map);c(this,"weakMap",new WeakMap);c(this,"engine");c(this,"cacheCompile")}getMap(){return this.map}useEngine(t){return this.engine=t,this}setTarget(t){return this.target=t,this}add(t){if(!oe.processors.has(t.type))return console.warn(`${this.MODULE} compiler can not support this type: ${t.type}`),null;const n=oe.processors.get(t.type).create(t,this.engine);return this.map.set(t.vid,n),this.weakMap.set(n,t.vid),this.engine.compilerManager.emit(t.vid,{}),n}remove(t){const e=t.vid;if(!this.map.has(e))return console.warn(`${this.MODULE} compiler can not found this vid object: ${e}.`),this;if(!oe.processors.has(t.type))return console.warn(`${this.MODULE} compiler can not support this type: ${t.type}`),this;const n=this.map.get(e);return oe.processors.get(t.type).dispose(n),this.map.delete(e),this.weakMap.delete(n),this}cover(t){const e=t.vid;return this.map.has(e)?(Promise.resolve().then(()=>{W(t,t,{vid:!0,type:!0})}),this):(console.warn(`${this.MODULE} compiler can not found this vid object: ${e}.`),this)}compile(t,e){const n=this.cacheCompile;let o,s,i;if(n&&n.vid===t)o=n.target,s=n.config,i=n.processor;else{if(!this.map.has(t))return console.warn(`${this.MODULE} compiler set function: can not found object which vid is: '${t}'`),this;if(!this.target[t])return console.warn(`${this.MODULE} compiler set function: can not found config which vid is: '${t}'`),this;if(o=this.map.get(t),s=this.target[t],!oe.processors.has(s.type))return console.warn(`PassCompiler can not support this type: ${s.type}`),this;i=oe.processors.get(s.type),this.cacheCompile={target:o,config:s,processor:i,vid:t}}return i.process({config:s,target:o,engine:this.engine,processor:i,compiler:this,...e}),this}compileAll(){const t=this.target;for(const e of Object.values(t))this.add(e);return this}dispose(){this.cacheCompile&&(this.cacheCompile=void 0);for(const t of Object.values(this.target)){if(!this.map.has(t.vid)){console.warn(`${this.MODULE} compiler set function: can not found object which vid is: '${t.vid}'`);continue}const e=this.map.get(t.vid);if(!oe.processors.has(t.type)){console.warn(`${this.MODULE}  can not support this type: ${t.type}`);continue}oe.processors.get(t.type).dispose(e)}return this.map.clear(),this.target={},this}getObjectSymbol(t){return this.weakMap.get(t)||null}getObjectBySymbol(t){return this.map.get(t)||null}};let M=oe;c(M,"processors",new Map),c(M,"processor",function(t){oe.processors.set(t.configType,t)});const Ie="vis.scriptAni";class vi{constructor(t){c(this,"configType");c(this,"commands");c(this,"create");c(this,"dispose");this.configType=t.configType,this.commands=t.commands,this.create=t.create,this.dispose=t.dispose}process(t){if(!this.commands||!this.commands[t.operate]){this[t.operate](t);return}let e=this.commands[t.operate];for(const n of[].concat(t.path,t.key))if(!e[n]&&!e.$reg){this[t.operate](t);return}else if(e[n])if(typeof e[n]=="function"){e[n](t);return}else e=e[n];else if(e.$reg){for(const o of e.$reg)if(o.reg.test(n)){o.handler(t);return}}this[t.operate](t)}add(t){let e=t.target;const n=t.path;for(const o of n)if(typeof e[o]!==void 0)e=e[o];else{console.warn("processor can not exec default add operate.",t);return}e[t.key]=t.value}set(t){let e=t.target;const n=t.path;for(const o of n)if(typeof e[o]!==void 0)e=e[o];else{console.warn("processor can not exec default set operate.",t);return}e[t.key]=t.value}delete(t){let e=t.target;const n=t.path;for(const o of n)if(typeof e[o]!==void 0)e=e[o];else{console.warn("processor can not exec default delete operate.",t);return}delete e[t.key]}}const L=r=>new vi(r),Rt=function(){},wi={name:"linearTime",multiply:1},Ti=function(r,t,e,n){return t[e]===void 0?(console.warn(`object not exist attribute: ${e}`,t),o=>{}):typeof t[e]!="number"?(console.warn("object attribute is not typeof number.",t,e),o=>{}):o=>{t[e]+=o.delta*n.multiply}},Ci={name:"sinWave",wavelength:1,offset:0,amplitude:1,speed:1},Ri=function(r,t,e,n){if(t[e]===void 0)return console.warn(`object not exist attribute: ${e}`,t),s=>{};if(typeof t[e]!="number")return console.warn("object attribute is not typeof number.",t,e),s=>{};const o=t[e];return s=>{t[e]=o+n.amplitude*Math.sin(s.total*n.speed/n.wavelength)+n.offset}},ie=class{static generateConfig(t,e){if(!ie.configLibrary.has(t))return console.warn(`event library can not found config by name: ${t}`),{name:""};const n=(s,i)=>{for(const a in i)s[a]!==void 0&&(typeof i[a]=="object"&&i[a]!==null&&!Array.isArray(i[a])?n(s[a],i[a]):s[a]=i[a])},o=JSON.parse(JSON.stringify(ie.configLibrary.get(t)));return n(o,e),o}static generateScript(t,e,n,o){return ie.generatorLibrary.has(o.name)?ie.generatorLibrary.get(o.name)(t,e,n,o):(console.error(`event library can not found generator by name: ${o.name}`),()=>{})}static has(t){return ie.configLibrary.has(t)}};let he=ie;c(he,"configLibrary",new Map),c(he,"generatorLibrary",new Map),c(he,"register",function(t,e){ie.configLibrary.has(t.name)&&console.warn(`EventLibrary has already exist this event generator: ${t.name}, that will be cover.`),ie.configLibrary.set(t.name,JSON.parse(JSON.stringify(t))),ie.generatorLibrary.set(t.name,e)}),he.register(wi,Ti),he.register(Ci,Ri);const Mn=function(r,t){let e=t.compilerManager.getObjectBySymbol(r.target);if(!e)return console.warn(`can not found object in enigne: ${r.target}`),()=>{};const n=r.attribute.split(".");n.shift();const o=n.pop();for(const s of n){if(e[s]===void 0)return console.warn(`animaton processor: target object can not found key: ${s}`,e),()=>{};e=e[s]}return he.generateScript(t,e,o,r.script)};var xi=L({configType:d.SCRIPTANIMATION,commands:{set:{play({target:r,engine:t,value:e}){e?t.renderManager.addEventListener("render",r):t.renderManager.removeEventListener("render",r)},$reg:[{reg:new RegExp(".*"),handler({config:r,engine:t}){const e=r[Symbol.for(Ie)];t.renderManager.removeEventListener("render",e);const n=Mn(r,t);r[Symbol.for(Ie)]=n,r.play&&t.renderManager.addEventListener("render",e)}}]}},create(r,t){const e=Mn(r,t);return r.play&&t.renderManager.addEventListener("render",e),r[Symbol.for(Ie)]=e,e},dispose(){}});class Oi extends M{constructor(){super();c(this,"MODULE",y.ANIMATION)}restoreAttribute(e){if(!e.target||!e.attribute)return this;let n=this.engine.getObjectBySymbol(e.target),o=this.engine.getConfigBySymbol(e.target);(!n||!o)&&console.warn("AnimationCompiler: can not found object target or config in engine",e.vid);const s=e.attribute.split(".");s.shift();const i=s.pop();for(const a of s)if(n[a]&&o[a])n=n[a],o=o[a];else return console.warn("AnimationCompiler: object and config attribute are not sync"),this;return n[i]=o[i],this}cover(e){super.cover(e);const n=this.map.get(e.vid);return e[Symbol.for(Ie)]=n,this}remove(e){return this.engine.removeEventListener("render",e[Symbol.for(Ie)]),this.restoreAttribute(e),delete e[Symbol.for(Ie)],super.remove(e),this}compile(e,n){const o=this.target[e];this.restoreAttribute(o),super.compile(e,n);const s=this.map.get(e),i=o[Symbol.for(Ie)];return this.map.set(o.vid,i),this.weakMap.delete(s),this.weakMap.set(i,e),this}}M.processor(xi);class Me extends M{constructor(){super()}}const Li={name:"openWindow",params:{url:""}},Ai=function(r,t){return()=>{window.open(t.params.url)}},Di={name:"visibleObject",params:{target:"",visible:!0,delay:0}},Pi=function(r,t){const e=t.params,n=r.getObjectBySymbol(e.target);return n?()=>{setTimeout(()=>{n.visible=e.visible},e.delay)}:(console.warn(`basic event visibleObject: can not found vid object: ${e.target}`),()=>{})},ji={name:"addClass",params:{target:"",className:"",delay:0}},Ii=function(r,t){const e=t.params,n=[];if(e.target==="all")r.scene.traverse(o=>{o instanceof Ee.CSS3DObject&&n.push(o)});else if(Array.isArray(e.target))e.target.forEach(o=>{const s=r.getObjectBySymbol(o);s?n.push(s):console.warn(`basic event AddClass: can not found vid object: ${e.target}`)});else{const o=r.getObjectBySymbol(e.target);if(!o)return console.warn(`basic event AddClass: can not found vid object: ${e.target}`),()=>{};if(!(o instanceof Ee.CSS3DObject))return console.warn("basic event AddClass: object is not a CSS3DObject."),()=>{};n.push(o)}return n.length?()=>{setTimeout(()=>{n.forEach(o=>{o.element.classList.add(e.className)})},e.delay)}:(console.warn(`basic event AddClass: can not found vid object: ${e.target}`),()=>{})},Gi={name:"changeScene",params:{scene:"Scene",delay:0}},Bi=function(r,t){const e=t.params;return()=>{setTimeout(()=>{r.setScene(e.scene)},e.delay)}},Ui={name:"changeCamera",params:{camera:"",delay:0}},Hi=function(r,t){const e=t.params;return()=>{setTimeout(()=>{r.setCamera(e.camera)},e.delay)}},Ni={name:"switchAnimate",params:{target:"",toggle:"auto",delay:0}},zi=function(r,t){const e=t.params,n=r.getConfigBySymbol(e.target);return n?()=>{setTimeout(()=>{if(e.toggle==="auto"){n.play!=n.play;return}if(e.toggle==="off"){n.play=!1;return}if(e.toggle==="on"){n.play=!0;return}},e.delay)}:(console.warn(`basic event switchAnimate: can not found vid config: ${e.target}`),()=>{})};var Q=(r=>(r.ELN="ELN",r.EQI="EQI",r.EQO="EQO",r.EASING_LINEAR_NONE="EASING_LINEAR_NONE",r.EASING_QUARTIC_IN="EASING_QUARTIC_IN",r.EASING_QUARTIC_OUT="EASING_QUARTIC_OUT",r.EASING_QUARTIC_INOUT="EASING_QUARTIC_INOUT",r.EASING_QUADRATIC_IN="EASING_QUADRATIC_IN",r.EASING_QUADRATIC_OUT="EASING_QUADRATIC_OUT",r.EASING_QUADRATIC_INOUT="EASING_QUADRATIC_INOUT",r))(Q||{});const H={ELN:I.Easing.Linear.None,EQI:I.Easing.Quartic.In,EQO:I.Easing.Quartic.Out,EASING_LINEAR_NONE:I.Easing.Linear.None,EASING_QUARTIC_IN:I.Easing.Quartic.In,EASING_QUARTIC_OUT:I.Easing.Quartic.Out,EASING_QUARTIC_INOUT:I.Easing.Quartic.InOut,EASING_QUADRATIC_IN:I.Easing.Quadratic.In,EASING_QUADRATIC_OUT:I.Easing.Quadratic.Out,EASING_QUADRATIC_INOUT:I.Easing.Quadratic.InOut},Fi={name:"moveTo",params:{target:"",position:{x:0,y:0,z:0},delay:0,duration:1e3,timingFunction:Q.EASING_QUADRATIC_INOUT}},ki=function(r,t){const e=t.params,o=r.compilerManager.getObjectBySymbol(e.target);if(!o)return console.warn(`real time animation moveTO: can not found vid object: ${e.target}`),()=>{};const s=r.renderManager,i=r.dataSupportManager.getConfigBySymbol(e.target);if(!i)return console.warn(`can not found object config: ${e.target}`),()=>{};let a=!1;return()=>{if(a)return;a=!0;const u=new I.Tween(o.position).to(e.position).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),h=p=>{u.update()};s.addEventListener("render",h),u.onComplete(()=>{s.removeEventListener("render",h),i.position.x=e.position.x,i.position.y=e.position.y,i.position.z=e.position.z,a=!1})}},$i={name:"rotationTo",params:{target:"",rotation:{x:0,y:0,z:0},delay:0,duration:1e3,timingFunction:Q.EASING_QUADRATIC_INOUT}},Vi=function(r,t){const e=t.params,o=r.compilerManager.getObjectBySymbol(e.target);if(!o)return console.warn(`real time animation moveTO: can not found vid object: ${e.target}`),()=>{};const s=r.renderManager,i=r.dataSupportManager.getConfigBySymbol(e.target);if(!i)return console.warn(`can not found object config: ${e.target}`),()=>{};let a=!1;return()=>{if(a)return;a=!0;const u=new I.Tween(o.rotation).to(e.rotation).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),h=p=>{u.update()};s.addEventListener("render",h),u.onComplete(()=>{s.removeEventListener("render",h),i.rotation.x=e.rotation.x,i.rotation.y=e.rotation.y,i.rotation.z=e.rotation.z,a=!1})}},Wi={name:"upTo",params:{target:"",up:{x:0,y:1,z:0},delay:0,duration:1e3,timingFunction:Q.EASING_QUADRATIC_INOUT}},_i=function(r,t){const e=t.params,o=r.compilerManager.getObjectBySymbol(e.target);if(!o)return console.warn(`real time animation upTo: can not found vid object: ${e.target}`),()=>{};const s=r.renderManager,i=r.dataSupportManager.getConfigBySymbol(e.target);if(!i)return console.warn(`can not found object config: ${e.target}`),()=>{};let a=!1;return()=>{if(a)return;a=!0;const u=new I.Tween(o.up).to(e.up).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),h=p=>{u.update()};s.addEventListener("render",h),u.onComplete(()=>{s.removeEventListener("render",h),i.up.x=e.up.x,i.up.y=e.up.y,i.up.z=e.up.z,a=!1})}},Yi={name:"moveFromTo",params:{target:"",from:{x:0,y:0,z:0},to:{x:10,y:10,z:10},delay:0,duration:1e3,timingFunction:Q.EASING_QUADRATIC_INOUT}},Qi=function(r,t){const e=t.params,o=r.compilerManager.getObjectBySymbol(e.target);if(!o)return console.warn(`real time animation moveTO: can not found vid object: ${e.target}`),()=>{};const s=r.renderManager,i=r.dataSupportManager.getConfigBySymbol(e.target);if(!i)return console.warn(`can not found object config: ${e.target}`),()=>{};let a=!1;return()=>{if(a)return;a=!0,o.position.set(e.from.x,e.from.y,e.from.z),o.updateMatrix(),o.updateMatrixWorld();const u=new I.Tween(o.position).to(e.to).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),h=p=>{u.update()};s.addEventListener("render",h),u.onComplete(()=>{s.removeEventListener("render",h),i.position.x=e.to.x,i.position.y=e.to.y,i.position.z=e.to.z,a=!1})}},Xi={name:"moveSpacing",params:{target:"",spacing:{x:10,y:10,z:10},delay:0,duration:1e3,timingFunction:Q.EASING_QUADRATIC_INOUT}},Ki=function(r,t){const e=t.params,n=r.getObjectBySymbol(e.target);if(!n)return console.warn(`can not found vid object: ${e.target}`),()=>{};if(!(n instanceof l.Object3D))return console.warn(`object is not instanceof Object3D: ${e.target}`),()=>{};const o=r.renderManager,s=r.getConfigBySymbol(e.target);let i=!1;return()=>{if(i)return;i=!0;const a={x:n.position.x+e.spacing.x,y:n.position.y+e.spacing.y,z:n.position.z+e.spacing.z},u=new I.Tween(n.position).to(a).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),h=p=>{u.update()};o.addEventListener("render",h),u.onComplete(()=>{o.removeEventListener("render",h),s.position.x=a.x,s.position.y=a.y,s.position.z=a.z,i=!1})}},Ji={name:"moveToObject",params:{target:"",to:"",offset:{x:0,y:0,z:0},delay:0,duration:1e3,timingFunction:Q.EASING_QUADRATIC_INOUT}},Zi=function(r,t){const e=t.params,n=r.compilerManager,o=n.getObjectBySymbol(e.target),s=n.getObjectBySymbol(e.to);if(!o)return console.warn(`real time animation MoveToObject: can not found vid object: ${e.target}`),()=>{};if(!s)return console.warn(`real time animation MoveToObject: can not found vid object: ${e.target}`),()=>{};const i=r.renderManager,a=r.dataSupportManager.getConfigBySymbol(e.target);if(!a)return console.warn(`can not found object config: ${e.target}`),()=>{};let u=!1;return()=>{if(u)return;u=!0;const h={x:s.position.x+e.offset.x,y:s.position.y+e.offset.y,z:s.position.z+e.offset.z},p=new I.Tween(o.position).to(h).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),m=T=>{p.update()};i.addEventListener("render",m),p.onComplete(()=>{i.removeEventListener("render",m),a.position.x=h.x,a.position.y=h.y,a.position.z=h.z,u=!1})}},qi={name:"vector3To",params:{target:"",attribute:".position",props:{x:"x",y:"y",z:"z"},delay:0,duration:500,to:{},timingFunction:Q.EASING_QUADRATIC_INOUT}},ea=function(r,t){var m,T,b;const e=t.params,n=r.compilerManager.getObjectBySymbol(e.target);if(!n)return console.warn(`real time animation vector3To: can not found vid object: ${e.target}`),()=>{};const o=r.renderManager;let s=r.dataSupportManager.getConfigBySymbol(e.target);if(!s)return console.warn(`real time animation vector3To: can not found object config: ${e.target}`),()=>{};const i=e.attribute.split(".");i.shift();let a=n;for(const v of i){if(a[v]===void 0)return console.error(`real time animation vector3To: object can not support key: ${v}`,n),()=>{};a=a[v],s=s[v]}const u=e.props;if(!(u.x in a)||!(u.y in a)||!(u.z in a))return console.error("real time animation vector3To: object can not support props:",a,u),()=>{};if(!(u.x in s)||!(u.y in s)||!(u.z in s))return console.error("real time animation vector3To: config can not support props:",s,u),()=>{};const h={x:(m=e.to.x)!=null?m:a[u.x],y:(T=e.to.y)!=null?T:a[u.y],z:(b=e.to.z)!=null?b:a[u.z]};let p=!1;return()=>{if(p)return;p=!0;const v=new I.Tween(a).to(h).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),S=R=>{v.update()};o.addEventListener("render",S),v.onComplete(()=>{o.removeEventListener("render",S),s[u.x]=h.x,s[u.y]=h.y,s[u.z]=h.z,p=!1})}},ta={name:"focusObject",params:{target:"",camera:"",space:"world",offset:{x:0,y:0,z:20},delay:0,duration:1e3,timingFunction:Q.EASING_QUADRATIC_INOUT,back:!0}},ra=function(r,t){const e=t.params,n=r.getObjectBySymbol(e.target),o=r.orbitControls.target;if(!n)return console.warn(`real time animation focusObject: can not found vid object: ${e.target}`),()=>{};if(!(n instanceof l.Object3D))return console.warn(`real time animation focusObject: vid object is not a class of THREE.Object3D: ${e.target}`),()=>{};let s=!1;const i=new l.Euler;return()=>{if(s)return;s=!0;let a=r.camera;e.camera&&(a=r.getObjectBySymbol(e.camera),a||(a=r.camera,console.warn(`real time animation focusObject: can not found camera config: ${e.camera}`)));const u=r.getObjectConfig(a),h=r.orbitControls&&r.orbitControls.object===a;u||console.warn("engine current camera can not found config.");const p=r.renderManager;let m={x:n.matrixWorld.elements[12]+e.offset.x,y:n.matrixWorld.elements[13]+e.offset.y,z:n.matrixWorld.elements[14]+e.offset.z};const T={x:a.position.x,y:a.position.y,z:a.position.z};if(e.space==="local"){const j=new l.Vector3(e.offset.x,e.offset.y,e.offset.z).applyEuler(i.setFromRotationMatrix(n.matrixWorld));m={x:n.matrixWorld.elements[12]+j.x,y:n.matrixWorld.elements[13]+j.y,z:n.matrixWorld.elements[14]+j.z}}const b=new I.Tween(a.position).to(m).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start();let v;const S={x:a.up.x,y:a.up.y,z:a.up.z};if(e.space==="local"){const j=new l.Vector3(0,1,0).applyEuler(i.setFromRotationMatrix(n.matrixWorld));v=new I.Tween(a.up).to({x:j.x,y:j.y,z:j.z}).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start()}let R;const w={x:o.x,y:o.y,z:o.z};h&&(R=new I.Tween(o).to({x:n.matrixWorld.elements[12],y:n.matrixWorld.elements[13],z:n.matrixWorld.elements[14]}).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start());let D;h&&e.space==="local"?D=j=>{b.update(),v.update(),R.update()}:h?D=j=>{b.update(),R.update()}:e.space==="local"?D=j=>{b.update(),v.update()}:D=j=>{b.update()},p.addEventListener("render",D),b.onComplete(()=>{if(p.removeEventListener("render",D),u&&(u.position.x=m.x,u.position.y=m.y,u.position.z=m.z),s=!1,e.back){const j=()=>{const $=new I.Tween(a.position).to(T).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start();let O;e.space==="local"&&(O=new I.Tween(a.up).to(S).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start());let E;h&&(E=new I.Tween(o).to(w).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start());const q=P=>{$.update(),O&&O.update(),E&&E.update()};$.onComplete(()=>{p.removeEventListener("render",q)}),p.addEventListener("render",q),document.removeEventListener("dblclick",j)};document.addEventListener("dblclick",j)}})}},na={name:"fadeObject",params:{target:"",direction:"out",delay:0,duration:300,timingFunction:Q.EASING_QUADRATIC_INOUT,visible:!0}},oa=function(r,t){const e=t.params,n=r.getObjectBySymbol(e.target);if(!n)return console.warn(`real time animation fadeObject: can not found vid object: ${e.target}`),()=>{};const o=r.getObjectConfig(n);if(!o.material)return console.warn(`real time animation fadeObject: target can not support fade: ${e.target}`),()=>{};const s=[],i=[],a=Array.isArray(o.material)?[].concat(o.material):[o.material];for(const h of a){const p=r.getObjectBySymbol(h),m=r.getConfigBySymbol(h);if(!(p instanceof l.Material)){console.error(`real time animation fadeObject: object config material is not instanceof Material: ${h}`);continue}if(!m){console.error(`real time animation fadeObject: object config material can not found config: ${h}`);continue}s.push(p),i.push(m)}let u=!1;return()=>{if(u)return;u=!0;const h=r.renderManager;o.visible=!0,s.forEach((p,m,T)=>{p.visible=!0,p.transparent=!0,p.opacity=e.direction==="in"?0:1,p.needsUpdate=!0;const b=new I.Tween(p).to({opacity:e.direction==="in"?1:0}).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),v=S=>{b.update()};h.addEventListener("render",v),b.onComplete(()=>{h.removeEventListener("render",v),e.direction==="out"&&e.visible?(i[m].visible=!1,o.visible=!1):e.direction==="in"&&e.visible&&(i[m].visible=!0,o.visible=!0),i[m].opacity=e.direction==="in"?1:0,u=!1})})}},sa={name:"showToCamera",params:{target:"",offset:{x:0,y:0,z:-30},delay:0,duration:1e3,timingFunction:Q.EASING_QUADRATIC_INOUT,back:!0}},ia=function(r,t){const e=t.params,n=r.getObjectBySymbol(e.target),o=r.getConfigBySymbol(e.target),s=r.camera;if(!n)return console.warn(`real time animation showToCamera: can not found vid object: ${e.target}`),()=>{};if(!n)return console.warn(`real time animation showToCamera: can not found vid config: ${e.target}`),()=>{};if(!(n instanceof l.Object3D))return console.warn(`real time animation showToCamera: vid object is not a class of THREE.Object3D: ${e.target}`),()=>{};const i=new l.Matrix4,a=new l.Euler,u=new l.Vector3;let h=!1;return()=>{if(h)return;h=!0;const p=r.renderManager;u.set(e.offset.x,e.offset.y,e.offset.z).applyEuler(s.rotation),u.set(s.position.x+u.x,s.position.y+u.y,s.position.z+u.z),i.lookAt(s.position,u,s.up),a.setFromRotationMatrix(i);const m={x:n.position.x,y:n.position.y,z:n.position.z},T={x:n.rotation.x,y:n.rotation.y,z:n.rotation.z},b=new I.Tween(n.position).to({x:u.x,y:u.y,z:u.z}).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),v=new I.Tween(n.rotation).to({x:a.x,y:a.y,z:a.z}).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),S=R=>{b.update(),v.update()};p.addEventListener("render",S),b.onComplete(()=>{if(p.removeEventListener("render",S),o.position.x=u.x,o.position.y=u.y,o.position.z=u.z,o.rotation.x=a.x,o.rotation.y=a.y,o.rotation.z=a.z,h=!1,e.back){const R=()=>{const w=new I.Tween(n.position).to(m).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),D=new I.Tween(n.rotation).to(T).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),j=$=>{w.update(),D.update()};w.onComplete(()=>{p.removeEventListener("render",j),o.position.x=m.x,o.position.y=m.y,o.position.z=m.z,o.rotation.x=T.x,o.rotation.y=T.y,o.rotation.z=T.z}),p.addEventListener("render",j),document.removeEventListener("dblclick",R)};document.addEventListener("dblclick",R)}})}},aa={name:"colorChange",params:{target:"",attribute:"color",color:"rgb(255, 255, 255)",delay:0,duration:500,timingFunction:Q.EASING_QUADRATIC_INOUT}},ca=function(r,t){const e=t.params,n=r.getObjectBySymbol(e.target);if(!n)return console.warn(`real time animation ColorChange: can not found vid material: ${e.target}`),()=>{};if(!n[e.attribute]||!(n[e.attribute]instanceof l.Color))return console.warn(`real time animation ColorChange: material attribute is illeage: ${e.attribute}`),()=>{};const o=r.getConfigBySymbol(e.target);if(!o)return console.warn(`real time animation ColorChange: can not found material config: ${e.target}`),()=>{};const s=new l.Color(e.color),i=r.renderManager;let a=!1;return()=>{if(a)return;a=!0;const u=new I.Tween(n[e.attribute]).to({r:s.r,g:s.g,b:s.b}).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),h=p=>{u.update()};i.addEventListener("render",h),u.onComplete(()=>{i.removeEventListener("render",h),o[e.attribute]=e.color,a=!1})}},la={name:"orbitTargetMove",params:{target:"",offset:{x:0,y:0,z:0},delay:0,duration:1e3,timingFunction:Q.EASING_QUADRATIC_INOUT}},ua=function(r,t){const e=t.params;if(r.compilerManager,!r.orbitControls)return console.warn("real time animation orbitTargetMove: engine can not install orbitControls."),()=>{};const n=r.renderManager;let o=!1;return()=>{if(o)return;o=!0;let s=e.offset;if(e.target){const u=r.getObjectBySymbol(e.target);u?s={x:u.matrixWorld.elements[12]+s.x,y:u.matrixWorld.elements[13]+s.y,z:u.matrixWorld.elements[14]+s.z}:console.warn(`real time animation orbitTargetMove: can not found vid object: ${e.target}`)}const i=new I.Tween(r.orbitControls.target).to(s).duration(e.duration).delay(e.delay).easing(H[e.timingFunction]).start(),a=u=>{i.update()};n.addEventListener("render",a),i.onComplete(()=>{n.removeEventListener("render",a),o=!1})}},ae=class{static generateConfig(t,e){if(!ae.configLibrary.has(t))return console.warn(`event library can not found config by name: ${t}`),{name:""};const n=(s,i)=>{for(const a in i)typeof i[a]=="object"&&i[a]!==null&&!Array.isArray(i[a])?n(s[a],i[a]):s[a]=i[a]},o=JSON.parse(JSON.stringify(ae.configLibrary.get(t)));return n(o,e),o}static generateEvent(t,e){return ae.generatorLibrary.has(t.name)?ae.generatorLibrary.get(t.name)(e,t):(console.error(`event library can not found generator by name: ${t.name}`),()=>{})}static has(t){return ae.configLibrary.has(t)}};let B=ae;c(B,"configLibrary",new Map),c(B,"generatorLibrary",new Map),c(B,"register",function(t,e){ae.configLibrary.has(t.name)&&console.warn(`EventLibrary has already exist this event generator: ${t.name}, that will be cover.`),ae.configLibrary.set(t.name,JSON.parse(JSON.stringify(t))),ae.generatorLibrary.set(t.name,e)}),B.register(Li,Ai),B.register(Di,Pi),B.register(ji,Ii),B.register(Gi,Bi),B.register(Ui,Hi),B.register(Ni,zi),B.register(Fi,ki),B.register($i,Vi),B.register(Wi,_i),B.register(Yi,Qi),B.register(Xi,Ki),B.register(Ji,Zi),B.register(qi,ea),B.register(ta,ra),B.register(na,oa),B.register(sa,ia),B.register(aa,ca),B.register(la,ua);class da{constructor(){c(this,"list",[]);c(this,"timer");c(this,"time",0)}exec(t){t(!1)||(this.list.includes(t)||this.list.push(t),this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{for(const e of this.list)e(!0);this.list=[]},this.time))}append(t){this.list.length&&!this.list.includes(t)?this.list.push(t):this.exec(t)}}const Ge=new da,vn=new WeakMap,wn=function({target:r,config:t,value:e,engine:n}){if(t.vid===e){console.warn("can not set object lookAt itself.");return}let o=vn.get(r);if(o||(o={lookAtTarget:null,updateMatrixWorldFun:null},vn.set(r,o)),!e){if(!o.updateMatrixWorldFun)return;r.updateMatrixWorld=o.updateMatrixWorldFun,o.lookAtTarget=null,o.updateMatrixWorldFun=null;return}Ge.exec(s=>{const i=n.compilerManager.getObject3D(e);if(!i)return s&&console.warn(`lookAt handler can not found this vid mapping object: '${e}'`),!1;const a=r.updateMatrixWorld;return o.updateMatrixWorldFun=a,o.lookAtTarget=i.position,r.updateMatrixWorld=u=>{a.call(r,u),r.lookAt(o.lookAtTarget)},!0})},rt="vis.event",fe=function({target:r,path:t,value:e,engine:n}){const o=t[0];if(!B.has(e.name)){console.warn(`EventLibrary: can not support this event: ${e.name}`);return}const s=B.generateEvent(e,n),i=Symbol.for(rt);e[i]=s,r.addEventListener(o,s)},ve=function({target:r,path:t,value:e}){const n=t[0],o=e[Symbol.for(rt)];if(!o){console.warn("event remove can not fun found event in config",e);return}r.removeEventListener(n,o),delete e[Symbol.for(rt)]},we=function({target:r,config:t,path:e,engine:n}){const o=e[0],s=t[e[0]][e[1]],i=s[Symbol.for(rt)];if(!i){console.warn("event remove can not fun found event in config",s);return}r.removeEventListener(o,i);const a=B.generateEvent(s,n);s[Symbol.for(rt)]=a,r.addEventListener(o,a)},fr=function({target:r,config:t,value:e,engine:n}){Ge.exec(o=>{const s=n.getConfigBySymbol(e);if(!s)return o&&console.warn(` can not foud object config in engine: ${e}`),!1;if(s.parent&&s.parent!==t.vid){const a=n.getConfigBySymbol(s.parent);if(!a)return o&&console.warn(` can not foud object parent config in engine: ${s.parent}`),!1;a.children.splice(a.children.indexOf(e),1)}s.parent=t.vid;const i=n.compilerManager.getObject3D(e);return i?(r.add(i),!0):(o&&console.warn(`can not found this vid in engine: ${e}.`),!1)})},pa=function({target:r,config:t,value:e,engine:n}){const o=n.compilerManager.getObject3D(e);if(!o){console.warn(`can not found this vid in engine: ${e}.`);return}r.remove(o);const s=n.getConfigBySymbol(e);if(!s){console.warn(`can not found this vid in engine: ${e}.`);return}s.parent=""},ne=function(r,t,e,n){Promise.resolve(),!e.lookAt&&wn({target:r,config:t,engine:n,value:t.lookAt}),t.children.forEach(o=>{fr({target:r,config:t,value:o,engine:n})});for(const o of Object.values(Yt))t[o].forEach((s,i)=>{fe({target:r,path:[o,i.toString()],value:s,engine:n})});return W(t,r,{vid:!0,type:!0,lookAt:!0,parent:!0,children:!0,pointerdown:!0,pointermove:!0,pointerup:!0,pointerenter:!0,pointerleave:!0,click:!0,dblclick:!0,contextmenu:!0,...e}),r},X=function(r){r._listener={}},U={add:{pointerdown:fe,pointerup:fe,pointermove:fe,pointerenter:fe,pointerleave:fe,click:fe,dblclick:fe,contextmenu:fe,children:fr},set:{lookAt:wn,pointerdown:we,pointerup:we,pointermove:we,pointerenter:we,pointerleave:we,click:we,dblclick:we,contextmenu:we,parent:Rt,children:{$reg:[{reg:new RegExp(".*"),handler:fr}]}},delete:{pointerdown:ve,pointerup:ve,pointermove:ve,pointerenter:ve,pointerleave:ve,click:ve,dblclick:ve,contextmenu:ve,children:pa}};L({configType:d.OBJECT3D,commands:U,create(r,t){return ne(new l.Object3D,r,{},t)},dispose:X});const re=new WeakMap;var ha=L({configType:d.PERSPECTIVECAMERA,commands:{add:{scale(){},...U.add},set:{scale(){},adaptiveWindow({target:r,value:t,engine:e}){if(t){if(!re.has(t)){const n=o=>{r.aspect=o.width/o.height,r.updateProjectionMatrix()};re.set(r,n),e.addEventListener("setSize",n),n({type:"setSize",width:e.dom.offsetWidth,height:e.dom.offsetHeight})}}else{const n=re.get(r);n&&(e.removeEventListener("setSize",n),re.delete(r))}},...U.set,$reg:[{reg:new RegExp("fov|aspect|near|far"),handler({target:r,key:t,value:e}){r[t]=e,r.updateProjectionMatrix()}}]},delete:{scale(){},...U.delete}},create(r,t){const e=new l.PerspectiveCamera;if(ne(e,r,{scale:!0,adaptiveWindow:!0},t),e.updateProjectionMatrix(),r.adaptiveWindow){const n=o=>{e.aspect=o.width/o.height,e.updateProjectionMatrix()};re.set(e,n),t.addEventListener("setSize",n),n({type:"setSize",width:t.dom.offsetWidth,height:t.dom.offsetHeight})}return e},dispose(r){re.delete(r),X(r)}}),fa=L({configType:d.ORTHOGRAPHICCAMERA,commands:{add:{scale(){},...U.add},set:{scale(){},adaptiveWindow({target:r,value:t,engine:e}){if(t){if(!re.has(t)){const n=o=>{const s=o.width,i=o.height;r.left=-s,r.right=s,r.top=i,r.bottom=-i,r.updateProjectionMatrix()};re.set(r,n),e.addEventListener("setSize",n),n({type:"setSize",width:e.dom.offsetWidth,height:e.dom.offsetHeight})}}else{const n=re.get(r);n&&(e.removeEventListener("setSize",n),re.delete(r))}},...U.set,$reg:[{reg:new RegExp("left|right|top|bottom|near|far|zoom"),handler({target:r,key:t,value:e}){r[t]=e,r.updateProjectionMatrix()}}]},delete:{scale(){},...U.delete}},create(r,t){const e=new l.OrthographicCamera(-50,50,50,-50);if(ne(e,r,{scale:!0,adaptiveWindow:!0},t),e.updateProjectionMatrix(),r.adaptiveWindow){const n=o=>{const s=o.width,i=o.height;e.left=-s,e.right=s,e.top=i,e.bottom=-i,e.updateProjectionMatrix()};re.set(e,n),t.addEventListener("setSize",n),n({type:"setSize",width:t.dom.offsetWidth,height:t.dom.offsetHeight})}return e},dispose(r){re.delete(r),X(r)}});class ma extends Me{constructor(){super();c(this,"MODULE",y.CAMERA)}}M.processor(ha),M.processor(fa);var ga=L({configType:d.ORBITCONTROLS,commands:{set:{target({target:r,config:t,path:e,key:n,value:o}){const s=t.target;if(!t.type){t.target=new l.Vector3(0,0,0);return}typeof t.target=="string"||(e.length>1?r.target[n]=o:r.target=new l.Vector3(s.x,s.y,s.z))}}},create(r,t){let e;return t.orbitControls?e=t.orbitControls:(e=new Ir,e.setCamera(t.camera),e.setDom(t.dom)),r.target&&(typeof r.target=="string"||(e.target=new l.Vector3(r.target.x,r.target.y,r.target.z))),W(r,e,{target:!0}),e},dispose(r){r.dispose()}}),ya=L({configType:d.TRNASFORMCONTROLS,commands:{set:{snapAllow({target:r,config:t,value:e}){e?(r.translationSnap=t.translationSnap,r.rotationSnap=t.rotationSnap,r.scaleSnap=t.scaleSnap):(r.translationSnap=null,r.rotationSnap=null,r.scaleSnap=null)},translationSnap({target:r,config:t,value:e}){t.snapAllow&&(r.translationSnap=e)},rotationSnap({target:r,config:t,value:e}){t.snapAllow&&(r.rotationSnap=e)},scaleSnap({target:r,config:t,value:e}){t.snapAllow&&(r.scaleSnap=e)}}},create(r,t){let e;return t.transformControls?e=t.transformControls:(e=new Br,e.setCamera(t.camera),t.dom&&e.setDom(t.dom)),r.snapAllow&&(e.translationSnap=r.translationSnap,e.rotationSnap=r.rotationSnap,e.scaleSnap=r.scaleSnap),e},dispose(r){r.dispose()}});class Ea extends M{constructor(){super();c(this,"MODULE",y.CONTROLS)}useEngine(e){return e.transformControls&&(this.map.set(N(d.TRNASFORMCONTROLS),e.transformControls),this.weakMap.set(e.transformControls,N(d.TRNASFORMCONTROLS))),e.orbitControls&&(this.map.set(N(d.ORBITCONTROLS),e.orbitControls),this.weakMap.set(e.orbitControls,N(d.ORBITCONTROLS))),super.useEngine(e)}}M.processor(ga),M.processor(ya);const $e=function(r,t){const e=t.resourceManager.resourceMap;if(!e.has(r))return console.warn(`css3D compiler: can not found resource element: ${r}`),document.createElement("div");const n=e.get(r);return n instanceof HTMLElement?n:(console.warn("css3D compiler can not suport render this resource type.",n.constructor,r),document.createElement("div"))};var Sa=L({configType:d.CSS3DOBJECT,commands:{add:U.add,set:{element({target:r,value:t,engine:e}){r.element=$e(t,e)},...U.set},delete:U.delete},create(r,t){return ne(new Ee.CSS3DObject($e(r.element,t)),r,{element:!0},t)},dispose:X});class ba extends Ee.CSS3DObject{constructor(e=document.createElement("div")){const n=document.createElement("div"),o=50,s=50;n.style.width=`${o}px`,n.style.height=`${s}px`,n.appendChild(e);super(n);c(this,"geometry");c(this,"_width");c(this,"_height");this.geometry=new l.PlaneBufferGeometry(o,s),this.geometry.computeBoundingBox(),this._width=o,this._height=s}get width(){return this._width}set width(e){this.geometry.dispose(),this.geometry=new l.PlaneBufferGeometry(e,this._height),this.geometry.computeBoundingBox(),this.element.style.width=`${e}px`,this._width=e}get height(){return this._height}set height(e){this.geometry.dispose(),this.geometry=new l.PlaneBufferGeometry(this._width,e),this.geometry.computeBoundingBox(),this.element.style.height=`${e}px`,this._height=e}}class Tn extends ba{constructor(e=document.createElement("div")){super(e);c(this,"cacheBox",new l.Box3);this.type="CSS3DPlane",this.element.classList.add("vis-css3d","vis-css3d-plane")}raycast(e,n){const o=this.cacheBox.copy(this.geometry.boundingBox);o.applyMatrix4(this.matrixWorld),e.ray.intersectsBox(o)&&n.push({distance:e.ray.origin.distanceTo(this.position),object:this,point:this.position})}}var Ma=L({configType:d.CSS3DPLANE,commands:{add:U.add,set:{element({target:r,value:t,engine:e}){r.element.innerHTML="",r.element.appendChild($e(t,e))},...U.set},delete:U.delete},create(r,t){return ne(new Tn($e(r.element,t)),r,{element:!0},t)},dispose:X});class va extends Ee.CSS3DSprite{constructor(e=document.createElement("div")){const n=document.createElement("div"),o=50,s=50;n.style.width=`${o}px`,n.style.height=`${s}px`,n.appendChild(e),e.classList.add("vis-css3d","vis-css3d-sprite");super(n);c(this,"geometry");c(this,"_width");c(this,"_height");c(this,"cacheBox",new l.Box3);c(this,"cachePosition",new l.Vector3);c(this,"cacheQuaternion",new l.Quaternion);c(this,"cacheScale",new l.Vector3);c(this,"cacheMatrix4",new l.Matrix4);c(this,"rotateMatrix4",new l.Matrix4);this.geometry=new l.PlaneBufferGeometry(o,s),this.geometry.computeBoundingBox(),this._width=o,this._height=s,this.type="CSS3DSprite"}get width(){return this._width}set width(e){this.geometry.dispose(),this.geometry=new l.PlaneBufferGeometry(e,this._height),this.geometry.computeBoundingBox(),this.element.style.width=`${e}px`,this._width=e}get height(){return this._height}set height(e){this.geometry.dispose(),this.geometry=new l.PlaneBufferGeometry(this._width,e),this.geometry.computeBoundingBox(),this.element.style.height=`${e}px`,this._height=e}raycast(e,n){const o=this.cacheBox.copy(this.geometry.boundingBox);this.matrixWorld.decompose(this.cachePosition,this.cacheQuaternion,this.cacheScale);const s=this.rotateMatrix4.lookAt(this.position,e.camera.position,this.up);this.cacheQuaternion.setFromRotationMatrix(s),this.cacheMatrix4.compose(this.cachePosition,this.cacheQuaternion,this.cacheScale),o.applyMatrix4(this.cacheMatrix4),e.ray.intersectsBox(o)&&n.push({distance:e.ray.origin.distanceTo(this.position),object:this,point:this.position})}}var wa=L({configType:d.CSS3DSPRITE,commands:{add:U.add,set:{element({target:r,value:t,engine:e}){r.element.innerHTML="",r.element.appendChild($e(t,e))},...U.set},delete:U.delete},create(r,t){return ne(new va($e(r.element,t)),r,{element:!0},t)},dispose:X});class Ta extends Me{constructor(){super();c(this,"MODULE",y.CSS3D)}}M.processor(Ma),M.processor(Sa),M.processor(wa);class Ve extends l.BufferGeometry{constructor(e=[],n=36,o=!0){super();c(this,"parameters");this.type="CurveGeometry",this.parameters={path:e.map(s=>s.clone()),space:o,divisions:n}}}class Ca extends Ve{constructor(t=[],e=36,n=!0){super(t,e,n),this.type="QuadraticBezierCurveGeometry";const o=new l.CurvePath;if(t.length<3){console.warn("QuadraticBezierCurveGeometry path length at least 3.");return}const s=3+(t.length-3)-(t.length-3)%2;for(let a=1;a<s;a+=2)o.add(new l.QuadraticBezierCurve3(t[a-1],t[a],t[a+1]));const i=o.curves.reduce((a,u)=>a+=u.arcLengthDivisions,0);if(e>i){const a=Math.ceil((e-i)/o.curves.length);o.curves.forEach(u=>{u.arcLengthDivisions=u.arcLengthDivisions*(a+1),u.updateArcLengths()})}this.setFromPoints(n?o.getSpacedPoints(e):o.getPoints(e))}}class Ra extends Ve{constructor(t=[],e=36,n=!0){super(t,e,n),this.type="CubicBezierCurveGeometry";const o=new l.CurvePath;if(t.length<4){console.warn("CubicBezierCurveGeometry path length at least 4.");return}const s=4+(t.length-4)-(t.length-4)%3;for(let a=2;a<s;a+=3)o.add(new l.CubicBezierCurve3(t[a-2],t[a-1],t[a],t[a+1]));const i=o.curves.reduce((a,u)=>a+=u.arcLengthDivisions,0);if(e>i){const a=Math.ceil((e-i)/o.curves.length);o.curves.forEach(u=>{u.arcLengthDivisions=u.arcLengthDivisions*(a+1),u.updateArcLengths()})}this.setFromPoints(n?o.getSpacedPoints(e):o.getPoints(e))}}class xa extends Ve{constructor(t=[],e=36,n=!0){if(super(t,e,n),this.type="LineCurveGeometry",!t.length){console.warn("LineCurveGeometry path length at least 1.");return}const o=new l.CurvePath;for(let i=1;i<t.length;i+=1)o.add(new l.LineCurve3(t[i-1],t[i]));const s=o.curves.reduce((i,a)=>i+=a.arcLengthDivisions,0);if(e>s){const i=Math.ceil((e-s)/o.curves.length);o.curves.forEach(a=>{a.arcLengthDivisions=a.arcLengthDivisions*(i+1),a.updateArcLengths()})}this.setFromPoints(n?o.getSpacedPoints(e):o.getPoints(e))}}class Oa extends Ve{constructor(t=[],e=36,n=!0){if(super(t,e,n),this.type="SplineCurveGeometry",!t.length){console.warn("SplineCurveGeometry path length at least 1.");return}const o=new l.CatmullRomCurve3(t);this.setFromPoints(n?o.getSpacedPoints(e):o.getPoints(e))}}class La extends l.TubeGeometry{constructor(t=[],e=64,n=1,o=8,s=!1){if(!t.length){console.warn("LineTubeGeometry path length at least 1.");return}const i=new l.CurvePath;for(let a=1;a<t.length;a+=1)i.add(new l.LineCurve3(t[a-1],t[a]));super(i,e,n,o,s),this.type="LineTubeGeometry"}}class Aa extends l.TubeGeometry{constructor(t=[],e=64,n=1,o=8,s=!1){if(!t.length){console.warn("SplineTubeGeometry path length at least 1.");return}const i=new l.CatmullRomCurve3(t);super(i,e,n,o,s),this.type="SplineTubeGeometry"}}class Da extends l.ShapeBufferGeometry{constructor(t=[new l.Vector2(0,0)],e=12){const n=new l.Shape,o=t[0];if(o){n.moveTo(o.x,o.y);for(let s=1;s<t.length;s+=1)n.lineTo(t[s].x,t[s].y)}super(n,e),this.type="LineShapeGeometry"}}const Pa=function(r,t){!(r instanceof Ve)&&!(r instanceof l.TubeGeometry)&&!(r instanceof l.ShapeGeometry)&&r.center(),r.computeBoundingBox();const e=r.boundingBox,n=t.position,o=t.rotation,s=t.scale,i=new l.Quaternion().setFromEuler(new l.Euler(o.x,o.y,o.z,"XYZ"));return r.applyQuaternion(i),r.scale(s.x,s.y,s.z),!(r instanceof Ve)&&!(r instanceof l.TubeGeometry)&&!(r instanceof l.ShapeGeometry)&&r.center(),r.computeBoundingBox(),r.translate((e.max.x-e.min.x)/2*n.x,(e.max.y-e.min.y)/2*n.y,(e.max.z-e.min.z)/2*n.z),r},mr={reg:new RegExp(".*"),handler({config:r,target:t,processor:e,engine:n}){const o=e.create(r,n);t.copy(o),t.dispatchEvent({type:"update"}),t.uuid=o.uuid,o.dispose()}},xt={add:{groups({target:r,value:t}){r.addGroup(t.start,t.count,t.materialIndex)},$reg:[mr]},set:{groups(r){const{path:t,target:e,config:n}=r;if(t[1]!==void 0){e.groups.splice(Number(r.path[1]),1);const o=n.groups[t[1]];e.addGroup(o.start,o.count,o.materialIndex)}else console.warn("geometry processor can not set group",r)},$reg:[mr]},delete:{groups({target:r,key:t}){r.groups.splice(Number(t),1)},$reg:[mr]}},Ot=function(r,t){r.clearGroups();for(const e of t.groups)r.addGroup(e.start,e.count,e.materialIndex);return Pa(r,t)},k=new Map;k.set(d.BOXGEOMETRY,r=>new l.BoxBufferGeometry(r.width,r.height,r.depth,r.widthSegments,r.heightSegments,r.depthSegments)),k.set(d.SPHEREGEOMETRY,r=>new l.SphereBufferGeometry(r.radius,r.widthSegments,r.heightSegments,r.phiStart,r.phiLength,r.thetaStart,r.thetaLength)),k.set(d.PLANEGEOMETRY,r=>new l.PlaneBufferGeometry(r.width,r.height,r.widthSegments,r.heightSegments)),k.set(d.CIRCLEGEOMETRY,r=>new l.CircleBufferGeometry(r.radius,r.segments,r.thetaStart,r.thetaLength)),k.set(d.CONEGEOMETRY,r=>new l.ConeBufferGeometry(r.radius,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength)),k.set(d.CYLINDERGEOMETRY,r=>new l.CylinderBufferGeometry(r.radiusTop,r.radiusBottom,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength)),k.set(d.LINECURVEGEOMETRY,r=>new xa(r.path.map(t=>new l.Vector3(t.x,t.y,t.z)),r.divisions,r.space)),k.set(d.SPLINECURVEGEOMETRY,r=>new Oa(r.path.map(t=>new l.Vector3(t.x,t.y,t.z)),r.divisions,r.space)),k.set(d.CUBICBEZIERCURVEGEOMETRY,r=>new Ra(r.path.map(t=>new l.Vector3(t.x,t.y,t.z)),r.divisions,r.space)),k.set(d.QUADRATICBEZIERCURVEGEOMETRY,r=>new Ca(r.path.map(t=>new l.Vector3(t.x,t.y,t.z)),r.divisions,r.space)),k.set(d.LINETUBEGEOMETRY,r=>new La(r.path.map(t=>new l.Vector3(t.x,t.y,t.z)),r.tubularSegments,r.radius,r.radialSegments,r.closed)),k.set(d.SPLINETUBEGEOMETRY,r=>new Aa(r.path.map(t=>new l.Vector3(t.x,t.y,t.z)),r.tubularSegments,r.radius,r.radialSegments,r.closed)),k.set(d.TORUSGEOMETRY,r=>new l.TorusGeometry(r.radius,r.tube,r.radialSegments,r.tubularSegments,r.arc)),k.set(d.RINGGEOMETRY,r=>new l.RingBufferGeometry(r.innerRadius,r.outerRadius,r.thetaSegments,r.phiSegments,r.thetaStart,r.thetaLength)),k.set(d.LINESHAPEGEOMETRY,r=>new Da(r.path.map(t=>new l.Vector2(t.x,t.y)),r.curveSegments));const ja=function(r){return k.has(r.type)?Ot(k.get(r.type)(r),r):(console.error(`parametric geometry can not support this type config: ${r.type}`),new l.BufferGeometry)},Ia=function(r){r.dispose()},Ga=function(r){return L({configType:r,commands:xt,create:ja,dispose:Ia})},Ba=[d.BOXGEOMETRY,d.SPHEREGEOMETRY,d.PLANEGEOMETRY,d.CIRCLEGEOMETRY,d.CONEGEOMETRY,d.CYLINDERGEOMETRY,d.LINECURVEGEOMETRY,d.SPLINECURVEGEOMETRY,d.CUBICBEZIERCURVEGEOMETRY,d.QUADRATICBEZIERCURVEGEOMETRY,d.LINETUBEGEOMETRY,d.SPLINETUBEGEOMETRY,d.TORUSGEOMETRY,d.RINGGEOMETRY,d.LINESHAPEGEOMETRY].map(r=>Ga(r));class Ua extends l.BufferGeometry{constructor(e){super();c(this,"type","LoadBufferGeometry");e&&this.copy(e)}}var Ha=L({configType:d.LOADGEOMETRY,commands:xt,create(r,t){const e=t.resourceManager.resourceMap.get(r.url);return!e&&!(e instanceof l.BufferGeometry)?(console.error(`engine rescoure can not found url: ${r.url}`),new l.BoxBufferGeometry(5,5,5)):Ot(new Ua(e),r)},dispose(r){r.dispose()}});const Na=function(r){const t=new l.BufferGeometry;return r.position.length&&t.setAttribute("position",new l.Float32BufferAttribute(r.position,3)),r.color.length&&t.setAttribute("color",new l.Float32BufferAttribute(r.color,3)),r.normal.length&&t.setAttribute("normal",new l.Float32BufferAttribute(r.normal,3)),r.uv.length&&t.setAttribute("uv",new l.Float32BufferAttribute(r.uv,2)),r.uv2.length&&t.setAttribute("uv2",new l.Float32BufferAttribute(r.uv2,2)),r.index.length&&t.setIndex(r.index),t};var za=L({configType:d.CUSTOMGEOMETRY,commands:xt,create(r){return Ot(Na(r.attribute),r)},dispose(r){r.dispose()}}),Fa=L({configType:d.EDGESGEOMETRY,commands:xt,create(r,t){const e=t.compilerManager.getObjectBySymbol(r.url);return!e||!(e instanceof l.BufferGeometry)?(console.error(`engine rescoure can not found url: ${r.url}`),new l.EdgesGeometry(new l.BoxBufferGeometry(5,5,5))):Ot(new l.EdgesGeometry(e),r)},dispose(r){r.dispose()}});class ka extends M{constructor(){super();c(this,"MODULE",y.GEOMETRY)}}Ba.forEach(r=>{M.processor(r)}),M.processor(Ha),M.processor(za),M.processor(Fa);var $a=L({configType:d.GROUP,commands:U,create(r,t){return ne(new l.Group,r,{},t)},dispose:X});class Va extends Me{constructor(){super();c(this,"MODULE",y.GROUP)}}M.processor($a);const Wa=function({target:r,value:t}){r.color.copy(new l.Color(t))},Lt=function(r,t,e,n){return r.color.copy(new l.Color(t.color)),ne(r,t,{color:!0,scale:!0,rotation:!0,lookAt:!0,...e},n)},At=Object.assign({},U,{set:{color:Wa,scale:Rt,rotation:Rt,lookAt:Rt}});var _a=L({configType:d.AMBIENTLIGHT,commands:At,create(r,t){return Lt(new l.AmbientLight,r,{},t)},dispose:X}),Ya=L({configType:d.DIRECTIONALLIGHT,commands:At,create(r,t){return Lt(new l.DirectionalLight,r,{},t)},dispose:X}),Qa=L({configType:d.POINTLIGHT,commands:At,create(r,t){return Lt(new l.PointLight,r,{},t)},dispose:X}),Xa=L({configType:d.SPOTLIGHT,commands:At,create(r,t){return Lt(new l.SpotLight,r,{},t)},dispose:X});class Ka extends Me{constructor(){super();c(this,"MODULE",y.LIGHT)}}M.processor(_a),M.processor(Ya),M.processor(Qa),M.processor(Xa);class Dt extends Me{constructor(){super()}}const Pt=new l.ShaderMaterial({fragmentShader:`
  void main () {
    gl_FragColor = vec4(0.5, 0.5, 0.5, 1.0);
  }
  `}),Ja=new l.BoxBufferGeometry(10,10,10),Cn=function({target:r,value:t,engine:e}){Ge.exec(n=>{const o=e.compilerManager.getGeometry(t);return o?(r.geometry=o,!0):(n&&console.warn(`can not found geometry by vid in engine: ${t}`),r.geometry=Ja,!1)})},jt=function({target:r,config:t,engine:e}){Ge.exec(n=>{let o;return typeof t.material=="string"?o=e.compilerManager.getMaterial(t.material)||Pt:o=t.material.map(s=>e.compilerManager.getMaterial(s)||Pt),r.material=o,!(Array.isArray(o)&&o.length&&o[0]===Pt||o===Pt)})},It=function(r,t,e,n){return e.geometry||(r.geometry.dispose(),Cn({target:r,value:t.geometry,engine:n})),e.material||jt({target:r,config:t,engine:n}),ne(r,t,{geometry:!0,material:!0,...e},n)},Gt=function(r){X(r)},We={add:{material:jt,...U.add},set:{geometry:Cn,material:jt,...U.set},delete:{material:jt,...U.delete}};var Za=L({configType:d.LINE,commands:We,create(r,t){return It(new l.Line,r,{},t)},dispose:Gt});class qa extends Dt{constructor(){super();c(this,"MODULE",y.LINE)}}M.processor(Za);const Te={reg:new RegExp("transparent|sizeAttenuation"),handler({target:r,key:t,value:e}){r[t]=e,r.needsUpdate=!0}},Rn=function({target:r,key:t,value:e,engine:n}){Ge.exec(o=>{const s=n.compilerManager.getObjectBySymbol(e);return s instanceof l.Texture?(r[t]=s,r.needsUpdate=!0,!0):(o&&console.warn(`this url resource is not instance of Texture: ${t}`,e,s),r[t]=null,!1)})},Be={reg:new RegExp("map$","i"),handler:Rn},K=function({target:r,key:t,value:e}){r[t].copy(new l.Color(e))},Ue=function(r,t,e){const n={};for(const o of Object.keys(t))o.toLocaleLowerCase().endsWith("map")&&t[o]?(Rn({target:r,key:o,value:t[o],engine:e}),n[o]=!0):r[o]instanceof l.Color&&(r[o]=new l.Color(t[o]),n[o]=!0);return W(t,r,n),r.needsUpdate=!0,r},Ce=function(r){r.dispose()};var xn=L({configType:d.LINEBASICMATERIAL,commands:{set:{color:K,$reg:[Be,Te]}},create:function(r,t){return Ue(new l.LineBasicMaterial,r,t)},dispose:Ce}),ec=L({configType:d.MESHBASICMATERIAL,commands:{set:{color:K,$reg:[Be,Te]}},create:function(r,t){return Ue(new l.MeshBasicMaterial,r,t)},dispose:Ce}),tc=L({configType:d.MESHPHONGMATERIAL,commands:{set:{color:K,emissive:K,specular:K,$reg:[Be,Te]}},create:function(r,t){return Ue(new l.MeshPhongMaterial,r,t)},dispose:Ce}),rc=L({configType:d.MESHPHYSICALMATERIAL,commands:{set:{color:K,emissive:K,specularColor:K,sheenColor:K,attenuationColor:K,$reg:[Be,Te]}},create:function(r,t){return Ue(new l.MeshPhysicalMaterial,r,t)},dispose:Ce}),nc=L({configType:d.MESHSTANDARDMATERIAL,commands:{set:{color:K,emissive:K,$reg:[Be,Te]}},create:function(r,t){return Ue(new l.MeshStandardMaterial,r,t)},dispose:Ce}),oc=L({configType:d.POINTSMATERIAL,commands:{set:{color:K,$reg:[Be,Te]}},create:function(r,t){return Ue(new l.PointsMaterial,r,t)},dispose:Ce});const sc={name:"uvPulseShader",uniforms:{time:{value:0},width:{value:.5},color:{value:{r:1,g:0,b:0}},center:{value:{x:.5,y:.5}}},vertexShader:`
    varying vec2 vUv;

    void main () {

      vUv = uv;

      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }`,fragmentShader:`
    uniform float width;
    uniform float time;
    uniform vec3 color;
    uniform vec2 center;

    varying vec2 vUv;

    void main () {
      // \u6839\u636EuTime\u6C42\u51FA\u767E\u5206\u6BD4
      float deg = mod(degrees(time), 360.0);
      if (deg > 0.0 && deg < 180.0) {
        discard;
      }

      float percent = cos(time);
      float distancePercent = distance(center, vUv);

      // \u4ECE\u5916\u5411\u91CC
      if (distancePercent > 0.5) {
        discard;
      }

      if (distancePercent < percent) {
        discard;
      }

      if (distancePercent - percent > width) {
        discard;
      }

      float opacity =  (width - (distancePercent - percent)) / width;

      // float opacity = distancePercent;
      gl_FragColor = vec4(color, opacity);
    }`},ic={name:"fragCoordTestingShader",uniforms:{resolution:{value:{x:1920,y:1080}}},vertexShader:`
  void main () {
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }`,fragmentShader:`
    uniform vec2 resolution;

    void main () {
      vec2 st = gl_FragCoord.xy / resolution;
      gl_FragColor = vec4(st.x,st.y,0.0,1.0);
    }`},ac={name:"colorMixShader",uniforms:{colorA:{value:{r:1,g:0,b:0}},colorB:{value:{r:0,g:1,b:0}},percent:{value:.5}},vertexShader:`
  void main () {
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }`,fragmentShader:`
    uniform vec3 colorA;
    uniform vec3 colorB;
    uniform float percent;

    void main () {
      gl_FragColor = vec4(mix(colorA, colorB, percent), 1.0);
    }`},cc={name:"BloomShader",uniforms:{brightness:{value:.8},extend:{value:5},specular:{value:.9},outFade:{value:2},inFade:{value:.3},color:{value:{r:1,g:1,b:1}}},vertexShader:`
  uniform float extend;

  varying vec3 vNormal;
  varying vec3 vView;

  void main () {

    vec3 extendPosition = position + normalize(position) * extend;

    vNormal = normalize(position);
    vView = normalize(cameraPosition - (modelMatrix * vec4(extendPosition , 1.0 )).xyz);

    gl_Position = projectionMatrix * modelViewMatrix * vec4(extendPosition , 1.0 );
  }`,fragmentShader:`
    uniform vec3 color;
    uniform float brightness;
    uniform float specular;
    uniform float outFade;
    uniform float inFade;

    varying vec3 vNormal;
    varying vec3 vView;
    
    void main () {

      float present = smoothstep(0.0, 1.0, dot(vView, vNormal));

      if (present >= specular) {
        present = pow(smoothstep(1.0, specular, present), inFade);
      } else {
        present = pow(smoothstep(0.0, specular, present), outFade);
      }

      gl_FragColor = vec4(color, present * brightness);
    }`},me=class{static getShader(t){return me.library.has(t)?me.cloneShader(me.library.get(t)):(console.warn(`con not found shader in shader library: ${t}`),null)}static generateConfig(t){if(!me.library.has(t))return console.warn(`con not found shader in shader library: ${t}`),{};const e=me.library.get(t),n={shader:t,uniforms:{}};return e.uniforms&&(n.uniforms=JSON.parse(JSON.stringify(e.uniforms))),n}static cloneShader(t){const e={name:t.name};return t.vertexShader&&(e.vertexShader=t.vertexShader),t.fragmentShader&&(e.fragmentShader=t.fragmentShader),t.uniforms&&(e.uniforms=JSON.parse(JSON.stringify(t.uniforms))),e}};let Z=me;c(Z,"library",new Map),c(Z,"reigster",function(t){me.library.has(t.name)&&console.warn(`shader library has exist shader: ${t.name} that will be cover.`),me.library.set(t.name,t)});const lc={name:"defaultShader"};Z.reigster(lc),Z.reigster(sc),Z.reigster(ic),Z.reigster(ac),Z.reigster(cc);var uc=L({configType:d.SHADERMATERIAL,commands:{set:{shader({target:r,value:t}){const e=Z.getShader(t);e!=null&&e.vertexShader&&(r.vertexShader=e.vertexShader),e!=null&&e.fragmentShader&&(r.fragmentShader=e.fragmentShader),e!=null&&e.uniforms&&(r.uniforms=e.uniforms),e!=null&&e.defines&&(r.defines=e.defines),r.needsUpdate=!0},$reg:[Te]}},create:function(r,t){const e=new l.ShaderMaterial,n=Z.getShader(r.shader);return n!=null&&n.vertexShader&&(e.vertexShader=n.vertexShader),n!=null&&n.fragmentShader&&(e.fragmentShader=n.fragmentShader),n!=null&&n.uniforms&&(e.uniforms=n.uniforms),n!=null&&n.defines&&(e.defines=n.defines),W(r,e,{type:!0,shader:!0}),e.needsUpdate=!0,e},dispose:Ce}),dc=L({configType:d.SPRITEMATERIAL,commands:{set:{color:K,$reg:[Be,Te]}},create:function(r,t){return Ue(new l.SpriteMaterial,r,t)},dispose:Ce});class pc extends M{constructor(){super();c(this,"MODULE",y.MATERIAL)}}M.processor(ec),M.processor(nc),M.processor(tc),M.processor(xn),M.processor(oc),M.processor(dc),M.processor(xn),M.processor(uc),M.processor(rc);var hc=L({configType:d.MESH,commands:We,create(r,t){return It(new l.Mesh,r,{},t)},dispose:Gt});class fc extends Dt{constructor(){super();c(this,"MODULE",y.MESH)}}M.processor(hc);var mc=L({configType:d.OBJECT3D,commands:U,create(r,t){return ne(new l.Object3D,r,{},t)},dispose:X});class gc extends Me{constructor(){super();c(this,"MODULE",y.OBJECT3D)}}M.processor(mc);var yc=L({configType:d.SMAAPASS,create(r,t){const e=window.devicePixelRatio;return new mo.SMAAPass(t.dom?t.dom.offsetWidth*e:window.innerWidth*e,t.dom?t.dom.offsetHeight*e:window.innerWidth*e)},dispose(r){}}),Ec=L({configType:d.UNREALBLOOMPASS,create(r,t){const e=window.devicePixelRatio;return new go.UnrealBloomPass(new l.Vector2(t.dom?t.dom.offsetWidth*e:window.innerWidth*e,t.dom?t.dom.offsetHeight*e:window.innerWidth*e),r.strength,r.radius,r.threshold)},dispose(r){r.dispose()}});const kt=class extends Ar.Pass{constructor(e=new l.Vector2(256,256),n=1,o=0,s=0,i=new l.Scene,a=new l.PerspectiveCamera,u){super();c(this,"resolution");c(this,"strength");c(this,"radius");c(this,"threshold");c(this,"selectedObjects",[]);c(this,"renderScene");c(this,"renderCamera");c(this,"clearColor",new l.Color(0,0,0));c(this,"renderTargetsHorizontal",[]);c(this,"renderTargetsVertical",[]);c(this,"nMips",5);c(this,"selectRenderTarget");c(this,"renderTargetBright");c(this,"highPassUniforms");c(this,"materialHighPassFilter");c(this,"separableBlurMaterials",[]);c(this,"compositeMaterial");c(this,"bloomTintColors");c(this,"mixMaterial");c(this,"enabled",!0);c(this,"needsSwap",!1);c(this,"_oldClearColor",new l.Color);c(this,"oldClearAlpha",1);c(this,"basic",new l.MeshBasicMaterial);c(this,"fsQuad",new Ar.FullScreenQuad);c(this,"materialCache",new Map);c(this,"sceneBackgroundCache",null);c(this,"overrideBackground",new l.Color("black"));c(this,"overrideMeshMaterial",new l.MeshBasicMaterial({color:"black"}));c(this,"overrideLineMaterial",new l.LineBasicMaterial({color:"black"}));c(this,"overridePointsMaterial",new l.PointsMaterial({color:"black"}));c(this,"overrideSpriteMaterial",new l.SpriteMaterial({color:"black"}));this.resolution=e,this.strength=n,this.radius=o,this.threshold=s,this.renderScene=i,this.renderCamera=a,this.selectedObjects=u;let h=Math.round(this.resolution.x/2),p=Math.round(this.resolution.y/2);this.selectRenderTarget=new l.WebGLRenderTarget(h,p),this.selectRenderTarget.texture.name="UnrealBloomPass.selected",this.selectRenderTarget.texture.generateMipmaps=!1,this.renderTargetBright=new l.WebGLRenderTarget(h,p),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let v=0;v<this.nMips;v++){const S=new l.WebGLRenderTarget(h,p);S.texture.name="UnrealBloomPass.h"+v,S.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(S);const R=new l.WebGLRenderTarget(h,p);R.texture.name="UnrealBloomPass.v"+v,R.texture.generateMipmaps=!1,this.renderTargetsVertical.push(R),h=Math.round(h/2),p=Math.round(p/2)}Dr.LuminosityHighPassShader===void 0&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const m=Dr.LuminosityHighPassShader;this.highPassUniforms=l.UniformsUtils.clone(m.uniforms),this.highPassUniforms.luminosityThreshold.value=s,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new l.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,defines:{}});const T=[3,5,7,9,11];h=Math.round(this.resolution.x/2),p=Math.round(this.resolution.y/2);for(let v=0;v<this.nMips;v++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(T[v])),this.separableBlurMaterials[v].uniforms.texSize.value=new l.Vector2(h,p),h=Math.round(h/2),p=Math.round(p/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=n,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;const b=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=b,this.bloomTintColors=[new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,this.mixMaterial=this.getMixMaterial()}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,n){let o=Math.round(e/2),s=Math.round(n/2);this.selectRenderTarget.setSize(o,s),this.renderTargetBright.setSize(o,s);for(let i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(o,s),this.renderTargetsVertical[i].setSize(o,s),this.separableBlurMaterials[i].uniforms.texSize.value=new l.Vector2(o,s),o=Math.round(o/2),s=Math.round(s/2)}render(e,n,o,s,i){if(!this.selectedObjects.length){this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=o.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e));return}e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const a=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),i&&e.state.buffers.stencil.setTest(!1);const u=new Map;for(const m of this.selectedObjects)u.set(m,!0);const h=this.materialCache;this.renderScene.background&&(this.sceneBackgroundCache=this.renderScene.background,this.renderScene.background=this.overrideBackground),this.renderScene.traverse(m=>{!u.has(m)&&!m.isLight&&m.visible&&(h.set(m,m.material),m instanceof l.Mesh?m.material=this.overrideMeshMaterial:m instanceof l.Line?m.material=this.overrideLineMaterial:m instanceof l.Points?m.material=this.overridePointsMaterial:m instanceof l.Sprite&&(m.material=this.overrideSpriteMaterial))}),e.setRenderTarget(this.selectRenderTarget),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=this.selectRenderTarget.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=this.selectRenderTarget.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let p=this.renderTargetBright;for(let m=0;m<this.nMips;m++)this.fsQuad.material=this.separableBlurMaterials[m],this.separableBlurMaterials[m].uniforms.colorTexture.value=p.texture,this.separableBlurMaterials[m].uniforms.direction.value=kt.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[m]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[m].uniforms.colorTexture.value=this.renderTargetsHorizontal[m].texture,this.separableBlurMaterials[m].uniforms.direction.value=kt.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[m]),e.clear(),this.fsQuad.render(e),p=this.renderTargetsVertical[m];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.mixMaterial,this.mixMaterial.uniforms.bloom.value=this.renderTargetsHorizontal[0].texture,this.mixMaterial.uniforms.origin.value=o.texture,i&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(o),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=a;for(const m of h.entries())m[0].material=m[1];h.clear(),this.sceneBackgroundCache&&(this.renderScene.background=this.sceneBackgroundCache,this.sceneBackgroundCache=null)}getMixMaterial(){return new l.ShaderMaterial({blending:l.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0,uniforms:{bloom:{value:null},origin:{value:null}},vertexShader:`
    
        varying vec2 vUv;
    
        void main() {
    
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    
        }`,fragmentShader:`
        uniform sampler2D bloom;
        uniform sampler2D origin;
    
        varying vec2 vUv;
    
        void main() {
          vec3 bloomColor = texture2D(bloom, vUv).rgb;
          vec3 originColor = texture2D(origin, vUv).rgb;
          gl_FragColor = vec4(originColor + bloomColor, 1.0);
        }`})}getSeperableBlurMaterial(e){return new l.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new l.Vector2(.5,.5)},direction:{value:new l.Vector2(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}
				void main() {
					vec2 invSize = 1.0 / texSize;
					float fSigma = float(SIGMA);
					float weightSum = gaussianPdf(0.0, fSigma);
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianPdf(x, fSigma);
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new l.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}};let _e=kt;c(_e,"BlurDirectionX",new l.Vector2(1,0)),c(_e,"BlurDirectionY",new l.Vector2(0,1));var Sc=L({configType:d.SELECTIVEBLOOMPASS,commands:{add:{selectedObjects({target:r,engine:t,value:e}){const n=t.compilerManager.getObject3D(e);n?r.selectedObjects.push(n):console.warn(`selectiveBloomPassProcessor: can not found vid in engine: ${e}`)}},set:{renderScene({target:r,engine:t,value:e}){const n=t.compilerManager.getObject3D(e);n instanceof l.Scene&&(r.renderScene=n)},renderCamera({target:r,engine:t,value:e}){const n=t.compilerManager.getObject3D(e);n instanceof l.Camera&&(r.renderCamera=n)},selectedObjects({target:r,config:t,engine:e}){const n=t.selectedObjects.map(o=>{const s=e.compilerManager.getObject3D(o);if(s)return s;console.warn(`selectiveBloomPassProcessor: can not found vid in engine: ${o}`)}).filter(o=>o);r.selectedObjects=n}},delete:{selectedObjects({target:r,engine:t,value:e}){const n=t.compilerManager.getObject3D(e);n?r.selectedObjects.includes(n)&&r.selectedObjects.splice(r.selectedObjects.indexOf(n),1):console.warn(`selectiveBloomPassProcessor: can not found vid in engine: ${e}`)}}},create(r,t){const e=[];for(const s of r.selectedObjects){const i=t.compilerManager.getObject3D(s);i&&e.push(i)}const n=window.devicePixelRatio;return new _e(new l.Vector2(t.dom?t.dom.offsetWidth*n:window.innerWidth*n,t.dom?t.dom.offsetHeight*n:window.innerWidth*n),r.strength,r.radius,r.threshold,r.renderScene&&t.compilerManager.getObject3D(r.renderScene)||void 0,r.renderCamera&&t.compilerManager.getObject3D(r.renderCamera)||void 0,e)},dispose(r){r.dispose()}});class bc extends M{constructor(){super();c(this,"MODULE",y.PASS);c(this,"composer")}useEngine(e){return super.useEngine(e),e.effectComposer?(this.composer=e.effectComposer,this):(console.warn("engine need install effectComposer plugin that can use pass compiler."),this)}add(e){const n=super.add(e);return n&&this.composer.addPass(n),n}remove(e){if(!this.map.has(e.vid))return console.warn(`PassCompiler can not found this vid pass: ${e.vid}.`),this;const n=this.map.get(e.vid);return this.composer.removePass(n),super.remove(e),this}}M.processor(yc),M.processor(Ec),M.processor(Sc);var Mc=L({configType:d.POINTS,commands:We,create(r,t){return It(new l.Points,r,{},t)},dispose:Gt});class vc extends Dt{constructor(){super();c(this,"MODULE",y.POINTS)}}M.processor(Mc);var wc=L({configType:d.WEBGLRENDERER,commands:{set:{size({target:r,config:t}){t.size?r.setSize(t.size.x,t.size.y):r.setSize(r.domElement.offsetWidth,r.domElement.offsetHeight)},clearColor({target:r,value:t}){const e=Number(t.slice(0,-1).split(",").pop().trim());r.setClearColor(t,e),r.clear()},viewport({target:r,config:t}){const e=t.viewport;if(e)r.setViewport(e.x,e.y,e.width,e.height);else{const n=r.domElement;r.setViewport(0,0,n.offsetWidth,n.offsetHeight)}},scissor({target:r,config:t}){const e=t.scissor;if(e)r.setScissorTest(!0),r.setScissor(e.x,e.y,e.width,e.height);else{r.setScissorTest(!1);const n=r.domElement;r.setScissor(0,0,n.offsetWidth,n.offsetHeight)}},pixelRatio({target:r,value:t}){r.setPixelRatio(t),r.clear()}}},create(r,t){let e;if(t.webGLRenderer?e=t.webGLRenderer:e=new l.WebGLRenderer,r.size&&e.setSize(r.size.x,r.size.y),r.clearColor){const n=Number(r.clearColor.slice(0,-1).split(",").pop().trim());e.setClearColor(r.clearColor,n)}if(r.viewport){const n=r.viewport;e.setViewport(n.x,n.y,n.width,n.height)}if(r.scissor){const n=r.scissor;e.setScissorTest(!0),e.setScissor(n.x,n.y,n.width,n.height)}return r.pixelRatio&&e.setPixelRatio(r.pixelRatio),W(r,e,{size:!0,clearColor:!0,viewport:!0,scissor:!0,pixelRatio:!0}),e},dispose(r){r.clear(),r.dispose()}}),Tc=L({configType:d.CSS3DRENDERER,commands:{set:{size({target:r,config:t}){t.size?r.setSize(t.size.x,t.size.y):r.setSize(r.domElement.offsetWidth,r.domElement.offsetHeight)}}},create(r,t){let e;return t.css3DRenderer?e=t.css3DRenderer:e=new Ee.CSS3DRenderer,r.size&&e.setSize(r.size.x,r.size.y),W(r,e,{size:!0}),e},dispose(r){}});class Cc extends M{constructor(){super();c(this,"MODULE",y.RENDERER)}useEngine(e){return e.webGLRenderer&&(this.map.set(N(d.WEBGLRENDERER),e.webGLRenderer),this.weakMap.set(e.webGLRenderer,N(d.WEBGLRENDERER))),e.css3DRenderer&&(this.map.set(N(d.CSS3DRENDERER),e.css3DRenderer),this.weakMap.set(e.css3DRenderer,N(d.CSS3DRENDERER))),super.useEngine(e)}}M.processor(wc),M.processor(Tc);const On=function(r,t,e){if(!t){r.background=null;return}if(ee.validate(t)){const n=e.compilerManager.getTexture(t);n?r.background=n:console.warn(`engine can not found this vid texture : '${t}'`)}else r.background=new l.Color(t)},Ln=function(r,t,e){if(!t){r.environment=null;return}if(ee.validate(t)){const n=e.compilerManager.getTexture(t);n?r.environment=n:console.warn(`engine can not found this vid texture : '${t}'`)}else console.warn(`scene environment is illeage: ${t}`)};var Rc=L({configType:d.SCENE,commands:{add:U.add,set:{...U.set,lookAt(){},fog({target:r,config:t,key:e,value:n}){const o=t.fog;o.type?o.type==="Fog"?!r.fog||!(r.fog instanceof l.Fog)?r.fog=new l.Fog(o.color,o.near,o.far):e==="color"?r.fog.color.copy(new l.Color(o.color)):r.fog[e]&&(r.fog[e]=n):o.type==="FogExp2"&&(!r.fog||!(r.fog instanceof l.FogExp2)?r.fog=new l.FogExp2(o.color,o.density):e==="color"?r.fog.color.copy(new l.Color(o.color)):r.fog[e]&&(r.fog[e]=n)):r.fog=null},background({target:r,value:t,engine:e}){On(r,t,e)},environment({target:r,value:t,engine:e}){Ln(r,t,e)}},delete:U.delete},create(r,t){const e=new l.Scene;if(On(e,r.background,t),Ln(e,r.environment,t),r.fog.type){const n=r.fog;n.type==="Fog"?e.fog=new l.Fog(n.color,n.near,n.far):n.type==="FogExp2"?e.fog=new l.FogExp2(n.color,n.density):console.warn(`scene processor can not support this type fog:'${r.type}'`)}return ne(e,r,{lookAt:!0,background:!0,environment:!0,fog:!0},t)},dispose:X});class xc extends Me{constructor(){super();c(this,"MODULE",y.SCENE)}}M.processor(Rc);const An=new l.SpriteMaterial({color:"rgb(123, 123, 123)"});var Oc=L({configType:d.SPRITE,commands:{add:We.add,set:{lookAt(){},...We.set,material({target:r,engine:t,value:e}){const n=t.compilerManager.getMaterial(e);n&&n instanceof l.SpriteMaterial?r.material=n:r.material=An}},delete:We.add},create(r,t){const e=new l.Sprite,n=t.compilerManager.getMaterial(r.material);return n&&n instanceof l.SpriteMaterial?e.material=n:e.material=An,It(e,r,{geometry:!0,material:!0,lookAt:!0},t)},dispose:Gt});class Lc extends Dt{constructor(){super();c(this,"MODULE",y.SPRITE)}}M.processor(Oc);class Ac extends l.Texture{constructor(t,e,n,o,s,i,a,u,h,p){super(t,e,n,o,s,i,a,u,h,p)}}const Bt={reg:new RegExp("wrapS|wrapT|format|encoding|anisotropy|magFilter|minFilter|mapping"),handler({target:r,key:t,value:e}){r[t]=e,r.needsUpdate=!0}},Ye=function({target:r,value:t,engine:e}){Ge.exec(n=>(r.url=e.compilerManager.textureCompiler.getResource(t,[HTMLImageElement,HTMLVideoElement,HTMLCanvasElement]),r.needsUpdate=!0,r.url!==nt.replaceImage))};var Dc=L({configType:d.IMAGETEXTURE,commands:{set:{url:Ye,$reg:[Bt]}},create(r,t){const e=new Ac;return r.url&&Ye({target:e,value:r.url,engine:t}),W(r,e,{type:!0,url:!0}),e.needsUpdate=!0,e},dispose(r){r.dispose()}}),Pc=L({configType:d.CANVASTEXTURE,commands:{set:{url:Ye,$reg:[Bt]}},create(r,t){const e=new l.CanvasTexture(t.compilerManager.textureCompiler.getResource(r.url,HTMLCanvasElement));return Ye({target:e,value:r.url,engine:t}),W(r,e,{type:!0,url:!0}),e.needsUpdate=!0,e},dispose(r){r.dispose()}});const He=[HTMLImageElement,HTMLVideoElement,HTMLCanvasElement],Qe=function({target:r,index:t,value:e,engine:n}){r.images[t]=n.compilerManager.textureCompiler.getResource(e,He),r.needsUpdate=!0};var jc=L({configType:d.CUBETEXTURE,commands:{set:{cube:{px({target:r,value:t,engine:e}){Qe({target:r,value:t,engine:e,index:0})},nx({target:r,value:t,engine:e}){Qe({target:r,value:t,engine:e,index:1})},py({target:r,value:t,engine:e}){Qe({target:r,value:t,engine:e,index:2})},ny({target:r,value:t,engine:e}){Qe({target:r,value:t,engine:e,index:3})},pz({target:r,value:t,engine:e}){Qe({target:r,value:t,engine:e,index:4})},nz({target:r,value:t,engine:e}){Qe({target:r,value:t,engine:e,index:5})}}}},create(r,t){const e=new l.CubeTexture,n=r.cube,o=t.compilerManager.textureCompiler,s=[o.getResource(n.px,He),o.getResource(n.nx,He),o.getResource(n.py,He),o.getResource(n.ny,He),o.getResource(n.pz,He),o.getResource(n.nz,He)];return e.image=s,W(r,e,{type:!0,cube:!0}),e.needsUpdate=!0,e},dispose(r){r.dispose()}});class Ic extends l.Texture{constructor(e,n,o,s,i,a,u,h,p){super(e,n,o,s,i,a,u,h,p);c(this,"isVideoTexture",!0);this.format=u!==void 0?u:l.RGBFormat,this.minFilter=a!==void 0?a:l.LinearFilter,this.magFilter=i!==void 0?i:l.LinearFilter,this.generateMipmaps=!1}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image,n="requestVideoFrameCallback"in e;n?this.needsUpdate=!0:n===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}var Gc=L({configType:d.VIDEOTEXTURE,commands:{set:{url:Ye,$reg:[Bt]}},create(r,t){const e=new Ic(document.createElement("video"));return r.url&&Ye({target:e,value:r.url,engine:t}),W(r,e,{type:!0,url:!0}),e.needsUpdate=!0,e},dispose(r){r.dispose()}});class Xe{constructor(t){c(this,"canvas");this.canvas=document.createElement("canvas");const e=window.devicePixelRatio;this.canvas.width=((t==null?void 0:t.width)||512)*e,this.canvas.height=((t==null?void 0:t.height)||512)*e,this.canvas.style.backgroundColor=(t==null?void 0:t.bgColor)||"rgb(255, 255, 255)";const n=this.canvas.getContext("2d");n&&n.scale(window.devicePixelRatio,window.devicePixelRatio)}get(){return this.canvas}getDom(){return this.canvas}clear(t=0,e=0,n,o){!n&&(n=this.canvas.width),!o&&(o=this.canvas.height);const s=this.canvas.getContext("2d");return s?(s.clearRect(t,e,n,o),this):(console.warn("you browser can not support canvas 2d"),this)}draw(t){const e=this.canvas.getContext("2d");return e?(t(e),this):(console.warn("you browser can not support canvas 2d"),this)}preview(t){const e=this.canvas;return e.style.position="fixed",e.style.top=(t==null?void 0:t.top)||"5%",e.style.left=(t==null?void 0:t.left)||"5%",e.style.right=(t==null?void 0:t.right)||"unset",e.style.bottom=(t==null?void 0:t.bottom)||"unset",t!=null&&t.scale&&(e.style.transform=`scale(${t.scale})`),document.body.appendChild(this.canvas),this}}class Dn extends l.Texture{constructor(t){super(),Object.keys(t).forEach(e=>{this[e]=t[e]}),this.copy(t)}}var Bc=L({configType:d.LOADTEXTURE,commands:{set:{url({}){},$reg:[Bt]}},create(r,t){let e;const n=t.compilerManager.textureCompiler.getResource(r.url,l.Texture);if(n instanceof l.Texture)e=new Dn(n);else{const o=new l.Texture(n);e=new Dn(o)}return W(r,e,{type:!0,url:!0}),e.needsUpdate=!0,e},dispose(r){r.dispose()}});const at=class extends M{constructor(){super();c(this,"MODULE",y.TEXTURE)}getResource(e,n){const o=this.engine.resourceManager.resourceMap;if(!o.has(e))return console.warn(`engine resourceManager can not found this url: ${e}`),at.replaceImage;const s=o.get(e);if(Array.isArray(n)){for(const i of n)if(s instanceof i)return s;return console.warn(`this url mapping resource is not a texture image class: ${e}`,s),at.replaceImage}else return s instanceof n?s:(console.warn(`this url mapping resource is not a texture image class: ${e}`,s),at.replaceImage)}};let nt=at;c(nt,"replaceImage",new Xe({width:512,height:512}).draw(e=>{e.translate(256,256),e.font="72px",e.fillStyle="white",e.fillText("\u6682\u65E0\u56FE\u7247",0,0)}).getDom()),M.processor(Dc),M.processor(Pc),M.processor(jc),M.processor(Gc),M.processor(Bc);class Uc extends te{constructor(e){super();c(this,"object3DCompiler",new gc);c(this,"cameraCompiler",new ma);c(this,"lightCompiler",new Ka);c(this,"geometryCompiler",new ka);c(this,"textureCompiler",new nt);c(this,"materialCompiler",new pc);c(this,"rendererCompiler",new Cc);c(this,"sceneCompiler",new xc);c(this,"controlsCompiler",new Ea);c(this,"spriteCompiler",new Lc);c(this,"lineCompiler",new qa);c(this,"meshCompiler",new fc);c(this,"pointsCompiler",new vc);c(this,"groupCompiler",new Va);c(this,"css3DCompiler",new Ta);c(this,"passCompiler",new bc);c(this,"animationCompiler",new Oi);c(this,"compilerMap");e&&Object.keys(e).forEach(o=>{this[o]=e[o]});const n=new Map;Object.keys(this).forEach(o=>{const s=this[o];s instanceof M&&n.set(s.MODULE,s)}),this.compilerMap=n}wait(e,n){}support(e){this.compilerMap.forEach(o=>{o.useEngine(e)});const n=e.dataSupportManager;for(const o of Object.values(y))n[`${o}DataSupport`].addCompiler(this[`${o}Compiler`]);return this}getObjectSymbol(e){for(const n of this.compilerMap.values()){const o=n.getObjectSymbol(e);if(o)return o}return null}getObjectBySymbol(e){for(const n of this.compilerMap.values()){const o=n.getObjectBySymbol(e);if(o)return o}return null}getObject3D(e){for(const n of this.compilerMap.values())if(n instanceof Me&&n.map.has(e))return n.map.get(e);return null}getGeometry(e){return this.geometryCompiler.map.get(e)||null}getMaterial(e){return this.materialCompiler.map.get(e)||null}getTexture(e){return this.textureCompiler.map.get(e)||null}dispose(){for(const e of this.compilerMap.values())e.dispose();return this.compilerMap.clear(),this}}const Hc=function(r){if(this.compilerManager)return console.warn("engine has installed compilerManager plugin."),!1;if(!this.dataSupportManager)return console.warn("must install dataSupportManager before compilerManager plugin."),!1;if(!this.renderManager)return console.warn("must install renderManager before compilerManager plugin."),!1;const t=new Uc;return this.compilerManager=t,this.getObjectSymbol=function(e){return this.compilerManager.getObjectSymbol(e)},this.getObjectBySymbol=function(e){return this.compilerManager.getObjectBySymbol(e)},this.addEventListener("dispose",()=>{this.compilerManager.dispose()}),this.completeSet.add(()=>{this.compilerManager.support(this)}),!0};class Pn extends te{constructor(){super();c(this,"map",new Map)}generateSymbol(e){return Array.isArray(e)?e.join(" + "):e.shortcutKey.join(" + ")}watch(e){return e?ct.default.watch(void 0,e):ct.default.watch(),this}register(e){const n=this.generateSymbol(e);return this.map.has(n)?(console.warn(`KeyboardManager: shortcutKey already exist: ${n}. desp: ${this.map.get(n).desp}`),this):(ct.default.bind(n,e.keydown||null,e.keyup),this.map.set(n,e),this)}update(e){const n=this.generateSymbol(e);return this.map.has(n)?(this.cancel(e.shortcutKey),this.register(e),this):(console.warn("KeyboardManager: shortcutKey unregister then exec register function"),this.register(e),this)}cancel(e){const n=this.generateSymbol(e);if(this.map.has(n)){const o=this.map.get(n);ct.default.unbind(n,o.keydown||null,o.keyup),this.map.delete(n)}return this}checkRepeat(e){const n=this.generateSymbol(e);return this.map.has(n)}getDocs(){const e=[];return this.map.forEach(n=>{e.push({shortcutKey:[].concat(n.shortcutKey),desp:n.desp})}),e}}const Nc=function(r){if(this.keyboardManager)return console.warn("engine has installed keyboardManager plugin."),!1;const t=new Pn;return this.keyboardManager=t,this.completeSet.add(()=>{if(this.transformControls){const e=()=>this.dataSupportManager.controlsDataSupport.getData()[d.TRNASFORMCONTROLS]||this.transformControls;this.IS_ENGINESUPPORT?t.register({shortcutKey:["shift"],desp:"\u53D8\u6362\u63A7\u5236\u5668\u9501\u5B9A\u6B65\u5E45",keyup:n=>{n==null||n.preventDefault();const o=e();o&&(o.snapAllow=!1)},keydown:n=>{n==null||n.preventDefault(),n==null||n.preventRepeat();const o=e();o&&(o.snapAllow=!0)}}):t.register({shortcutKey:["shift"],desp:"\u53D8\u6362\u63A7\u5236\u5668\u9501\u5B9A\u6B65\u5E45",keyup:n=>{n==null||n.preventDefault();const o=e();o.translationSnap=null,o.rotationSnap=null,o.scaleSnap=null},keydown:n=>{n==null||n.preventDefault(),n==null||n.preventRepeat();const o=e();o.translationSnap=5,o.rotationSnap=Math.PI/180*10,o.scaleSnap=.1}}),t.register({shortcutKey:["r"],desp:"\u53D8\u6362\u63A7\u5236\u5668\u6A21\u5F0F\uFF1A\u65CB\u8F6C",keyup:n=>{n==null||n.preventDefault();const o=e();o&&(o.mode="rotate")}}).register({shortcutKey:["t"],desp:"\u53D8\u6362\u63A7\u5236\u5668\u6A21\u5F0F\uFF1A\u79FB\u52A8",keyup:n=>{n==null||n.preventDefault();const o=e();o&&(o.mode="translate")}}).register({shortcutKey:["e"],desp:"\u53D8\u6362\u63A7\u5236\u5668\u6A21\u5F0F\uFF1A\u7F29\u653E",keyup:n=>{n==null||n.preventDefault();const o=e();o.mode="scale"}}).register({shortcutKey:["x"],desp:"\u53D8\u6362\u63A7\u5236\u5668\u5207\u6362\u8F74\uFF1Ax",keyup:n=>{n==null||n.preventDefault();const o=e();o.showX=!o.showX}}).register({shortcutKey:["y"],desp:"\u53D8\u6362\u63A7\u5236\u5668\u5207\u6362\u8F74\uFF1Ay",keyup:n=>{if(n==null||n.preventDefault(),n!=null&&n.ctrlKey)return;const o=e();o.showY=!o.showY}}).register({shortcutKey:["z"],desp:"\u53D8\u6362\u63A7\u5236\u5668\u5207\u6362\u8F74\uFF1Az",keyup:n=>{if(n==null||n.preventDefault(),n!=null&&n.ctrlKey)return;const o=e();o.showZ=!o.showZ}}).register({shortcutKey:["space"],desp:"\u53D8\u6362\u63A7\u5236\u5668\u5207\u6362\u53D8\u6362\u7A7A\u95F4",keyup:n=>{n==null||n.preventDefault();const o=e();o.space=o.space==="local"?"world":"local"}})}}),!0},zc=function(r={}){if(!this.scene)return console.error("must install some scene plugin before BasicViewpoint plugin."),!1;const t=new l.AxesHelper(r.length||500);return t.matrixAutoUpdate=!1,t.raycast=()=>{},this.scene.add(t),this.setAxesHelper=function(e){return e.show?this.scene.add(t):this.scene.remove(t),this},this.addEventListener("setScene",e=>{e.scene.add(t)}),!0},Fc=function(r={}){if(!this.scene)return console.error("must install some scene before BasicViewpoint plugin."),!1;const t=new l.GridHelper(r.range||500,r.spacing||50,r.axesColor||"rgb(130, 130, 130)",r.cellColor||"rgb(70, 70, 70)");if(r.opacity!==1){const e=t.material;e.transparent=!0,e.opacity=r.opacity||.5,e.needsUpdate=!0}return t.matrixAutoUpdate=!1,t.raycast=()=>{},this.scene.add(t),this.setGridHelper=function(e){return e.show?this.scene.add(t):this.scene.remove(t),this},this.addEventListener("setScene",e=>{e.scene.add(t)}),this.completeSet.add(()=>{this.setViewpoint&&this.addEventListener("setViewpoint",e=>{const n=e.viewpoint;n===V.DEFAULT||n===V.TOP||n===V.BOTTOM?t.rotation.set(0,0,0):n===V.RIGHT||n===V.LEFT?t.rotation.set(0,0,Math.PI/2):(n===V.FRONT||n===V.BACK)&&t.rotation.set(Math.PI/2,0,0),t.updateMatrix(),t.updateMatrixWorld()})}),!0};var jn=(r=>(r.GEOMETRY="geometry",r.MATERIAL="material",r.LIGHT="light",r.ENV="env",r))(jn||{});const kc=function(r={}){if(!this.webGLRenderer)return console.error("must install some renderer before DisplayModel plugin."),!1;if(!this.scene)return console.error("must install some scene before DisplayModel plugin."),!1;!r.overrideColor&&(r.overrideColor="rgb(250, 250, 250)"),!r.defaultAmbientLightSetting&&(r.defaultAmbientLightSetting={}),!r.defaultAmbientLightSetting.color&&(r.defaultAmbientLightSetting.color="rgb(255, 255, 255)"),!r.defaultAmbientLightSetting.intensity&&(r.defaultAmbientLightSetting.intensity=.5);const t=new l.AmbientLight(r.defaultAmbientLightSetting.color,r.defaultAmbientLightSetting.intensity);t.matrixAutoUpdate=!1,!r.defaultDirectionalLightSetting&&(r.defaultDirectionalLightSetting={}),!r.defaultDirectionalLightSetting.color&&(r.defaultDirectionalLightSetting.color="rgb(255, 255, 255)"),!r.defaultDirectionalLightSetting.intensity&&(r.defaultDirectionalLightSetting.intensity=.5),!r.defaultDirectionalLightSetting.position&&(r.defaultDirectionalLightSetting.position={x:-100,y:100,z:100});const e=new l.DirectionalLight(r.defaultDirectionalLightSetting.color,r.defaultDirectionalLightSetting.intensity);e.castShadow=!1,e.position.set(r.defaultDirectionalLightSetting.position.x,r.defaultDirectionalLightSetting.position.y,r.defaultDirectionalLightSetting.position.z),e.updateMatrix(),e.updateMatrixWorld(),e.matrixAutoUpdate=!1,!r.mode&&(r.mode="env"),this.displayMode=r.mode;const n=new l.MeshLambertMaterial({color:r.overrideColor}),o=new l.LineBasicMaterial({color:r.overrideColor}),s=new l.PointsMaterial({color:r.overrideColor,size:5,sizeAttenuation:!1}),i=new l.SpriteMaterial({color:r.overrideColor}),a=new WeakMap,u=new Set,h=new Set,p=new Set,m=new Set,T=new Set;let b,v;const S={Object3D:!0,Group:!0};this.scene.addEventListener("afterAdd",E=>{const q=this.displayMode,P=E.objects;for(const A of P)if(!S[A.type])if(A instanceof l.Mesh&&A.type==="Mesh")h.add(A),q==="geometry"&&(a.set(A,A.material),A.material=n);else if(A instanceof l.Line&&A.type.includes("Line"))p.add(A),q==="geometry"&&(a.set(A,A.material),A.material=o);else if(A instanceof l.Light&&A.type.includes("Light")){if(A===t||A===e)continue;u.has(A)||u.add(A),q!=="env"&&q!=="light"&&this.scene.remove(A)}else A instanceof l.Points&&A.type==="Points"?(m.add(A),q==="geometry"&&(a.set(A,A.material),A.material=s)):A instanceof l.Sprite&&A.type==="Sprite"&&(T.add(A),q==="geometry"&&(a.set(A,A.material),A.material=i))}),this.scene.addEventListener("afterRemove",E=>{const q=E.objects;for(const P of q)if(!S[P.type])if(P instanceof l.Mesh&&P.type==="Mesh")h.delete(P),a.has(P)&&a.delete(P);else if(P instanceof l.Line&&P.type.includes("Line"))p.delete(P),a.has(P)&&a.delete(P);else if(P instanceof l.Light&&P.type.includes("Light")){if(P===t||P===e)continue;u.delete(P)}else P instanceof l.Points&&P.type==="Points"?(m.delete(P),a.has(P)&&a.delete(P)):P instanceof l.Sprite&&P.type==="Sprite"&&(T.delete(P),a.has(P)&&a.delete(P))});const R=()=>{for(const E of h)E.material!==n&&(a.set(E,E.material),E.material=n);for(const E of p)E.material!==o&&(a.set(E,E.material),E.material=o);for(const E of m)E.material!==s&&(a.set(E,E.material),E.material=s);for(const E of T)E.material!==i&&(a.set(E,E.material),E.material=i)},w=()=>{h.forEach(E=>{a.has(E)&&(E.material=a.get(E),a.delete(E))}),p.forEach(E=>{a.has(E)&&(E.material=a.get(E),a.delete(E))}),m.forEach(E=>{a.has(E)&&(E.material=a.get(E),a.delete(E))}),T.forEach(E=>{a.has(E)&&(E.material=a.get(E),a.delete(E))})},D=()=>{u.forEach(E=>{E.visible=!1}),this.scene.add(t),this.scene.add(e)},j=()=>{u.forEach(E=>{E.visible=!0}),this.scene.remove(t),this.scene.remove(e)},$=()=>{this.scene.background instanceof l.Texture&&(b=this.scene.background,this.scene.background=null),this.scene.environment instanceof l.Texture&&(v=this.scene.environment,this.scene.environment=null)},O=()=>{b&&(this.scene.background=b,b=void 0),v&&(this.scene.environment=v,v=void 0)};return this.setDisplayMode=function(E){return this.displayMode=E||"env",E==="geometry"?(R(),$(),D()):E==="material"?(w(),$(),D()):E==="light"?(w(),$(),j()):E==="env"?(w(),O(),j()):console.warn(`displayMode plugin can not set this mode: ${E}`),this},this.completeSet.add(()=>{this.objectHelperManager&&this.objectHelperManager.addFilteredObject(e)}),!0},Re=()=>new l.LineBasicMaterial({color:"rgb(255, 255, 255)"});class gr extends l.LineSegments{constructor(e){super();c(this,"shape");c(this,"target");c(this,"type","CameraHelper");c(this,"cachaData");const n=new l.BufferGeometry,o=[0,0,0,-1,1,-1,0,0,0,-1,1,1,0,0,0,-1,-1,-1,0,0,0,-1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,1,-1,-1,1,1,-1,1,1,-1,-1,1,0,0,0,0,1,1,0,0,0,0,1,-1,0,0,0,0,-1,-1,0,0,0,0,-1,1,0,1,1,0,1,-1,0,1,-1,0,-1,-1,0,-1,-1,0,-1,1,0,-1,1,0,1,1,0,-1,1,2,-1,1,0,1,-1,2,1,-1,0,-1,-1,2,-1,-1,0,1,1,2,1,1,2,1,1,2,-1,1,2,-1,1,2,-1,-1,2,-1,-1,2,1,-1,2,1,-1,2,1,1];n.setAttribute("position",new l.Float32BufferAttribute(o,3)),n.rotateY(-90*Math.PI/180),n.computeBoundingBox();const s=new l.CameraHelper(e);s.matrix=new l.Matrix4,s.matrixAutoUpdate=!0,s.raycast=()=>{},this.add(s),this.shape=s,this.geometry=n,this.material=Re(),this.target=e,this.matrixAutoUpdate=!1,this.matrix=e.matrix,e instanceof l.PerspectiveCamera?this.cachaData={fov:e.fov,aspect:e.aspect,near:e.near,far:e.far}:e instanceof l.OrthographicCamera?this.cachaData={left:e.left,right:e.right,top:e.top,bottom:e.bottom,near:e.near,far:e.far}:this.cachaData={},this.onBeforeRender=()=>{let i=!1;const a=this.cachaData;Object.keys(a).forEach(u=>{a[u]!==e[u]&&(a[u]=e[u],i=!0)}),i&&this.shape.update()}}raycast(e,n){const o=this.matrixWorld,s=this.geometry.boundingBox.clone();if(s.applyMatrix4(o),e.ray.intersectsBox(s)){const i=this.target;n.push({distance:e.ray.origin.distanceTo(i.position),object:i,point:i.position})}}}class In extends l.LineSegments{constructor(e){super();c(this,"sphere");c(this,"target");c(this,"shape");c(this,"type","VisDirectionalLightHelper");c(this,"cacheColor");c(this,"cacheVector3");this.geometry=new l.BufferGeometry;const n=[-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1,0,0,1,-.707,-.707,0,.707,.707,0,.707,-.707,0,-.707,.707,0,0,-.707,-.707,0,.707,.707,0,.707,-.707,0,-.707,.707,-.707,0,-.707,.707,0,.707,.707,0,-.707,-.707,0,.707];this.geometry.setAttribute("position",new l.Float32BufferAttribute(n,3)),this.material=Re(),this.geometry.boundingSphere;const o=new l.Color().copy(e.color).multiplyScalar(e.intensity),s=new l.PlaneBufferGeometry(20,20);s.dispose();const i=new l.LineSegments(new l.EdgesGeometry(s),new l.LineBasicMaterial({color:o}));i.raycast=()=>{},this.shape=i,this.target=e,this.sphere=new l.Sphere(new l.Vector3(0,0,0),1),this.cacheColor=e.color.getHex(),this.cacheVector3=new l.Vector3,this.add(this.shape),this.matrixAutoUpdate=!1,this.matrix=e.matrix,this.matrixWorldNeedsUpdate=!1,this.matrixWorld=e.matrixWorld,this.onBeforeRender=()=>{const a=this.target,u=this.shape;a.color.getHex()!==this.cacheColor&&(u.material.color.copy(a.color).multiplyScalar(a.intensity),this.cacheColor=a.color.getHex()),u.lookAt(a.target.position)}}raycast(e,n){const o=this.target,s=o.matrixWorld,i=this.sphere;i.set(this.cacheVector3.set(0,0,0),1),i.applyMatrix4(s),e.ray.intersectsSphere(i)&&n.push({distance:e.ray.origin.distanceTo(o.position),object:o,point:o.position})}}class Gn extends l.LineSegments{constructor(e){super();c(this,"sphere");c(this,"target");c(this,"shape");c(this,"type","VisPointLightHelper");c(this,"cacheColor");c(this,"cacheDistance");c(this,"cacheVector3");this.geometry=new l.BufferGeometry;const n=[-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1,0,0,1,-.707,-.707,0,.707,.707,0,.707,-.707,0,-.707,.707,0,0,-.707,-.707,0,.707,.707,0,.707,-.707,0,-.707,.707,-.707,0,-.707,.707,0,.707,.707,0,-.707,-.707,0,.707];this.geometry.setAttribute("position",new l.Float32BufferAttribute(n,3)),this.material=Re(),this.geometry.boundingSphere;const o=new l.Color().copy(e.color).multiplyScalar(e.intensity),s=new l.Mesh(new l.OctahedronBufferGeometry(e.distance,0),new l.MeshBasicMaterial({color:o,wireframe:!0}));s.raycast=()=>{},s.matrixAutoUpdate=!1,this.shape=s,this.target=e,this.sphere=new l.Sphere(new l.Vector3(0,0,0),1),this.cacheColor=e.color.getHex(),this.cacheDistance=e.distance,this.cacheVector3=new l.Vector3,this.add(this.shape),this.matrixAutoUpdate=!1,this.matrix=e.matrix,this.matrixWorldNeedsUpdate=!1,this.matrixWorld=e.matrixWorld,this.onBeforeRender=()=>{const i=this.target,a=this.shape;i.distance!==this.cacheDistance&&(a.geometry.dispose(),a.geometry=new l.OctahedronBufferGeometry(i.distance,0),this.cacheDistance=i.distance),i.color.getHex()!==this.cacheColor&&(a.material.color.copy(i.color).multiplyScalar(i.intensity),this.cacheColor=i.color.getHex())}}raycast(e,n){const o=this.target,s=o.matrixWorld,i=this.sphere;i.set(this.cacheVector3.set(0,0,0),1),i.applyMatrix4(s),e.ray.intersectsSphere(i)&&n.push({distance:e.ray.origin.distanceTo(o.position),object:o,point:o.position})}}class Bn extends l.LineSegments{constructor(e){super();c(this,"sphere");c(this,"target");c(this,"shape");c(this,"type","VisSpotLightHelper");c(this,"cacheVector3");c(this,"cacheColor");c(this,"cacheAngle");c(this,"cacheDistance");this.geometry=new l.BufferGeometry;const n=[-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1,0,0,1,-.707,-.707,0,.707,.707,0,.707,-.707,0,-.707,.707,0,0,-.707,-.707,0,.707,.707,0,.707,-.707,0,-.707,.707,-.707,0,-.707,.707,0,.707,.707,0,-.707,-.707,0,.707];this.geometry.setAttribute("position",new l.Float32BufferAttribute(n,3)),this.material=Re(),this.geometry.boundingSphere;const o=new l.BufferGeometry,s=[0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let p=0,m=1,T=32;p<T;p++,m++){const b=p/T*Math.PI*2,v=m/T*Math.PI*2;s.push(Math.cos(b),Math.sin(b),1,Math.cos(v),Math.sin(v),1)}o.setAttribute("position",new l.Float32BufferAttribute(s,3));const i=Re(),a=new l.LineSegments(o,i);a.material.color.copy(e.color).multiplyScalar(e.intensity);const u=e.distance?e.distance:1e3,h=u*Math.tan(e.angle);a.scale.set(h,h,u),a.raycast=()=>{},this.add(a),this.matrixAutoUpdate=!1,this.matrix=e.matrix,this.matrixWorldNeedsUpdate=!1,this.matrixWorld=e.matrixWorld,this.target=e,this.shape=a,this.sphere=new l.Sphere(new l.Vector3(0,0,0),1),this.cacheColor=e.color.getHex(),this.cacheDistance=e.distance,this.cacheAngle=e.angle,this.cacheVector3=new l.Vector3,this.onBeforeRender=()=>{const p=this.target,m=this.shape;let T=!1;if(p.distance!==this.cacheDistance&&(this.cacheDistance=p.distance,m.scale.z=p.distance,T=!0),p.angle!==this.cacheAngle&&(this.cacheAngle=p.angle,T=!0),T){const b=p.distance*Math.tan(p.angle);m.scale.set(b,b,p.distance)}p.color.getHex()!==this.cacheColor&&(m.material.color.copy(p.color).multiplyScalar(p.intensity),this.cacheColor=p.color.getHex()),m.lookAt(p.target.position)}}raycast(e,n){const o=this.target,s=o.matrixWorld,i=this.sphere;i.set(this.cacheVector3.set(0,0,0),1),i.applyMatrix4(s),e.ray.intersectsSphere(i)&&n.push({distance:e.ray.origin.distanceTo(o.position),object:o,point:o.position})}}class $c extends l.LineSegments{constructor(e){super();c(this,"target");c(this,"type","VisCSS3DHelper");const o=e.element.getBoundingClientRect(),s=o.width,i=o.height;this.geometry=new l.EdgesGeometry(new l.PlaneBufferGeometry(s,i)),this.geometry.computeBoundingBox(),this.material=Re(),this.matrixAutoUpdate=!1,this.matrix=e.matrix,this.matrixWorldNeedsUpdate=!1,this.matrixWorld=e.matrixWorld,this.target=e}raycast(e,n){const o=this.target,s=o.matrixWorld,i=this.geometry.boundingBox.clone();i.applyMatrix4(s),e.ray.intersectsBox(i)&&n.push({distance:e.ray.origin.distanceTo(o.position),object:o,point:o.position})}}class Un extends l.LineSegments{constructor(e){super();c(this,"target");c(this,"type","VisCSS3DPlaneHelper");c(this,"observer");this.geometry=new l.EdgesGeometry(new l.PlaneBufferGeometry(e.width,e.height)),this.geometry.computeBoundingBox(),this.material=Re(),this.matrixAutoUpdate=!1,this.matrix=e.matrix,this.matrixWorldNeedsUpdate=!1,this.matrixWorld=e.matrixWorld,this.target=e;const n=new MutationObserver(()=>{this.geometry.dispose(),this.geometry=new l.EdgesGeometry(new l.PlaneBufferGeometry(e.width,e.height)),this.geometry.computeBoundingBox()});n.observe(e.element,{attributeFilter:["style"]}),this.observer=n}dispose(){this.observer.disconnect()}}const Mr=class extends l.Sprite{constructor(e){super();c(this,"target");c(this,"type","VisGroupHelper");this.target=e,this.geometry.computeBoundingBox(),this.material=new l.SpriteMaterial({map:Mr.colorTexture}),this.material.depthTest=!1,this.material.depthWrite=!1,this.scale.set(5,5,5);const n=this.updateMatrixWorld.bind(this);this.updateMatrixWorld=o=>{const s=this.position,i=this.target.position;s.x=i.x,s.y=i.y,s.z=i.z,n(o)}}raycast(e,n){const o=this.matrixWorld,s=this.geometry.boundingBox.clone();if(s.applyMatrix4(o),e.ray.intersectsBox(s)){const i=this.target;n.push({distance:e.ray.origin.distanceTo(i.position),object:i,point:i.position})}}};let ot=Mr;c(ot,"colorTexture",new l.CanvasTexture(new Xe({width:512,height:512}).draw(e=>{e.beginPath(),e.fillStyle="rgba(0, 0, 0, 0)",e.fillRect(0,0,512,512),e.closePath(),e.translate(256,200),e.beginPath(),e.fillStyle="yellow",e.fillRect(-200,0,400,200),e.closePath(),e.beginPath(),e.fillStyle="yellow",e.fillRect(-200,-70,200,70),e.closePath()}).get()));const vr=class extends l.Points{constructor(e){super();c(this,"target");c(this,"cachaGeometryUUid");c(this,"type","VisLineHelper");this.target=e,this.geometry.dispose(),this.geometry.copy(e.geometry),this.cachaGeometryUUid=e.geometry.uuid,this.material=new l.PointsMaterial({color:"rgb(255, 255, 255)",alphaMap:vr.alphaTexture,transparent:!0,size:5,sizeAttenuation:!1}),this.matrixAutoUpdate=!1,this.matrixWorldNeedsUpdate=!1,this.matrix=e.matrix,this.matrixWorld=e.matrixWorld,this.renderOrder=-1,this.raycast=()=>{},this.onBeforeRender=()=>{const n=this.target;n.geometry.uuid!==this.cachaGeometryUUid&&(this.geometry.dispose(),this.geometry=n.geometry.clone(),this.cachaGeometryUUid=n.geometry.uuid)}}};let Ut=vr;c(Ut,"alphaTexture",new l.CanvasTexture(new Xe({width:512,height:512,bgColor:"rgb(0, 0, 0)"}).draw(e=>{e.beginPath(),e.fillStyle="rgb(255, 255, 255)",e.arc(256,256,200,0,Math.PI*2),e.fill(),e.closePath()}).getDom()));class Vc extends l.LineSegments{constructor(e){super();c(this,"target");c(this,"type","VisMeshHelper");c(this,"cachaGeometryUUid");const n=1;this.target=e,this.geometry=new l.EdgesGeometry(e.geometry,n),this.cachaGeometryUUid=e.geometry.uuid,this.material=Re(),this.raycast=()=>{},this.matrixAutoUpdate=!1,this.matrixWorldNeedsUpdate=!1,this.matrix=e.matrix,this.matrixWorld=e.matrixWorld,this.onBeforeRender=()=>{const o=this.target;o.geometry.uuid!==this.cachaGeometryUUid&&(this.geometry.dispose(),this.geometry=new l.EdgesGeometry(o.geometry,n),this.cachaGeometryUUid=o.geometry.uuid)}}}const wr=class extends l.Points{constructor(e){super();c(this,"target");c(this,"type","VisPointsHelper");this.target=e,this.geometry.dispose(),this.geometry.copy(e.geometry),this.material.dispose(),this.material=new l.PointsMaterial({color:"rgb(255, 255, 255)",alphaMap:wr.alphaTexture,transparent:!0});const n=Array.isArray(e.material)?e.material[0]:e.material;n instanceof l.PointsMaterial&&(this.material.size=n.size,this.material.sizeAttenuation=n.sizeAttenuation),this.matrixAutoUpdate=!1,this.matrixWorldNeedsUpdate=!1,this.matrix=e.matrix,this.matrixWorld=e.matrixWorld,this.raycast=()=>{}}};let Ht=wr;c(Ht,"alphaTexture",new l.CanvasTexture(new Xe({width:512,height:512,bgColor:"rgb(0, 0, 0)"}).draw(e=>{e.beginPath(),e.strokeStyle="rgb(255, 255, 255)",e.lineWidth=4,e.strokeRect(0,0,512,512),e.closePath()}).get()));const Tr=class extends l.Sprite{constructor(e){super();c(this,"target");c(this,"type","VisSpriteHelper");this.target=e,this.material.dispose(),this.material=new l.SpriteMaterial({color:"rgb(255, 255, 255)",alphaMap:Tr.alphaTexture,transparent:!0,depthWrite:!1}),this.matrixAutoUpdate=!1,this.matrixWorldNeedsUpdate=!1,this.matrix=e.matrix,this.matrixWorld=e.matrixWorld,this.raycast=()=>{}}};let Nt=Tr;c(Nt,"alphaTexture",new l.CanvasTexture(new Xe({width:512,height:512,bgColor:"rgb(0, 0, 0)"}).draw(e=>{e.beginPath(),e.strokeStyle="rgb(255, 255, 255)",e.lineWidth=4,e.strokeRect(0,0,512,512),e.closePath()}).get()));class Wc extends te{constructor(e={}){super();c(this,"helperGenerator",{[d.POINTLIGHT]:Gn,[d.SPOTLIGHT]:Bn,[d.DIRECTIONALLIGHT]:In,[d.PERSPECTIVECAMERA]:gr,[d.ORTHOGRAPHICCAMERA]:gr,[d.MESH]:Vc,[d.GROUP]:ot,[d.SPRITE]:Nt,[d.POINTS]:Ht,[d.LINE]:Ut,[d.CSS3DOBJECT]:$c,[d.CSS3DPLANE]:Un,[d.CSS3DSPRITE]:Un});c(this,"helperFilter",{AmbientLight:!0,Object3D:!0,TransformControls:!0,Scene:!0});c(this,"objectFilter",new Set);c(this,"objectHelperMap",new Map);e.helperGenerator&&(this.helperGenerator=Object.assign(this.helperGenerator,e.helperGenerator)),e.helperFilter&&(this.helperFilter=Object.assign(this.helperFilter,e.helperFilter)),e.objectFilter&&(this.objectFilter=new Set(e.objectFilter.concat(Array.from(this.objectFilter))))}addFilteredObject(...e){for(const n of e)this.objectFilter.add(n);return this}addObjectHelper(e){if(this.objectFilter.has(e)||this.objectHelperMap.has(e)||this.helperFilter[e.type]||e.type.toLocaleLowerCase().includes("helper"))return null;if(!this.helperGenerator[e.type])return console.warn(`object helper can not support this type object: '${e.type}'`),null;const n=new this.helperGenerator[e.type](e);return this.objectHelperMap.set(e,n),n}disposeObjectHelper(e){if(this.objectFilter.has(e)||this.helperFilter[e.type]||e.type.toLocaleLowerCase().includes("helper"))return null;if(!this.objectHelperMap.has(e))return console.warn("object helper manager can not found this object`s helper: ",e),null;const n=this.objectHelperMap.get(e);return n.geometry&&n.geometry.dispose(),n.material&&(n.material instanceof l.Material?n.material.dispose():n.material.forEach(o=>{o.dispose()})),this.objectHelperMap.delete(e),n}}const _c=function(r={}){if(!this.scene)return console.error("must install some scene plugin before ObjectHelper plugin."),!1;r.interact===void 0&&(r.interact=!0),r.interact&&(this.eventManager||(console.warn("must install eventManager plugin that can use interact function."),r.interact=!1));const t=new Wc,e=new Map,n=new Map,o=new Map,s=t.objectHelperMap;this.objectHelperManager=t,!r.activeColor&&(r.activeColor="rgb(230, 20, 240)"),!r.hoverColor&&(r.hoverColor="rgb(255, 158, 240)"),!r.defaultColor&&(r.defaultColor="rgb(255, 255, 255)"),!r.selectedColor&&(r.selectedColor=r.activeColor);const i=new l.Color(r.defaultColor).getHex(),a=new l.Color(r.activeColor).getHex(),u=new l.Color(r.hoverColor).getHex(),h=new l.Color(r.selectedColor).getHex(),p=new WeakSet,m=S=>{const R=S.objects;for(const w of R){const D=t.addObjectHelper(w);if(!!D&&(D.material.color.setHex(i),this.scene.add(D),r.interact)){const j=()=>{var E;(E=this.transformControls)!=null&&E.dragging||this.selectionBox&&this.selectionBox.has(w)||D.material.color.setHex(u)},$=()=>{var E;(E=this.transformControls)!=null&&E.dragging||this.selectionBox&&this.selectionBox.has(w)||D.material.color.setHex(i)},O=()=>{var E;(E=this.transformControls)!=null&&E.dragging||this.selectionBox&&this.selectionBox.has(w)||D.material.color.setHex(a)};w.addEventListener("pointerenter",j),w.addEventListener("pointerleave",$),w.addEventListener("click",O),e.set(w,j),n.set(w,$),o.set(w,O)}}},T=S=>{const R=S.objects;for(const w of R){const D=t.disposeObjectHelper(w);!D||(this.scene.remove(D),r.interact&&(w.removeEventListener("pointerenter",e.get(w)),w.removeEventListener("pointerleave",n.get(w)),w.removeEventListener("click",o.get(w)),e.delete(w),n.delete(w),o.delete(w)))}},b=S=>{p.has(S)||(S.traverse(R=>{const w=t.addObjectHelper(R);w&&S.add(w)}),p.add(S))};this.scene.addEventListener("afterAdd",m),this.scene.addEventListener("afterRemove",T),this.setObjectHelper=function(S){return S.show?this.scene.traverse(R=>{s.has(R)&&this.scene.add(s.get(R))}):this.scene.traverse(R=>{s.has(R)&&this.scene.remove(s.get(R))}),this},this.addEventListener("setScene",S=>{const R=S.scene;!p.has(R)&&b(R),R.hasEventListener("afterAdd",m)||R.addEventListener("afterAdd",m),R.hasEventListener("afterRemove",T)||R.addEventListener("afterRemove",T)});const v=new Set;return this.completeSet.add(()=>{this.selectionBox&&this.addEventListener("selected",S=>{v.forEach(R=>{R.material.color.setHex(i)}),v.clear();for(const R of S.objects)if(s.has(R)){const w=s.get(R);w.material.color.setHex(h),v.add(w)}})}),!0},Yc=function(r={}){if(this.selectionBox)return console.warn("engine has installed selection plugin."),!1;if(!this.eventManager)return console.warn("must install eventManager plugin before Selection plugin."),!1;this.selectionBox=new Set;const t=()=>{const e=[];this.IS_ENGINESUPPORT&&this.selectionBox.forEach(n=>{const o=this.compilerManager.getObjectSymbol(n);o?e.push(o):console.warn("selection plugin can not font vid in compilerManager.",n)}),this.dispatchEvent({type:"selected",objects:[...this.selectionBox],objectSymbols:e})};return this.setSelectionBox=function(e){this.selectionBox.clear();for(const n of e.objects)this.selectionBox.add(n);return t(),this},this.eventManager.addEventListener("click",e=>{var o,s,i;if(this.transing){this.transing=!1;return}const n=e.intersections;if(e.ctrlKey||this.selectionBox.clear(),this.eventManager.penetrate)for(const a of n){if(e.ctrlKey&&(o=this.selectionBox)!=null&&o.has(a.object)){this.selectionBox.delete(a.object);continue}this.selectionBox.add(a.object)}else if(n.length){const a=n[0].object;if(e.ctrlKey&&(s=this.selectionBox)!=null&&s.has(a)){this.selectionBox.delete(a);return}(i=this.selectionBox)==null||i.add(a)}t()}),!0},Qc=function(r={}){if(this.css3DRenderer)return console.warn("this has installed css3DRenderer plugin."),!1;this.css3DRenderer=new Ee.CSS3DRenderer;const t=this.css3DRenderer.domElement;if(t.classList.add("vis-css3D"),t.style.position="absolute",t.style.top="0",t.style.left="0",this.addEventListener("setDom",e=>{e.dom.appendChild(this.css3DRenderer.domElement)}),this.addEventListener("setSize",e=>{this.css3DRenderer.setSize(e.width,e.height)}),this.addEventListener("setScene",e=>{e.oldScene.traverse(o=>{o instanceof Ee.CSS3DObject&&(o.element.style.display="none")})}),this.renderManager)this.renderManager.removeEventListener("render",this.render),this.renderManager.addEventListener("render",e=>{this.css3DRenderer.render(this.scene,this.camera)});else if(this.webGLRenderer){const e=this.render.bind(this);this.render=function(){return e(),this.webGLRenderer.render(this.scene,this.camera),this}}else this.render=function(){return this.webGLRenderer.render(this.scene,this.camera),this};return!0};var x=(r=>(r.WEBGLRENDERER="WebGLRenderer",r.CSS3DRENDERER="CSS3DRenderer",r.SCENE="Scene",r.MODELINGSCENE="ModelingScene",r.RENDERMANAGER="RenderManager",r.ORBITCONTROLS="OrbitControls",r.STATS="Stats",r.EFFECTCOMPOSER="EffectComposer",r.POINTERMANAGER="PointerManager",r.EVENTMANAGER="EventManager",r.TRANSFORMCONTROLS="TransformControls",r.LOADERMANAGER="LoaderManager",r.RESOURCEMANAGER="ResourceManager",r.DATASUPPORTMANAGER="DataSupportManager",r.COMPILERMANAGER="CompilerManager",r.KEYBOARDMANAGER="KeyboardManager",r.AXESHELPER="AxesHelper",r.GRIDHELPER="GridHelper",r.VIEWPOINT="Viewpoint",r.DISPLAYMODE="DisplayMode",r.OBJECTHELPER="ObjectHelper",r.SELECTION="Selection",r))(x||{});const Oe=class extends te{constructor(){super();c(this,"completeSet");c(this,"camera",new l.PerspectiveCamera);c(this,"scene",new l.Scene);c(this,"IS_ENGINESUPPORT",!1);c(this,"dom");c(this,"webGLRenderer");c(this,"css3DRenderer");c(this,"orbitControls");c(this,"transformControls");c(this,"effectComposer");c(this,"renderManager");c(this,"pointerManager");c(this,"eventManager");c(this,"loaderManager");c(this,"resourceManager");c(this,"dataSupportManager");c(this,"compilerManager");c(this,"keyboardManager");c(this,"objectHelperManager");c(this,"transing");c(this,"stats");c(this,"displayMode");c(this,"selectionBox");c(this,"getScreenshot");c(this,"setStats");c(this,"setTransformControls");c(this,"setViewpoint");c(this,"setDisplayMode");c(this,"setAxesHelper");c(this,"setGridHelper");c(this,"setObjectHelper");c(this,"setSelectionBox");c(this,"loadResources");c(this,"loadResourcesAsync");c(this,"registerResources");c(this,"toJSON");c(this,"exportConfig");c(this,"applyConfig");c(this,"getConfigBySymbol");c(this,"removeConfigBySymbol");c(this,"getObjectSymbol");c(this,"getObjectBySymbol");c(this,"play");c(this,"stop");c(this,"render");this.completeSet=new Set,this.render=function(){return console.warn("can not install some plugin"),this},this.camera.position.set(50,50,50),this.addEventListener("setSize",e=>{this.camera.aspect=e.width/e.height,this.camera.updateProjectionMatrix()})}optimizeMemory(){Object.keys(this).forEach(e=>{this[e]===void 0&&delete this[e]})}install(e,n){return Oe.pluginHandler.has(e)?Oe.pluginHandler.get(e).call(this,n):console.error(`engine can not support ${e} plugin.`),this}complete(){return this.completeSet.forEach(e=>{e(this)}),this.completeSet.clear(),this}dispose(){return this.dispatchEvent({type:"dispose"}),this}setDom(e){return this.dom=e,this.dispatchEvent({type:"setDom",dom:e}),this}setSize(e,n){var o,s;return e&&e<=0||n&&n<=0?(console.warn(`you must be input width and height bigger then zero, width: ${e}, height: ${n}`),this):(!e&&(e=((o=this.dom)==null?void 0:o.offsetWidth)||window.innerWidth),!n&&(n=((s=this.dom)==null?void 0:s.offsetHeight)||window.innerHeight),this.dispatchEvent({type:"setSize",width:e,height:n}),this)}setCamera(e,n){if(typeof e=="object"&&e instanceof l.Camera)this.camera=e,this.dispatchEvent({type:"setCamera",camera:e,options:Object.assign({orbitControls:!0,transformControls:!0},n||{})});else if(this.IS_ENGINESUPPORT){const o=this.compilerManager.getObjectBySymbol(e);o?(this.camera=o,this.dispatchEvent({type:"setCamera",camera:o,options:Object.assign({orbitControls:!0,transformControls:!0},n||{})})):console.warn(`can not found camera in compilerManager: ${e}`)}else console.warn("engine is not a Engine support but use symbol to found camera.");return this}setScene(e){if(typeof e=="object"&&e instanceof l.Scene)this.dispatchEvent({type:"setScene",scene:e,oldScene:this.scene}),this.scene=e;else if(this.IS_ENGINESUPPORT){const n=this.compilerManager.getObjectBySymbol(e);n?(this.dispatchEvent({type:"setScene",scene:n,oldScene:this.scene}),this.scene=n):console.warn(`can not found scene in compilerManager: ${e}`)}else console.warn("engine is not a Engine support but use symbol to found scene.");return this}};let G=Oe;c(G,"pluginHandler",new Map),c(G,"register",function(e,n){return Oe.pluginHandler&&Oe.pluginHandler.set(e,n),Oe}),c(G,"dispose",function(){Oe.pluginHandler=void 0}),G.register("WebGLRenderer",Lo),G.register("CSS3DRenderer",Qc),G.register("EffectComposer",wo),G.register("RenderManager",Eo),G.register("PointerManager",Co),G.register("EventManager",xo),G.register("LoaderManager",Ao),G.register("ResourceManager",Hs),G.register("DataSupportManager",Mi),G.register("CompilerManager",Hc),G.register("KeyboardManager",Nc),G.register("OrbitControls",bo),G.register("TransformControls",Oo),G.register("AxesHelper",zc),G.register("GridHelper",Fc),G.register("ObjectHelper",_c),G.register("DisplayMode",kc),G.register("Viewpoint",So),G.register("Stats",vo),G.register("Selection",Yc);class Xc extends G{constructor(){super(),this.install(x.WEBGLRENDERER,{antialias:!0,alpha:!0}).install(x.RENDERMANAGER).install(x.EFFECTCOMPOSER,{WebGLMultisampleRenderTarget:!0}).install(x.ORBITCONTROLS).install(x.POINTERMANAGER).install(x.EVENTMANAGER).complete()}}class Kc extends G{constructor(){super(),this.install(x.RENDERMANAGER).install(x.WEBGLRENDERER,{antialias:!0,alpha:!0}).install(x.POINTERMANAGER).install(x.EVENTMANAGER).install(x.EFFECTCOMPOSER,{WebGLMultisampleRenderTarget:!0}).install(x.SELECTION).install(x.AXESHELPER).install(x.GRIDHELPER).install(x.OBJECTHELPER).install(x.VIEWPOINT).install(x.DISPLAYMODE).install(x.STATS).install(x.ORBITCONTROLS).install(x.KEYBOARDMANAGER).install(x.TRANSFORMCONTROLS).complete()}}const J=function(r,t,e=!0,n=!0){if(!F[r])return console.error(`type: ${r} can not be found in configList.`),{vid:"",type:r};const o=(a,u)=>{for(const h in u){if(a[h]===void 0){!e&&(a[h]=u[h]),e&&n&&console.warn(`'${r}' config can not set key: ${h}`);continue}typeof u[h]=="object"&&u[h]!==null&&!Array.isArray(u[h])?(a[h]===null&&(a[h]={...u[h]}),o(a[h],u[h])):a[h]=u[h]}},s=F[r]();if([d.SHADERMATERIAL].includes(r)){const a=Z.generateConfig((t==null?void 0:t.shader)||"defaultShader"),u=e;e=!1,o(s,a),e=u}[d.SCRIPTANIMATION,d.KEYFRAMEANIMATION].includes(r)&&(e=!1),s.vid===""&&(s.vid=ee.v4()),t&&o(s,t);const i=tn(s);if(J.autoInject&&J.injectEngine){const a=J.injectEngine;if(a.applyConfig(i),J.injectScene&&Ne(s.type).toLocaleUpperCase()in lt&&s.type!==d.SCENE){let u=null;typeof J.injectScene=="boolean"?u=a.getObjectConfig(a.scene):typeof J.injectScene=="string"&&(u=a.getConfigBySymbol(J.injectScene)),u?u.children.push(s.vid):console.warn("current engine scene can not found it config",a,a.scene)}return i}return i};J.autoInject=!0,J.injectScene=!1,J.injectEngine=null;class Jc{constructor(){c(this,"supportData");c(this,"supportDataType")}create(t){return t?(this.supportData={},this.supportDataType=t,this):(console.warn("you must give a module type in create params"),this)}add(t){return!this.supportData||!this.supportDataType?(console.warn("you must call 'create' method before the 'add' method"),this):t.type?Ne(t.type)!==this.supportDataType?(console.warn(`current generator create config which module is in: ${this.supportDataType}, but you provide type is '${t.type}'`),this):(this.supportData[t.vid]=J(t.type,t),this):(console.warn("config can not found attribute 'type'"),this)}get(){return this.supportDataType=void 0,this.supportData?this.supportData:{}}}const yr=new l.PointLight("rgb(255, 255, 255)",.5,200,1);yr.position.set(-30,5,20),yr.castShadow=!0;const zt=new l.Mesh(new l.BoxBufferGeometry(80,2,80),new l.MeshStandardMaterial({color:"rgb(255, 255, 255)"}));zt.position.set(0,-11,0),zt.receiveShadow=!0,zt.castShadow=!0;const ce=class{constructor(t){c(this,"material");c(this,"dom");c(this,"renderer");c(this,"scene");c(this,"camera");c(this,"object");const e=new l.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0});e.setPixelRatio(window.devicePixelRatio),e.setClearColor("rgb(150, 150, 150)"),e.shadowMap.enabled=!0,e.shadowMap.type=l.PCFSoftShadowMap;const n=new l.Scene,o=new l.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,500);o.position.set(0,0,35),o.up.x=0,o.up.y=1,o.up.z=0,o.lookAt(new l.Vector3(0,0,0)),n.add(ce.ambientLight),n.add(ce.pointLight),n.add(ce.plane),this.scene=n,this.renderer=e,this.camera=o,this.object=new l.Object3D,t!=null&&t.material&&this.setMaterial(t.material),t!=null&&t.dom&&this.setDom(t.dom)}setMaterial(t){if(this.scene.remove(this.object),this.material=t,t.type.includes("Mesh"))this.object=new l.Mesh(ce.geometry,t);else if(t.type.includes("Line"))this.object=new l.Line(ce.geometry,t);else if(t.type.includes("Ponits"))this.object=new l.Points(ce.geometry,t);else if(t.type.includes("Sprite"))this.object=new l.Sprite(t);else return console.warn(`material displayer can not support this type material: '${t.type}'`),this;return this.object.castShadow=!0,this.object.receiveShadow=!0,this.scene.add(this.object),this}setDom(t){return this.dom=t,this.setSize(),t.appendChild(this.renderer.domElement),this}setSize(t,e){if(t&&e)this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e,!0);else{if(!this.dom)return console.warn("material displayer must set dom before setSize with empty parameters"),this;const n=this.dom;this.camera.aspect=n.offsetWidth/n.offsetHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(n.offsetWidth,n.offsetHeight,!0)}return this}render(){this.renderer.render(this.scene,this.camera)}getDataURL(t){return this.renderer.domElement.toDataURL(t||"image/png")}dispose(){this.renderer.dispose()}};let xe=ce;c(xe,"ambientLight",new l.AmbientLight("rgb(255, 255, 255)",.7)),c(xe,"pointLight",yr),c(xe,"geometry",new l.SphereBufferGeometry(10,12,12)),c(xe,"plane",zt),c(xe,"dispose",()=>{ce.geometry.dispose(),ce.plane.geometry.dispose()});const Cr=class{constructor(t){c(this,"dom");c(this,"texture");c(this,"renderer");c(this,"scene");c(this,"camera");const e=new l.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0});e.setPixelRatio(window.devicePixelRatio),e.setClearColor("rgb(150, 150, 150)"),e.shadowMap.enabled=!0,e.shadowMap.type=l.PCFSoftShadowMap;const n=new l.Scene,o=new l.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,500);o.position.set(0,0,35),o.up.x=0,o.up.y=1,o.up.z=0,o.lookAt(new l.Vector3(0,0,0)),n.add(Cr.ambientLight),this.scene=n,this.renderer=e,this.camera=o,t!=null&&t.texture&&this.setTexture(t.texture),t!=null&&t.dom&&this.setDom(t.dom)}setTexture(t){return this.scene.background=t,this}setDom(t){return this.dom=t,this.setSize(),t.appendChild(this.renderer.domElement),this}setSize(t,e){if(t&&e)this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e,!0);else{if(!this.dom)return console.warn("texture displayer must set dom before setSize with empty parameters"),this;const n=this.dom;this.camera.aspect=n.offsetWidth/n.offsetHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(n.offsetWidth,n.offsetHeight,!0)}return this}render(){this.renderer.render(this.scene,this.camera)}getDataURL(t){return this.renderer.domElement.toDataURL(t||"image/png")}dispose(){this.renderer.dispose()}};let Ft=Cr;c(Ft,"ambientLight",new l.AmbientLight("rgb(255, 255, 255)",1));class Er extends G{constructor(e={},n={}){super();c(this,"IS_ENGINESUPPORT",!0);this.install(x.LOADERMANAGER).install(x.RESOURCEMANAGER,{resources:n}).install(x.POINTERMANAGER).install(x.EVENTMANAGER).install(x.RENDERMANAGER).install(x.DATASUPPORTMANAGER,e).install(x.COMPILERMANAGER)}loadLifeCycle(e){const n=this.dataSupportManager;e.texture&&n.load({texture:e.texture}),e.material&&n.load({material:e.material}),delete e.texture,delete e.material,n.load(e)}removeLifeCycle(e){const n=this.dataSupportManager,o=e[y.TEXTURE]||[],s=e[y.MATERIAL]||[],i=e.assets||[];delete e.texture,delete e.material,delete e.assets,n.remove(e),n.remove({[y.MATERIAL]:s}),n.remove({[y.TEXTURE]:o});const a=this.resourceManager,u=this.loaderManager;i.forEach(h=>{a.remove(h),u.remove(h)})}loadConfig(e,n){const o=this.renderManager.hasRendering();if(o&&this.renderManager.stop(),e.assets&&e.assets.length){const s=i=>{delete e.assets,this.loadLifeCycle(e),this.resourceManager.removeEventListener("mapped",s),n&&n(i),o?this.renderManager.play():this.renderManager.render()};this.resourceManager.addEventListener("mapped",s),this.loaderManager.reset().load(e.assets)}else this.loadLifeCycle(e),n&&n(),o?this.renderManager.play():this.renderManager.render();return this}loadConfigAsync(e){return new Promise((n,o)=>{const s=this.renderManager.hasRendering();if(s&&this.renderManager.stop(),e.assets&&e.assets.length){const i=a=>{delete e.assets,this.loadLifeCycle(e),this.resourceManager.removeEventListener("mapped",i),s?this.renderManager.play():this.renderManager.render(),n(a)};this.resourceManager.addEventListener("mapped",i),this.loaderManager.reset().load(e.assets)}else this.loadLifeCycle(e),s?this.renderManager.play():this.renderManager.render(),n(void 0)})}removeConfig(e){this.removeLifeCycle(e)}getObjectConfig(e){const n=this.getObjectSymbol(e);return n?this.getConfigBySymbol(n):null}use(e){e.init(this)}}class Zc extends Er{constructor(e){super(e);c(this,"IS_ENGINESUPPORT",!0);this.install(x.WEBGLRENDERER,{antialias:!0,alpha:!0}).install(x.EFFECTCOMPOSER,{WebGLMultisampleRenderTarget:!0}).install(x.SELECTION).install(x.AXESHELPER).install(x.GRIDHELPER).install(x.OBJECTHELPER).install(x.VIEWPOINT).install(x.DISPLAYMODE).install(x.STATS).install(x.ORBITCONTROLS).install(x.KEYBOARDMANAGER).install(x.TRANSFORMCONTROLS).complete()}}class qc extends Er{constructor(t){super(t),this.install(x.WEBGLRENDERER,{antialias:!0,alpha:!0}).install(x.EFFECTCOMPOSER,{WebGLMultisampleRenderTarget:!0}).install(x.ORBITCONTROLS).complete()}}class el{constructor(t){c(this,"visible",!0);t.visible&&(this.visible=t.visible)}}class tl extends el{constructor(e){super(e);c(this,"source");c(this,"target");c(this,"mode");c(this,"cacheSourceMatrix");c(this,"cacheTargetMatrix");c(this,"cacheSoruceGeometryUuid");c(this,"cacheTargetGeometryUuid");c(this,"originalGeometry");c(this,"modifiedGeometry");this.source=e.source,this.target=e.target,this.mode=e.mode||"subtract",this.cacheSourceMatrix=this.source.matrix.clone(),this.cacheTargetMatrix=this.target.matrix.clone(),this.cacheSoruceGeometryUuid=this.source.geometry.uuid,this.cacheTargetGeometryUuid=this.target.geometry.uuid,this.originalGeometry=this.source.geometry,this.modifiedGeometry=new l.BufferGeometry,this.modify(),this.source.geometry=this.modifiedGeometry}async modify(){const e=this.source,n={geometry:this.originalGeometry,matrix:this.source.matrix},o=_t.CSG.fromMesh(n),s=_t.CSG.fromMesh(this.target),i=_t.CSG.toGeometry(o[this.mode](s),e.matrix);this.modifiedGeometry.copy(i),this.modifiedGeometry.uuid=i.uuid}render(){if(this.visible){if(!this.cacheSourceMatrix.equals(this.source.matrix)){this.modify(),this.cacheSourceMatrix.copy(this.source.matrix);return}if(!this.cacheTargetMatrix.equals(this.target.matrix)){this.modify(),this.cacheTargetMatrix.copy(this.target.matrix);return}if(this.originalGeometry.uuid!==this.cacheSoruceGeometryUuid){this.modify(),this.cacheSoruceGeometryUuid=this.originalGeometry.uuid;return}if(this.target.geometry.uuid!==this.cacheTargetGeometryUuid){this.modify(),this.cacheTargetGeometryUuid=this.target.geometry.uuid;return}}else this.modifiedGeometry.copy(this.originalGeometry)}apply(){this.originalGeometry.copy(this.modifiedGeometry),this.originalGeometry.uuid=this.modifiedGeometry.uuid,this.source.geometry=this.originalGeometry}dispose(){this.source.geometry=this.originalGeometry,this.modifiedGeometry.dispose()}}class rl{next(){console.warn(`this action can not set next function: ${this.constructor.name}`)}prev(){console.warn(`this action can not set prev function: ${this.constructor.name}`)}}class nl{constructor(t){c(this,"actionList",[]);c(this,"index",-1);c(this,"step",50);this.step=t||50}do(t){this.actionList[this.index][t]()}apply(t,e=!1){const n=this.actionList;this.index===n.length-1&&n.length>=this.step?(n.shift(),this.index=this.actionList.length-1):this.index!==-1?n.splice(this.index+1,n.length-1):this.index===-1&&(this.actionList=[]),this.actionList.push(t),e?this.redo():this.index+=1}redo(){if(this.index+=1,this.index>this.actionList.length-1){this.index=this.actionList.length-1;return}this.do("next")}undo(){this.index<0||(this.do("prev"),this.index-=1)}clear(){this.actionList=[]}}const Hn=(r,t={})=>{let e=JSON.stringify(r,mt.stringify);const n={},o=Object.keys(r).filter(i=>i!=="assets");for(const i of o)for(const a of r[i]){const u=a.vid,h=ee.v4();e=e.replace(new RegExp(u,"g"),h),t.detail&&(n[u]=h)}const s=JSON.parse(e,mt.parse);if(t.fillName)if(typeof t.fillName=="function")for(const i of o)for(const a of s[i])a.name||(a.name=t.fillName(a));else for(const i of o)for(const a of s[i])a.name||(a.name=`${a.type}-${a.vid.slice(-2)}`);return t.detail?{config:s,detail:n}:s},Nn=(r,t,e={clone:!0,assets:!1})=>{const n=e.clone?mt.clone(r):r,o=e.assets?Object.keys(n):Object.keys(n).filter(s=>s!=="assets");for(const s of o)n[s].forEach((a,u,h)=>{h[u]=t(a)});return n},zn=function(r){const t={};for(const e of Object.keys(r))for(const n of r[e])t[n.name]=n;return t};var ol={clone:Hn,handler:Nn,planish:zn};const Rr=class{constructor(t){c(this,"token",Symbol("VIS.RENDER.WATCHER"));c(this,"target",{});c(this,"path","");c(this,"dep",{});c(this,"ob");c(this,"run");this.run=t,Rr.map.set(this.token,this)}init(t,e,n){this.target=e,this.path=t,this.ob=n}notify(t){this.dep[t]&&this.update()}update(){const t=this.path.split("."),e=t.pop();let n=this.target;for(const s of t)n=n[s];const o=this.ob.subscribe(s=>{s.operate==="get"&&(this.dep[s.path]=!0)});n[e]=this.run(),o.unsubscribe()}};let st=Rr;c(st,"map",new Map);class sl extends wt{constructor(){super();c(this,"subscriptions",[]);c(this,"watchers",[])}watch(e){const n=hr(e);if(!n){console.error("Observer: can not found observable",e);return}for(const s in e)if(ze(e[s])){const i=hr(e[s]);if(!i)continue;this.subscriptions.push(i.subscribe(a=>{n.next({operate:a.operate,path:be(s,a.path),key:a.key,value:a.value})}))}this.subscriptions.push(n.subscribe(s=>{this.next(s)})),this.subscriptions.push(this.subscribe(s=>{if(s.operate!=="get")for(const i of this.watchers)i.notify(s.path)}));const o=(s,i="")=>{for(const a in s){const u=be(i,a);if(typeof s[a]=="symbol"){const h=st.map.get(s[a]);if(!h)continue;h.init(u,e,this),this.watchers.push(h)}else ze(s[a])&&!n.isIgnore(u)&&o(s[a],u)}};o(e);for(const s of this.watchers)s.update()}dispose(){for(const e of this.subscriptions)e.unsubscribe()}}const Fn=function(r){return new st(r).token},il=function(r){const t={name:Symbol("VIS.RENDER.EVENT")};return B.register(t,()=>r),t},kn=function(r,t){return J(r,t,!1,!1)},$t=class extends te{constructor(e){super();c(this,"observed",{});c(this,"options");c(this,"render",{});c(this,"observer",new sl);this.options=e}async createLoad(e){const n=this.options,o=n.load;n.beforeLoad&&n.beforeLoad(),o&&await e.loadResourcesAsync(o),n.loaded&&n.loaded()}createComputed(){const e=this.options.computed||{};for(const n in e)this.observed[n]=Fn(e[n].bind(this.observed))}createRender(e){const n=this.options.render.call(this.observed,kn,()=>{},Fn,il,o=>zn(Nn(Hn(e.resourceManager.getResourceConfig(o),{fillName:!0}),s=>kn(s.type,s))));for(const o in n)this.observed[o]=n[o],this.render[o]=!0;for(const o in this.options.resources||{})delete this.observed[o]}createObserved(){const e=this.options,n={},o=e.methods||{};for(const i in o)n[i]=!0;const s=Object.assign(this.observed,e.input,e.data&&e.data(n),o);e.beforeCreate&&e.beforeCreate(s),this.observed=tn(s,n)}createResources(e){const n=this.options.resources;n&&e.registerResources(n.call(this.observed))}initObserver(){this.observer.watch(this.observed),this.options.created&&this.options.created.call(this.observed)}createWatch(){const e=this.options.watch||{};for(const n in e){const o=e[n];let s;if(typeof o=="object"){if(o.immediate){let i=this.observed;const a=n.split("."),u=a.pop();for(const p of a)i=i[p];const h=i[u];o.handler.call(this.observed,h)}s=o.handler}else s=o;this.observer.subscribe(i=>{const{operate:a,key:u,path:h,value:p}=i;a!=="get"&&n===h&&s.call(this.observed,p)})}}async init(e){const n=this.options;await this.createLoad(e),this.createObserved(),this.createResources(e),this.createComputed(),this.createRender(e),this.initObserver();const o=e.dataSupportManager,s=J(d.GROUP);Object.keys(this.render).forEach(i=>{const a=this.observed[i],u=Ne(a.type);u?(u.toLocaleUpperCase()in lt&&(a.parent||s.children.push(a.vid)),o.applyConfig(a)):console.warn(`widget can not support this config type: ${a.type}`)}),o.applyConfig(s),e.getConfigBySymbol(n.parent).children.push(s.vid),Ge.append(()=>(this.createWatch(),!0))}exportConfig(){}loadConfig(){}};let it=$t;c(it,"components",{}),c(it,"component",function(e){if($t.components[e.name]){console.warn(`${e.name} components has exist`);return}$t.components[e.name]=e});const al="0.3.0";window.__THREE__||console.error("vis-three dependent on three.js module, pleace run 'npm i three' first."),window.__VIS__?console.warn("Duplicate vis-three frames are introduced"):window.__VIS__=al,l.Scene.prototype.add=function(...r){if(!arguments.length)return this;if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}const t=r[0];if(t===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",r),this;if(t&&t.isObject3D){if(t.parent!==null){const e=this.children.indexOf(t);e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent({type:"removed"}))}t.parent=this,this.children.push(t),t.dispatchEvent({type:"added"})}else console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",r);return this};const cl=l.Scene.prototype.add,ll=l.Scene.prototype.remove;l.Scene.prototype.add=function(...r){return cl.call(this,...r),this.dispatchEvent({type:"afterAdd",objects:r}),this},l.Scene.prototype.remove=function(...r){return ll.call(this,...r),this.dispatchEvent({type:"afterRemove",objects:r}),this};const Sr=new fo.LightShadow(new l.OrthographicCamera(-256,256,256,-256));Sr.autoUpdate=!1,Sr.needsUpdate=!1,l.AmbientLight.prototype.shadow=Sr,g.Action=rl,g.AniScriptLibrary=he,g.AnimationDataSupport=yn,g.BooleanModifier=tl,g.CONFIGMODULE=Do,g.CONFIGTYPE=d,g.CSS3DDataSupport=En,g.CSS3DPlane=Tn,g.CameraDataSupport=an,g.CameraHelper=gr,g.CanvasGenerator=Xe,g.ControlsDataSupport=un,g.DISPLAYMODE=jn,g.DataContainer=tt,g.DataSupportManager=bn,g.DirectionalLightHelper=In,g.DisplayEngine=Xc,g.DisplayEngineSupport=qc,g.ENGINEPLUGIN=x,g.EVENTNAME=Yt,g.Engine=G,g.EngineSupport=Er,g.EventDispatcher=te,g.EventLibrary=B,g.GeometryDataSupport=sn,g.GroupDataSupport=mn,g.GroupHelper=ot,g.History=nl,g.JSONHandler=Ns,g.KeyboardManager=Pn,g.LightDataSupport=on,g.LineDataSupport=pn,g.LoaderManager=Ur,g.MODULETYPE=y,g.MaterialDataSupport=nn,g.MaterialDisplayer=xe,g.MeshDataSupport=hn,g.ModelingEngine=Kc,g.ModelingEngineSupport=Zc,g.OBJECTMODULE=lt,g.Object3DDataSupport=Sn,g.PassDataSupport=gn,g.PointLightHelper=Gn,g.PointsDataSupport=fn,g.RESOURCEEVENTTYPE=$r,g.RenderManager=jr,g.RendererDataSupport=cn,g.ResourceManager=Vr,g.SceneDataSupport=ln,g.SelectiveBloomPass=_e,g.ShaderLibrary=Z,g.SpotLightHelper=Bn,g.SpriteDataSupport=dn,g.SupportDataGenerator=Jc,g.TIMINGFUNCTION=Q,g.Template=ol,g.TextureDataSupport=rn,g.TextureDisplayer=Ft,g.Translater=Wr,g.Utils=Us,g.VIEWPOINT=V,g.VideoLoader=Se,g.Widget=it,g.generateConfig=J,g.getModule=Ne,g.uniqueSymbol=N,Object.defineProperty(g,"__esModule",{value:!0}),g[Symbol.toStringTag]="Module"});
