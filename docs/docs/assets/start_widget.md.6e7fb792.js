import{_ as n,c as s,o as a,d as t}from"./app.07870748.js";const m='{"title":"\u7EC4\u4EF6\u5316\u5F00\u53D1","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u7EC4\u4EF6\u5316\u5F00\u53D1","slug":"\u7EC4\u4EF6\u5316\u5F00\u53D1"}],"relativePath":"start/widget.md"}',p={},o=t(`<h2 id="\u7EC4\u4EF6\u5316\u5F00\u53D1" tabindex="-1">\u7EC4\u4EF6\u5316\u5F00\u53D1 <a class="header-anchor" href="#\u7EC4\u4EF6\u5316\u5F00\u53D1" aria-hidden="true">#</a></h2><p>\u7EC4\u4EF6\u5316\u5F00\u53D1\u76EE\u524D\u6B63\u5904\u4E8E<code>alpha</code>\u7248\u672C\u4E2D\u3002</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">THREE</span> <span class="token keyword">from</span> <span class="token string">&quot;three&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ModelingEngineSupport <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vis-three/modeling-engine-support&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CanvasGenerator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vis-three/convenient&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Widget <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vis-three/widget&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> engine <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VIS<span class="token punctuation">.</span>ModelingEngineSupport</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setDom</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setStats</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

engine
  <span class="token punctuation">.</span><span class="token function">applyConfig</span><span class="token punctuation">(</span><span class="token constant">VIS</span><span class="token punctuation">.</span><span class="token function">generateConfig</span><span class="token punctuation">(</span><span class="token string">&quot;Scene&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setScene</span><span class="token punctuation">(</span><span class="token constant">VIS</span><span class="token punctuation">.</span><span class="token function">uniqueSymbol</span><span class="token punctuation">(</span><span class="token string">&quot;Scene&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> widget <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VIS<span class="token punctuation">.</span>Widget</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">parent</span><span class="token operator">:</span> <span class="token constant">VIS</span><span class="token punctuation">.</span><span class="token function">uniqueSymbol</span><span class="token punctuation">(</span><span class="token string">&quot;Scene&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">load</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;model/glb/MaterialsVariantsShoe/MaterialsVariantsShoe.gltf&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">resources</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">textCanvas</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>textCanvas<span class="token punctuation">.</span><span class="token function">getDom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">g<span class="token punctuation">,</span> c<span class="token punctuation">,</span> onComputed<span class="token punctuation">,</span> onEvent<span class="token punctuation">,</span> onResource</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> textTexture <span class="token operator">=</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token string">&quot;CanvasTexture&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;textCanvas&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">minFilter</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>LinearMipmapLinearFilter<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> geometry <span class="token operator">=</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token string">&quot;PlaneGeometry&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> textGeometry <span class="token operator">=</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token string">&quot;PlaneGeometry&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
      <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> textMaterial <span class="token operator">=</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token string">&quot;MeshBasicMaterial&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">map</span><span class="token operator">:</span> textTexture<span class="token punctuation">.</span>vid<span class="token punctuation">,</span>
      <span class="token literal-property property">transparent</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token function">onComputed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">alphaTest</span><span class="token operator">:</span> <span class="token number">0.1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> shoe <span class="token operator">=</span> <span class="token function">onResource</span><span class="token punctuation">(</span>
      <span class="token string">&quot;model/glb/MaterialsVariantsShoe/MaterialsVariantsShoe.gltf&quot;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    shoe<span class="token punctuation">.</span>Scene<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    shoe<span class="token punctuation">.</span>Scene<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    shoe<span class="token punctuation">.</span>Scene<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      textTexture<span class="token punctuation">,</span>
      geometry<span class="token punctuation">,</span>
      textGeometry<span class="token punctuation">,</span>
      textMaterial<span class="token punctuation">,</span>
      <span class="token literal-property property">ambient</span><span class="token operator">:</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token string">&quot;AmbientLight&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token string">&quot;Mesh&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">geometry</span><span class="token operator">:</span> textGeometry<span class="token punctuation">.</span>vid<span class="token punctuation">,</span>
        <span class="token literal-property property">material</span><span class="token operator">:</span> textMaterial<span class="token punctuation">.</span>vid<span class="token punctuation">,</span>
        <span class="token literal-property property">rotation</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">z</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token operator">...</span>shoe<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token parameter">ignore</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ignore<span class="token punctuation">.</span>textCanvas <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;rgb(255, 255, 255)&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">textCanvas</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">CanvasGenerator</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span>
        <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">160</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;Shoe.scale.x&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> object <span class="token operator">=</span> engine<span class="token punctuation">.</span><span class="token function">getObjectBySymbol</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Scene<span class="token punctuation">.</span>vid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> box <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Box3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFromObject</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> width <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token punctuation">(</span>box<span class="token punctuation">.</span>max<span class="token punctuation">.</span>x <span class="token operator">-</span> box<span class="token punctuation">.</span>min<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ruleLong<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>x <span class="token operator">=</span> width<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">immediate</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">draw</span><span class="token punctuation">(</span><span class="token parameter">number <span class="token operator">=</span> <span class="token number">0</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>textCanvas<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span>textBaseline <span class="token operator">=</span> <span class="token string">&quot;middle&quot;</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;rgb(255, 255, 255)&quot;</span><span class="token punctuation">;</span>

        ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot; bold 32px \u5FAE\u8F6F\u96C5\u9ED1&quot;</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>number<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> CM</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>textTexture<span class="token punctuation">.</span>needsUpdate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u4F7F\u7528</span>
engine<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>widget<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>`,3),e=[o];function c(u,l,k,i,r,y){return a(),s("div",null,e)}var g=n(p,[["render",c]]);export{m as __pageData,g as default};
