var r=Object.defineProperty;var s=(e,n,t)=>n in e?r(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var i=(e,n,t)=>(s(e,typeof n!="symbol"?n+"":n,t),t);import{e as h,t as o,f as m}from"./index.5dcba3b7.js";import{G as l}from"./three.057c7ef5.js";var a;(function(e){e.RENDER="render",e.PLAY="play",e.STOP="stop"})(a||(a={}));class p extends h{constructor(t=0){super();i(this,"clock",new l);i(this,"animationFrame",-1);i(this,"fps",0);i(this,"timer",null);i(this,"playFun",()=>{});i(this,"render",()=>{this.dispatchEvent({type:a.RENDER,delta:this.clock.getDelta(),total:this.clock.getElapsedTime()})});i(this,"play",()=>{if(this.hasRendering()){console.warn("render manager is rendering.");return}this.dispatchEvent({type:a.RENDER}),this.playFun()});i(this,"stop",()=>{this.animationFrame!==-1&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=-1),this.timer&&(clearTimeout(this.timer),this.timer=null),this.dispatchEvent({type:a.STOP})});i(this,"hasRendering",()=>Boolean(this.animationFrame!==-1||this.timer));i(this,"hasVaildRender",()=>this.useful());this.setFPS(t)}setFPS(t){return this.animationFrame!==-1&&cancelAnimationFrame(this.animationFrame),this.timer&&clearTimeout(this.timer),this.fps=t,t<=0?(this.fps=0,this.playFun=()=>{this.render(),this.animationFrame=requestAnimationFrame(this.playFun)}):this.playFun=()=>{this.timer=setTimeout(()=>{this.playFun()},t),this.render()},this.playFun(),this}dispose(){this.hasRendering()&&this.stop(),this.clear()}}const d="@vis-three/render-manager-plugin",u=o(d),g=m({name:u,install(e){e.renderManager=new p,e.render=function(){return this.renderManager.render(),this},e.play=function(){return this.renderManager.play(),this},e.stop=function(){return this.renderManager.stop(),this}},dispose(e){e.renderManager.stop(),e.renderManager.dispose()}});export{g as R,u as a,a as b};
