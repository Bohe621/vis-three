(function(c,i){typeof exports=="object"&&typeof module!="undefined"?i(exports,require("three"),require("three/examples/jsm/lights/RectAreaLightUniformsLib.js"),require("three/src/lights/LightShadow"),require("three/examples/jsm/renderers/CSS2DRenderer"),require("three/examples/jsm/renderers/CSS3DRenderer")):typeof define=="function"&&define.amd?define(["exports","three","three/examples/jsm/lights/RectAreaLightUniformsLib.js","three/src/lights/LightShadow","three/examples/jsm/renderers/CSS2DRenderer","three/examples/jsm/renderers/CSS3DRenderer"],i):(c=typeof globalThis!="undefined"?globalThis:c||self,i((c.VIS=c.VIS||{},c.VIS.core={}),c.three,c.RectAreaLightUniformsLib_js,c.LightShadow,c.CSS2DRenderer,c.CSS3DRenderer))})(this,function(c,i,T,le,de,H){"use strict";var Qe=Object.defineProperty;var qe=(c,i,T)=>i in c?Qe(c,i,{enumerable:!0,configurable:!0,writable:!0,value:T}):c[i]=T;var r=(c,i,T)=>(qe(c,typeof i!="symbol"?i+"":i,T),T);const ue="0.5.0";window.__THREE__||console.error("vis-three dependent on three.js module, pleace run 'npm i three' first."),window.__VIS__?console.warn("Duplicate vis-three frames are introduced"):window.__VIS__=ue;const _=new le.LightShadow(new i.OrthographicCamera(-256,256,256,-256));_.autoUpdate=!1,_.needsUpdate=!1,i.AmbientLight.prototype.shadow=_,i.RectAreaLight.prototype.shadow=_,i.HemisphereLight.prototype.shadow=_,T.RectAreaLightUniformsLib.init();class I{constructor(){r(this,"listeners",new Map)}addEventListener(o,e){const n=this.listeners;n.has(o)||n.set(o,new Set),n.get(o).add(e)}hasEventListener(o,e){const n=this.listeners;return n.has(o)?n.get(o).has(e):!1}removeEventListener(o,e){const n=this.listeners;!n.has(o)||!n.get(o).has(e)||n.get(o).delete(e)}dispatchEvent(o){var s;const e=o.type,n=this.listeners;if(n.has(e))try{(s=n.get(e))==null||s.forEach(a=>{a.call(this,o)})}catch(a){console.error(a)}}clear(){this.listeners.clear()}useful(){return Boolean([...this.listeners.keys()].length)}once(o,e){const n=function(s){e.call(this,s),this.removeEventListener(o,n)};this.addEventListener(o,n)}emit(o,e={}){var s;const n=this.listeners;if(n.has(o))try{(s=n.get(o))==null||s.forEach(a=>{a.call(this,e)})}catch(a){console.error(a)}}on(o,e){this.addEventListener(o,e)}has(o,e){return this.hasEventListener(o,e)}off(o,e){if(e)this.removeEventListener(o,e);else{const n=this.listeners;if(!n.has(o))return;n.delete(o)}}}c.ENGINE_EVENT=void 0,function(d){d.SETDOM="setDom",d.SETSIZE="setSize",d.SETCAMERA="setCamera",d.SETSCENE="setScene",d.DISPOSE="dispose"}(c.ENGINE_EVENT||(c.ENGINE_EVENT={}));class F extends I{constructor(){super();r(this,"pluginTables",new Map);r(this,"strategyTables",new Map);r(this,"dom",document.createElement("div"));r(this,"camera",new i.PerspectiveCamera);r(this,"scene",new i.Scene);r(this,"render");this.camera.position.set(50,50,50),this.camera.lookAt(0,0,0),this.render=function(){console.warn("can not install some plugin")}}install(e){if(this.pluginTables.has(e.name))return console.warn("This plugin already exists",e.name),this;const n=s=>this.pluginTables.has(s)?!0:(console.error(`${e.name} must install this plugin before: ${s}`),!1);if(e.deps)if(Array.isArray(e.deps))for(const s of e.deps)n(s);else n(e.deps);return e.install(this),this.pluginTables.set(e.name,e),this}unistall(e){return this.pluginTables.has(e)?(this.pluginTables.get(e).dispose(this),this.pluginTables.delete(e),this):this}exec(e){const n=this.strategyTables;if(n.has(e.name))return console.warn("This strategy already exists",e.name),this;const s=this.pluginTables;for(const a of e.condition)if(!s.has(a))return console.warn(`${e.name} does not meet the conditions for execution: ${a}`),this;return e.exec(this),n.set(e.name,e),this}rollback(e){const n=this.strategyTables;return n.has(e)?(n.get(e).rollback(this),n.delete(e),this):this}setDom(e){return this.dom=e,this.dispatchEvent({type:c.ENGINE_EVENT.SETDOM,dom:e}),this}setSize(e,n){var s,a;return e&&e<=0||n&&n<=0?(console.warn(`you must be input width and height bigger then zero, width: ${e}, height: ${n}`),this):(!e&&(e=((s=this.dom)==null?void 0:s.offsetWidth)||window.innerWidth),!n&&(n=((a=this.dom)==null?void 0:a.offsetHeight)||window.innerHeight),this.dispatchEvent({type:c.ENGINE_EVENT.SETSIZE,width:e,height:n}),this)}setCamera(e,n){return this.dispatchEvent({type:c.ENGINE_EVENT.SETCAMERA,camera:e,oldCamera:this.camera,options:Object.assign({orbitControls:!0,transformControls:!0},n||{})}),this.camera=e,this}setScene(e){return this.dispatchEvent({type:c.ENGINE_EVENT.SETSCENE,scene:e,oldScene:this.scene}),this.scene=e,this}dispose(){return this.dispatchEvent({type:c.ENGINE_EVENT.DISPOSE}),this}}const me=function(d){const o=new F;return d.plugins&&d.plugins.forEach(e=>{o.install(e)}),d.strategy&&d.strategy.forEach(e=>{o.exec(e)}),o},pe=function(d){return()=>d};class fe extends i.Texture{constructor(e,n,s,a,u,h,m,E,y){super(e,n,s,a,u,h,m,E,y);r(this,"isVideoTexture",!0);this.format=m!==void 0?m:i.RGBFormat,this.minFilter=h!==void 0?h:i.LinearFilter,this.magFilter=u!==void 0?u:i.LinearFilter,this.generateMipmaps=!1}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image,n="requestVideoFrameCallback"in e;n?this.needsUpdate=!0:n===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class X extends de.CSS2DObject{constructor(e=document.createElement("div")){const n=document.createElement("div"),s=50,a=50;n.style.width=`${s}px`,n.style.height=`${a}px`,n.appendChild(e);super(n);r(this,"geometry");r(this,"_width");r(this,"_height");this.geometry=new i.PlaneBufferGeometry(s,a),this.geometry.computeBoundingBox(),this._width=s,this._height=a}get width(){return this._width}set width(e){this.geometry.dispose(),this.geometry=new i.PlaneBufferGeometry(e,this._height),this.geometry.computeBoundingBox(),this.element.style.width=`${e}px`,this._width=e}get height(){return this._height}set height(e){this.geometry.dispose(),this.geometry=new i.PlaneBufferGeometry(this._width,e),this.geometry.computeBoundingBox(),this.element.style.height=`${e}px`,this._height=e}}class Z extends H.CSS3DObject{constructor(e=document.createElement("div")){const n=document.createElement("div"),s=50,a=50;n.style.width=`${s}px`,n.style.height=`${a}px`,n.appendChild(e);super(n);r(this,"geometry");r(this,"_width");r(this,"_height");this.geometry=new i.PlaneBufferGeometry(s,a),this.geometry.computeBoundingBox(),this._width=s,this._height=a}get width(){return this._width}set width(e){this.geometry.dispose(),this.geometry=new i.PlaneBufferGeometry(e,this._height),this.geometry.computeBoundingBox(),this.element.style.width=`${e}px`,this._width=e}get height(){return this._height}set height(e){this.geometry.dispose(),this.geometry=new i.PlaneBufferGeometry(this._width,e),this.geometry.computeBoundingBox(),this.element.style.height=`${e}px`,this._height=e}}class W extends H.CSS3DSprite{constructor(e=document.createElement("div")){const n=document.createElement("div"),s=50,a=50;n.style.width=`${s}px`,n.style.height=`${a}px`,n.appendChild(e),e.classList.add("vis-css3d","vis-css3d-sprite");super(n);r(this,"geometry");r(this,"_width");r(this,"_height");r(this,"cacheBox",new i.Box3);r(this,"cachePosition",new i.Vector3);r(this,"cacheQuaternion",new i.Quaternion);r(this,"cacheScale",new i.Vector3);r(this,"cacheMatrix4",new i.Matrix4);r(this,"rotateMatrix4",new i.Matrix4);this.geometry=new i.PlaneBufferGeometry(s,a),this.geometry.computeBoundingBox(),this._width=s,this._height=a,this.type="CSS3DSprite"}get width(){return this._width}set width(e){this.geometry.dispose(),this.geometry=new i.PlaneBufferGeometry(e,this._height),this.geometry.computeBoundingBox(),this.element.style.width=`${e}px`,this._width=e}get height(){return this._height}set height(e){this.geometry.dispose(),this.geometry=new i.PlaneBufferGeometry(this._width,e),this.geometry.computeBoundingBox(),this.element.style.height=`${e}px`,this._height=e}raycast(e,n){const s=this.cacheBox.copy(this.geometry.boundingBox);this.matrixWorld.decompose(this.cachePosition,this.cacheQuaternion,this.cacheScale);const a=this.rotateMatrix4.lookAt(this.position,e.camera.position,this.up);this.cacheQuaternion.setFromRotationMatrix(a),this.cacheMatrix4.compose(this.cachePosition,this.cacheQuaternion,this.cacheScale),s.applyMatrix4(this.cacheMatrix4),e.ray.intersectsBox(s)&&n.push({distance:e.ray.origin.distanceTo(this.position),object:this,point:this.position})}}class ge extends I{constructor(e,n){super();r(this,"object");r(this,"domElement");r(this,"enabled",!0);r(this,"target",new i.Vector3);r(this,"minDistance",0);r(this,"maxDistance",1/0);r(this,"minZoom",0);r(this,"maxZoom",1/0);r(this,"minPolarAngle",0);r(this,"maxPolarAngle",Math.PI);r(this,"minAzimuthAngle",-1/0);r(this,"maxAzimuthAngle",1/0);r(this,"enableDamping",!1);r(this,"dampingFactor",.05);r(this,"enableZoom",!0);r(this,"zoomSpeed",1);r(this,"enableRotate",!0);r(this,"rotateSpeed",1);r(this,"enablePan",!0);r(this,"panSpeed",1);r(this,"screenSpacePanning",!0);r(this,"keyPanSpeed",7);r(this,"autoRotate",!1);r(this,"autoRotateSpeed",2);r(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"});r(this,"mouseButtons",{LEFT:null,MIDDLE:i.MOUSE.DOLLY,RIGHT:i.MOUSE.ROTATE});r(this,"touches",{ONE:i.TOUCH.ROTATE,TWO:i.TOUCH.DOLLY_PAN});r(this,"target0");r(this,"position0");r(this,"zoom0");r(this,"_domElementKeyEvents",null);r(this,"spherical");r(this,"reset");r(this,"update");r(this,"onContextMenu");r(this,"onPointerDown");r(this,"onPointerCancel");r(this,"onMouseWheel");r(this,"onPointerMove");r(this,"onPointerUp");r(this,"onKeyDown");this.object=e||new i.PerspectiveCamera,this.domElement=n||document.createElement("div"),this.domElement.style.touchAction="none",this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.update=(()=>{const t=new i.Vector3,l=new i.Quaternion().setFromUnitVectors(this.object.up,new i.Vector3(0,1,0)),f=l.clone().invert(),g=new i.Vector3,S=new i.Quaternion,P=2*Math.PI;return()=>{const ce=this.object.position;t.copy(ce).sub(this.target),t.applyQuaternion(l),h.setFromVector3(t),this.autoRotate&&a===s.NONE&&k(_e()),this.enableDamping?(h.theta+=m.theta*this.dampingFactor,h.phi+=m.phi*this.dampingFactor):(h.theta+=m.theta,h.phi+=m.phi);let w=this.minAzimuthAngle,b=this.maxAzimuthAngle;return isFinite(w)&&isFinite(b)&&(w<-Math.PI?w+=P:w>Math.PI&&(w-=P),b<-Math.PI?b+=P:b>Math.PI&&(b-=P),w<=b?h.theta=Math.max(w,Math.min(b,h.theta)):h.theta=h.theta>(w+b)/2?Math.max(w,h.theta):Math.min(b,h.theta)),h.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=E,h.radius=Math.max(this.minDistance,Math.min(this.maxDistance,h.radius)),this.enableDamping===!0?this.target.addScaledVector(y,this.dampingFactor):this.target.add(y),t.setFromSpherical(h),t.applyQuaternion(f),ce.copy(this.target).add(t),this.object.lookAt(this.target),this.enableDamping===!0?(m.theta*=1-this.dampingFactor,m.phi*=1-this.dampingFactor,y.multiplyScalar(1-this.dampingFactor)):(m.set(0,0,0),y.set(0,0,0)),E=1,R||g.distanceToSquared(this.object.position)>u||8*(1-S.dot(this.object.quaternion))>u?(this.dispatchEvent({type:"change"}),g.copy(this.object.position),S.copy(this.object.quaternion),R=!1,!0):!1}})();const s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=s.NONE;const u=1e-6,h=new i.Spherical,m=new i.Spherical;let E=1;const y=new i.Vector3;let R=!1;const x=new i.Vector2,C=new i.Vector2,M=new i.Vector2,L=new i.Vector2,v=new i.Vector2,D=new i.Vector2,O=new i.Vector2,A=new i.Vector2,j=new i.Vector2,p=[],N={},_e=()=>2*Math.PI/60/60*this.autoRotateSpeed,G=()=>Math.pow(.95,this.zoomSpeed),k=t=>{m.theta-=t},$=t=>{m.phi-=t},K=function(){const t=new i.Vector3;return function(f,g){t.setFromMatrixColumn(g,0),t.multiplyScalar(-f),y.add(t)}}(),Q=(()=>{const t=new i.Vector3;return(l,f)=>{this.screenSpacePanning===!0?t.setFromMatrixColumn(f,1):(t.setFromMatrixColumn(f,0),t.crossVectors(this.object.up,t)),t.multiplyScalar(l),y.add(t)}})(),V=(()=>{const t=new i.Vector3;return(l,f)=>{const g=this.domElement;if(this.object instanceof i.PerspectiveCamera){const S=this.object.position;t.copy(S).sub(this.target);let P=t.length();P*=Math.tan(this.object.fov/2*Math.PI/180),K(2*l*P/g.clientHeight,this.object.matrix),Q(2*f*P/g.clientHeight,this.object.matrix)}else this.object instanceof i.OrthographicCamera?(K(l*(this.object.right-this.object.left)/this.object.zoom/g.clientWidth,this.object.matrix),Q(f*(this.object.top-this.object.bottom)/this.object.zoom/g.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}})(),U=t=>{this.object instanceof i.PerspectiveCamera?E/=t:this.object instanceof i.OrthographicCamera?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),this.object.updateProjectionMatrix(),R=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)},q=t=>{this.object instanceof i.PerspectiveCamera?E*=t:this.object instanceof i.OrthographicCamera?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),this.object.updateProjectionMatrix(),R=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)};function J(t){x.set(t.clientX,t.clientY)}function Be(t){O.set(t.clientX,t.clientY)}function ee(t){L.set(t.clientX,t.clientY)}const je=t=>{C.set(t.clientX,t.clientY),M.subVectors(C,x).multiplyScalar(this.rotateSpeed);const l=this.domElement;k(2*Math.PI*M.x/l.clientHeight),$(2*Math.PI*M.y/l.clientHeight),x.copy(C),this.update()},Re=t=>{A.set(t.clientX,t.clientY),j.subVectors(A,O),j.y>0?U(G()):j.y<0&&q(G()),O.copy(A),this.update()},Ne=t=>{v.set(t.clientX,t.clientY),D.subVectors(v,L).multiplyScalar(this.panSpeed),V(D.x,D.y),L.copy(v),this.update()},Ge=t=>{t.deltaY<0?q(G()):t.deltaY>0&&U(G()),this.update()},Ie=t=>{let l=!1;switch(t.code){case this.keys.UP:V(0,this.keyPanSpeed),l=!0;break;case this.keys.BOTTOM:V(0,-this.keyPanSpeed),l=!0;break;case this.keys.LEFT:V(this.keyPanSpeed,0),l=!0;break;case this.keys.RIGHT:V(-this.keyPanSpeed,0),l=!0;break}l&&(t.preventDefault(),this.update())};function te(){if(p.length===1)x.set(p[0].pageX,p[0].pageY);else{const t=.5*(p[0].pageX+p[1].pageX),l=.5*(p[0].pageY+p[1].pageY);x.set(t,l)}}function ie(){if(p.length===1)L.set(p[0].pageX,p[0].pageY);else{const t=.5*(p[0].pageX+p[1].pageX),l=.5*(p[0].pageY+p[1].pageY);L.set(t,l)}}function se(){const t=p[0].pageX-p[1].pageX,l=p[0].pageY-p[1].pageY,f=Math.sqrt(t*t+l*l);O.set(0,f)}const ke=()=>{this.enableZoom&&se(),this.enablePan&&ie()},Ue=()=>{this.enableZoom&&se(),this.enableRotate&&te()},ne=t=>{if(p.length==1)C.set(t.pageX,t.pageY);else{const f=Y(t),g=.5*(t.pageX+f.x),S=.5*(t.pageY+f.y);C.set(g,S)}M.subVectors(C,x).multiplyScalar(this.rotateSpeed);const l=this.domElement;k(2*Math.PI*M.x/l.clientHeight),$(2*Math.PI*M.y/l.clientHeight),x.copy(C)},oe=t=>{if(p.length===1)v.set(t.pageX,t.pageY);else{const l=Y(t),f=.5*(t.pageX+l.x),g=.5*(t.pageY+l.y);v.set(f,g)}D.subVectors(v,L).multiplyScalar(this.panSpeed),V(D.x,D.y),L.copy(v)},re=t=>{const l=Y(t),f=t.pageX-l.x,g=t.pageY-l.y,S=Math.sqrt(f*f+g*g);A.set(0,S),j.set(0,Math.pow(A.y/O.y,this.zoomSpeed)),U(j.y),O.copy(A)},ze=t=>{this.enableZoom&&re(t),this.enablePan&&oe(t)},Ye=t=>{this.enableZoom&&re(t),this.enableRotate&&ne(t)};this.onPointerDown=t=>{this.enabled!==!1&&(p.length===0&&(this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp)),Ke(t),t.pointerType==="touch"?Ze(t):He(t))};let z=!1;this.onPointerMove=t=>{this.enabled!==!1&&(z||(this.domElement.setPointerCapture(t.pointerId),z=!0),t.pointerType==="touch"?We(t):Fe(t))},this.onPointerUp=t=>{this.enabled!==!1&&(z=!1,t.pointerType==="touch"?$e():Xe(),ae(t),p.length===0&&(this.domElement.releasePointerCapture(t.pointerId),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)))},this.onPointerCancel=t=>{ae(t)};const He=t=>{let l;switch(t.button){case 0:l=this.mouseButtons.LEFT;break;case 1:l=this.mouseButtons.MIDDLE;break;case 2:l=this.mouseButtons.RIGHT;break;default:l=-1}switch(l){case i.MOUSE.DOLLY:if(this.enableZoom===!1)return;Be(t),a=s.DOLLY;break;case i.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enablePan===!1)return;ee(t),a=s.PAN}else{if(this.enableRotate===!1)return;J(t),a=s.ROTATE}break;case i.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enableRotate===!1)return;J(t),a=s.ROTATE}else{if(this.enablePan===!1)return;ee(t),a=s.PAN}break;default:a=s.NONE}a!==s.NONE&&this.dispatchEvent({type:"start"})},Fe=t=>{if(this.enabled!==!1)switch(a){case s.ROTATE:if(this.enableRotate===!1)return;je(t);break;case s.DOLLY:if(this.enableZoom===!1)return;Re(t);break;case s.PAN:if(this.enablePan===!1)return;Ne(t);break}},Xe=t=>{this.dispatchEvent({type:"end"}),a=s.NONE};this.onMouseWheel=t=>{this.enabled===!1||this.enableZoom===!1||a!==s.NONE||(t.preventDefault(),this.dispatchEvent({type:"start"}),Ge(t),this.dispatchEvent({type:"end"}))},this.onKeyDown=t=>{this.enabled===!1||this.enablePan===!1||Ie(t)};const Ze=t=>{switch(he(t),p.length){case 1:switch(this.touches.ONE){case i.TOUCH.ROTATE:if(this.enableRotate===!1)return;te(),a=s.TOUCH_ROTATE;break;case i.TOUCH.PAN:if(this.enablePan===!1)return;ie(),a=s.TOUCH_PAN;break;default:a=s.NONE}break;case 2:switch(this.touches.TWO){case i.TOUCH.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;ke(),a=s.TOUCH_DOLLY_PAN;break;case i.TOUCH.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;Ue(),a=s.TOUCH_DOLLY_ROTATE;break;default:a=s.NONE}break;default:a=s.NONE}a!==s.NONE&&this.dispatchEvent({type:"start"})},We=t=>{switch(he(t),a){case s.TOUCH_ROTATE:if(this.enableRotate===!1)return;ne(t),this.update();break;case s.TOUCH_PAN:if(this.enablePan===!1)return;oe(t),this.update();break;case s.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;ze(t),this.update();break;case s.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;Ye(t),this.update();break;default:a=s.NONE}},$e=t=>{this.dispatchEvent({type:"end"}),a=s.NONE};this.onContextMenu=t=>{this.enabled!==!1&&t.preventDefault()};function Ke(t){p.push(t)}const ae=t=>{delete N[t.pointerId];for(let l=0;l<p.length;l++)if(p[l].pointerId==t.pointerId){p.splice(l,1);return}};function he(t){let l=N[t.pointerId];l===void 0&&(l=new i.Vector2,N[t.pointerId]=l),l.set(t.pageX,t.pageY)}function Y(t){const l=t.pointerId===p[0].pointerId?p[1]:p[0];return N[l.pointerId]}this.spherical=h,this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),this.domElement.addEventListener("wheel",this.onMouseWheel,{passive:!1}),this.reset=()=>{this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent({type:"change"}),this.update(),a=s.NONE},this.update()}getPolarAngle(){return this.spherical.phi}getAzimuthalAngle(){return this.spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this.onKeyDown),this._domElementKeyEvents=e}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}setCamera(e){this.object=e}setDom(e){this.dispose(),this.domElement=e,this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),this.domElement.addEventListener("wheel",this.onMouseWheel,{passive:!1})}dispose(){this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointercancel",this.onPointerCancel),this.domElement.removeEventListener("wheel",this.onMouseWheel),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp),this._domElementKeyEvents!==null&&this._domElementKeyEvents.removeEventListener("keydown",this.onKeyDown)}}class ye{}class we{constructor(o="rgb(230, 20, 240)",e="rgba(230, 20, 240, 0.15)"){r(this,"element");r(this,"startPoint");r(this,"pointTopLeft");r(this,"pointBottomRight");r(this,"isDown");const n=document.createElement("div");n.style.pointerEvents="none",n.style.border=`1px solid ${o}`,n.style.position="fixed",n.style.zIndex="100",n.style.backgroundColor=e,this.element=n,this.startPoint=new i.Vector2,this.pointTopLeft=new i.Vector2,this.pointBottomRight=new i.Vector2,this.isDown=!1}onSelectStart(o){this.isDown=!0,document.body.appendChild(this.element),this.element.style.left=o.clientX+"px",this.element.style.top=o.clientY+"px",this.element.style.width="0px",this.element.style.height="0px",this.startPoint.x=o.clientX,this.startPoint.y=o.clientY}onSelectMove(o){!this.isDown||(this.pointBottomRight.x=Math.max(this.startPoint.x,o.clientX),this.pointBottomRight.y=Math.max(this.startPoint.y,o.clientY),this.pointTopLeft.x=Math.min(this.startPoint.x,o.clientX),this.pointTopLeft.y=Math.min(this.startPoint.y,o.clientY),this.element.style.left=this.pointTopLeft.x+"px",this.element.style.top=this.pointTopLeft.y+"px",this.element.style.width=this.pointBottomRight.x-this.pointTopLeft.x+"px",this.element.style.height=this.pointBottomRight.y-this.pointTopLeft.y+"px")}onSelectOver(o){!this.isDown||(this.isDown=!1,document.body.removeChild(this.element))}}class be extends i.Texture{constructor(o,e,n,s,a,u,h,m,E,y){super(o,e,n,s,a,u,h,m,E,y)}}class Ee extends i.Texture{constructor(o){super(),Object.keys(o).forEach(e=>{this[e]=o[e]}),this.copy(o)}}class Se extends X{constructor(e=document.createElement("div")){super(e);r(this,"cacheBox",new i.Box3);r(this,"viewWorldMatrix",new i.Matrix4);r(this,"mvPosition",new i.Vector3);r(this,"matrixScale",new i.Vector3);r(this,"worldScale",new i.Vector3);r(this,"vA",new i.Vector3);r(this,"vB",new i.Vector3);r(this,"vC",new i.Vector3);r(this,"alignedPosition",new i.Vector2);r(this,"rotatedPosition",new i.Vector2);r(this,"intersectPoint",new i.Vector3);this.type="CSS2DPlane",this.element.classList.add("vis-css2d","vis-css2d-plane"),new MutationObserver(()=>{this.matrixScale.set(Math.abs(this.width/100)*.1,Math.abs(this.height/100)*.1,1)}).observe(this.element,{attributeFilter:["style"]})}transformVertex(e,n,s){const a=this.alignedPosition,u=this.rotatedPosition,h=0,m=1;a.copy(e).multiply(s),u.x=m*a.x-h*a.y,u.y=h*a.x+m*a.y,e.copy(n),e.x+=u.x,e.y+=u.y,e.applyMatrix4(this.viewWorldMatrix)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),this.viewWorldMatrix.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),this.mvPosition.setFromMatrixPosition(this.modelViewMatrix),this.worldScale.copy(this.matrixScale).multiplyScalar(-this.mvPosition.z),this.transformVertex(this.vA.set(-.5,-.5,0),this.mvPosition,this.worldScale),this.transformVertex(this.vB.set(.5,-.5,0),this.mvPosition,this.worldScale),this.transformVertex(this.vC.set(.5,.5,0),this.mvPosition,this.worldScale);let s=e.ray.intersectTriangle(this.vA,this.vB,this.vC,!1,this.intersectPoint);if(s===null&&(this.transformVertex(this.vB.set(-.5,.5,0),this.mvPosition,this.worldScale),s=e.ray.intersectTriangle(this.vA,this.vC,this.vB,!1,this.intersectPoint),s===null))return;const a=e.ray.origin.distanceTo(this.intersectPoint);a<e.near||a>e.far||n.push({distance:a,point:this.intersectPoint.clone(),face:null,object:this})}}class Pe extends Z{constructor(e=document.createElement("div")){super(e);r(this,"cacheBox",new i.Box3);this.type="CSS3DPlane",this.element.classList.add("vis-css3d","vis-css3d-plane")}raycast(e,n){const s=this.cacheBox.copy(this.geometry.boundingBox);s.applyMatrix4(this.matrixWorld),e.ray.intersectsBox(s)&&n.push({distance:e.ray.origin.distanceTo(this.position),object:this,point:this.position})}}class Te extends W{constructor(o=document.createElement("div")){super(o),this.type="CSS3DSprite",this.element.classList.add("vis-css3d","vis-css3d-plane")}}class xe extends i.BufferGeometry{constructor(e){super();r(this,"type","LoadBufferGeometry");e&&this.copy(e)}}class B extends i.BufferGeometry{constructor(e=[],n=36,s=!0){super();r(this,"parameters");this.type="CurveGeometry",this.parameters={path:e.map(a=>a.clone()),space:s,divisions:n}}}class Ce extends B{constructor(o=[],e=36,n=!0){super(o,e,n),this.type="CubicBezierCurveGeometry";const s=new i.CurvePath;if(o.length<4){console.warn("CubicBezierCurveGeometry path length at least 4.");return}const a=4+(o.length-4)-(o.length-4)%3;for(let h=2;h<a;h+=3)s.add(new i.CubicBezierCurve3(o[h-2],o[h-1],o[h],o[h+1]));const u=s.curves.reduce((h,m)=>h+=m.arcLengthDivisions,0);if(e>u){const h=Math.ceil((e-u)/s.curves.length);s.curves.forEach(m=>{m.arcLengthDivisions=m.arcLengthDivisions*(h+1),m.updateArcLengths()})}this.setFromPoints(n?s.getSpacedPoints(e):s.getPoints(e))}}class Le extends B{constructor(o=[],e=36,n=!0){if(super(o,e,n),this.type="LineCurveGeometry",!o.length){console.warn("LineCurveGeometry path length at least 1.");return}const s=new i.CurvePath;for(let u=1;u<o.length;u+=1)s.add(new i.LineCurve3(o[u-1],o[u]));const a=s.curves.reduce((u,h)=>u+=h.arcLengthDivisions,0);if(e>a){const u=Math.ceil((e-a)/s.curves.length);s.curves.forEach(h=>{h.arcLengthDivisions=h.arcLengthDivisions*(u+1),h.updateArcLengths()})}this.setFromPoints(n?s.getSpacedPoints(e):s.getPoints(e))}}class ve extends B{constructor(o=[],e=36,n=!0){super(o,e,n),this.type="QuadraticBezierCurveGeometry";const s=new i.CurvePath;if(o.length<3){console.warn("QuadraticBezierCurveGeometry path length at least 3.");return}const a=3+(o.length-3)-(o.length-3)%2;for(let h=1;h<a;h+=2)s.add(new i.QuadraticBezierCurve3(o[h-1],o[h],o[h+1]));const u=s.curves.reduce((h,m)=>h+=m.arcLengthDivisions,0);if(e>u){const h=Math.ceil((e-u)/s.curves.length);s.curves.forEach(m=>{m.arcLengthDivisions=m.arcLengthDivisions*(h+1),m.updateArcLengths()})}this.setFromPoints(n?s.getSpacedPoints(e):s.getPoints(e))}}class Me extends B{constructor(o=[],e=36,n=!0){if(super(o,e,n),this.type="SplineCurveGeometry",!o.length){console.warn("SplineCurveGeometry path length at least 1.");return}const s=new i.CatmullRomCurve3(o);this.setFromPoints(n?s.getSpacedPoints(e):s.getPoints(e))}}class De extends i.ShapeBufferGeometry{constructor(o=[new i.Vector2(0,0)],e=12){const n=new i.Shape,s=o[0];if(s){n.moveTo(s.x,s.y);for(let a=1;a<o.length;a+=1)n.lineTo(o[a].x,o[a].y)}super(n,e),this.type="LineShapeGeometry"}}class Oe extends i.TubeGeometry{constructor(o=[],e=64,n=1,s=8,a=!1){if(!o.length){console.warn("LineTubeGeometry path length at least 1.");return}const u=new i.CurvePath;for(let h=1;h<o.length;h+=1)u.add(new i.LineCurve3(o[h-1],o[h]));super(u,e,n,s,a),this.type="LineTubeGeometry"}}class Ae extends i.TubeGeometry{constructor(o=[],e=64,n=1,s=8,a=!1){if(!o.length){console.warn("SplineTubeGeometry path length at least 1.");return}const u=new i.CatmullRomCurve3(o);super(u,e,n,s,a),this.type="SplineTubeGeometry"}}const Ve=function(d){return()=>d};c.CSS2DPlane=Se,c.CSS3DPlane=Pe,c.CSS3DSprite=Te,c.CubicBezierCurveGeometry=Ce,c.CurveGeometry=B,c.Engine=F,c.EventDispatcher=I,c.ImageTexture=be,c.LineCurveGeometry=Le,c.LineShapeGeometry=De,c.LineTubeGeometry=Oe,c.LoadGeometry=xe,c.LoadTexture=Ee,c.QuadraticBezierCurveGeometry=ve,c.SplineCurveGeometry=Me,c.SplineTubeGeometry=Ae,c.VideoTexture=fe,c.VisCSS2DObject=X,c.VisCSS3DObject=Z,c.VisCSS3DSprite=W,c.VisOrbitControls=ge,c.VisSelectionBox=ye,c.VisSelectionHelper=we,c.defineEngine=me,c.definePlugin=pe,c.defineStrategy=Ve,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
