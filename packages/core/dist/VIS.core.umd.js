(function(c,t){typeof exports=="object"&&typeof module!="undefined"?t(exports,require("three"),require("three/examples/jsm/lights/RectAreaLightUniformsLib.js"),require("three/src/lights/LightShadow"),require("three/examples/jsm/renderers/CSS2DRenderer"),require("three/examples/jsm/renderers/CSS3DRenderer"),require("three/examples/jsm/libs/stats.module"),require("three/examples/jsm/controls/TransformControls"),require("three/examples/jsm/postprocessing/Pass"),require("three/examples/jsm/shaders/LuminosityHighPassShader")):typeof define=="function"&&define.amd?define(["exports","three","three/examples/jsm/lights/RectAreaLightUniformsLib.js","three/src/lights/LightShadow","three/examples/jsm/renderers/CSS2DRenderer","three/examples/jsm/renderers/CSS3DRenderer","three/examples/jsm/libs/stats.module","three/examples/jsm/controls/TransformControls","three/examples/jsm/postprocessing/Pass","three/examples/jsm/shaders/LuminosityHighPassShader"],t):(c=typeof globalThis!="undefined"?globalThis:c||self,t((c.VIS=c.VIS||{},c.VIS.core={}),c.three,c.RectAreaLightUniformsLib_js,c.LightShadow,c.CSS2DRenderer,c.CSS3DRenderer,c.Stats,c.TransformControls,c.Pass,c.LuminosityHighPassShader))})(this,function(c,t,L,ye,ve,X,be,xe,Z,$){"use strict";var ht=Object.defineProperty;var ct=(c,t,L)=>t in c?ht(c,t,{enumerable:!0,configurable:!0,writable:!0,value:L}):c[t]=L;var o=(c,t,L)=>(ct(c,typeof t!="symbol"?t+"":t,L),L);function Se(d){return d&&typeof d=="object"&&"default"in d?d:{default:d}}var we=Se(be);const Te="0.4.0";window.__THREE__||console.error("vis-three dependent on three.js module, pleace run 'npm i three' first."),window.__VIS__?console.warn("Duplicate vis-three frames are introduced"):window.__VIS__=Te;const U=new ye.LightShadow(new t.OrthographicCamera(-256,256,256,-256));U.autoUpdate=!1,U.needsUpdate=!1,t.AmbientLight.prototype.shadow=U,t.RectAreaLight.prototype.shadow=U,t.HemisphereLight.prototype.shadow=U,L.RectAreaLightUniformsLib.init();class N{constructor(){o(this,"listeners",new Map)}addEventListener(r,e){const n=this.listeners;n.has(r)||n.set(r,new Set),n.get(r).add(e)}hasEventListener(r,e){const n=this.listeners;return n.has(r)?n.get(r).has(e):!1}removeEventListener(r,e){const n=this.listeners;!n.has(r)||!n.get(r).has(e)||n.get(r).delete(e)}dispatchEvent(r){var i;const e=r.type,n=this.listeners;if(n.has(e))try{(i=n.get(e))==null||i.forEach(a=>{a.call(this,r)})}catch(a){console.error(a)}}clear(){this.listeners.clear()}useful(){return Boolean([...this.listeners.keys()].length)}once(r,e){const n=function(i){e.call(this,i),this.removeEventListener(r,n)};this.addEventListener(r,n)}emit(r,e={}){var i;const n=this.listeners;if(n.has(r))try{(i=n.get(r))==null||i.forEach(a=>{a.call(this,e)})}catch(a){console.error(a)}}on(r,e){this.addEventListener(r,e)}has(r,e){return this.hasEventListener(r,e)}off(r,e){if(e)this.removeEventListener(r,e);else{const n=this.listeners;if(!n.has(r))return;n.delete(r)}}}var q=(d=>(d.SETDOM="setDom",d.SETSIZE="setSize",d.SETCAMERA="setCamera",d.SETSCENE="setScene",d.DISPOSE="dispose",d))(q||{});class Me extends N{constructor(){super();o(this,"pluginTables",new Map);o(this,"dom",document.createElement("div"));o(this,"camera",new t.PerspectiveCamera);o(this,"scene",new t.Scene);o(this,"render");o(this,"play");o(this,"stop");this.render=function(){console.warn("can not install some plugin")},this.play=this.render,this.stop=this.render}install(e){if(this.pluginTables.has(e.name))return console.warn("This plugin already exists",e.name),this;const n=(h,l)=>this.pluginTables.has(h)?!0:l?(console.error(`${e.name} must install this plugin before: ${h}`),!1):(console.warn(`${e.name} recommends using this plugin: ${h}`),!0);if(e.deps)if(Array.isArray(e.deps))for(const h of e.deps)n(h,e.order);else n(e.deps,e.order);const i=this.pluginTables.values(),a=this.pluginTables.keys();e.install(this);for(const h of i)h.installDeps&&h.installDeps[e.name]&&h.installDeps[e.name](this);for(const h of a)e.installDeps&&e.installDeps[h]&&e.installDeps[h](this);return this.pluginTables.set(e.name,e),this}unistall(e){if(!this.pluginTables.has(e))return this;const n=this.pluginTables.get(e);n.dispose(this),n.disposeDeps&&Object.values(n.disposeDeps).forEach(i=>{i(this)});for(const i of this.pluginTables.values())i.disposeDeps&&i.disposeDeps[e]&&i.disposeDeps[e](this);return this.pluginTables.delete(e),this}setDom(e){return this.dom=e,this.dispatchEvent({type:"setDom",dom:e}),this}setSize(e,n){var i,a;return e&&e<=0||n&&n<=0?(console.warn(`you must be input width and height bigger then zero, width: ${e}, height: ${n}`),this):(!e&&(e=((i=this.dom)==null?void 0:i.offsetWidth)||window.innerWidth),!n&&(n=((a=this.dom)==null?void 0:a.offsetHeight)||window.innerHeight),this.dispatchEvent({type:"setSize",width:e,height:n}),this)}setCamera(e,n){return this.dispatchEvent({type:"setCamera",camera:e,oldCamera:this.camera,options:Object.assign({orbitControls:!0,transformControls:!0},n||{})}),this.camera=e,this}setScene(e){return this.dispatchEvent({type:"setScene",scene:e,oldScene:this.scene}),this.scene=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}}const Pe=function(d){return()=>d};class Ce extends t.Texture{constructor(e,n,i,a,h,l,p,g,f){super(e,n,i,a,h,l,p,g,f);o(this,"isVideoTexture",!0);this.format=p!==void 0?p:t.RGBFormat,this.minFilter=l!==void 0?l:t.LinearFilter,this.magFilter=h!==void 0?h:t.LinearFilter,this.generateMipmaps=!1}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image,n="requestVideoFrameCallback"in e;n?this.needsUpdate=!0:n===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class K extends ve.CSS2DObject{constructor(e=document.createElement("div")){const n=document.createElement("div"),i=50,a=50;n.style.width=`${i}px`,n.style.height=`${a}px`,n.appendChild(e);super(n);o(this,"geometry");o(this,"_width");o(this,"_height");this.geometry=new t.PlaneBufferGeometry(i,a),this.geometry.computeBoundingBox(),this._width=i,this._height=a}get width(){return this._width}set width(e){this.geometry.dispose(),this.geometry=new t.PlaneBufferGeometry(e,this._height),this.geometry.computeBoundingBox(),this.element.style.width=`${e}px`,this._width=e}get height(){return this._height}set height(e){this.geometry.dispose(),this.geometry=new t.PlaneBufferGeometry(this._width,e),this.geometry.computeBoundingBox(),this.element.style.height=`${e}px`,this._height=e}}class J extends X.CSS3DObject{constructor(e=document.createElement("div")){const n=document.createElement("div"),i=50,a=50;n.style.width=`${i}px`,n.style.height=`${a}px`,n.appendChild(e);super(n);o(this,"geometry");o(this,"_width");o(this,"_height");this.geometry=new t.PlaneBufferGeometry(i,a),this.geometry.computeBoundingBox(),this._width=i,this._height=a}get width(){return this._width}set width(e){this.geometry.dispose(),this.geometry=new t.PlaneBufferGeometry(e,this._height),this.geometry.computeBoundingBox(),this.element.style.width=`${e}px`,this._width=e}get height(){return this._height}set height(e){this.geometry.dispose(),this.geometry=new t.PlaneBufferGeometry(this._width,e),this.geometry.computeBoundingBox(),this.element.style.height=`${e}px`,this._height=e}}class ee extends X.CSS3DSprite{constructor(e=document.createElement("div")){const n=document.createElement("div"),i=50,a=50;n.style.width=`${i}px`,n.style.height=`${a}px`,n.appendChild(e),e.classList.add("vis-css3d","vis-css3d-sprite");super(n);o(this,"geometry");o(this,"_width");o(this,"_height");o(this,"cacheBox",new t.Box3);o(this,"cachePosition",new t.Vector3);o(this,"cacheQuaternion",new t.Quaternion);o(this,"cacheScale",new t.Vector3);o(this,"cacheMatrix4",new t.Matrix4);o(this,"rotateMatrix4",new t.Matrix4);this.geometry=new t.PlaneBufferGeometry(i,a),this.geometry.computeBoundingBox(),this._width=i,this._height=a,this.type="CSS3DSprite"}get width(){return this._width}set width(e){this.geometry.dispose(),this.geometry=new t.PlaneBufferGeometry(e,this._height),this.geometry.computeBoundingBox(),this.element.style.width=`${e}px`,this._width=e}get height(){return this._height}set height(e){this.geometry.dispose(),this.geometry=new t.PlaneBufferGeometry(this._width,e),this.geometry.computeBoundingBox(),this.element.style.height=`${e}px`,this._height=e}raycast(e,n){const i=this.cacheBox.copy(this.geometry.boundingBox);this.matrixWorld.decompose(this.cachePosition,this.cacheQuaternion,this.cacheScale);const a=this.rotateMatrix4.lookAt(this.position,e.camera.position,this.up);this.cacheQuaternion.setFromRotationMatrix(a),this.cacheMatrix4.compose(this.cachePosition,this.cacheQuaternion,this.cacheScale),i.applyMatrix4(this.cacheMatrix4),e.ray.intersectsBox(i)&&n.push({distance:e.ray.origin.distanceTo(this.position),object:this,point:this.position})}}class Ee extends N{constructor(e,n){super();o(this,"object");o(this,"domElement");o(this,"enabled",!0);o(this,"target",new t.Vector3);o(this,"minDistance",0);o(this,"maxDistance",1/0);o(this,"minZoom",0);o(this,"maxZoom",1/0);o(this,"minPolarAngle",0);o(this,"maxPolarAngle",Math.PI);o(this,"minAzimuthAngle",-1/0);o(this,"maxAzimuthAngle",1/0);o(this,"enableDamping",!1);o(this,"dampingFactor",.05);o(this,"enableZoom",!0);o(this,"zoomSpeed",1);o(this,"enableRotate",!0);o(this,"rotateSpeed",1);o(this,"enablePan",!0);o(this,"panSpeed",1);o(this,"screenSpacePanning",!0);o(this,"keyPanSpeed",7);o(this,"autoRotate",!1);o(this,"autoRotateSpeed",2);o(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"});o(this,"mouseButtons",{LEFT:null,MIDDLE:t.MOUSE.DOLLY,RIGHT:t.MOUSE.ROTATE});o(this,"touches",{ONE:t.TOUCH.ROTATE,TWO:t.TOUCH.DOLLY_PAN});o(this,"target0");o(this,"position0");o(this,"zoom0");o(this,"_domElementKeyEvents",null);o(this,"spherical");o(this,"reset");o(this,"update");o(this,"onContextMenu");o(this,"onPointerDown");o(this,"onPointerCancel");o(this,"onMouseWheel");o(this,"onPointerMove");o(this,"onPointerUp");o(this,"onKeyDown");this.object=e||new t.PerspectiveCamera,this.domElement=n||document.createElement("div"),this.domElement.style.touchAction="none",this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.update=(()=>{const s=new t.Vector3,u=new t.Quaternion().setFromUnitVectors(this.object.up,new t.Vector3(0,1,0)),v=u.clone().invert(),x=new t.Vector3,E=new t.Quaternion,D=2*Math.PI;return()=>{const ge=this.object.position;s.copy(ge).sub(this.target),s.applyQuaternion(u),l.setFromVector3(s),this.autoRotate&&a===i.NONE&&F(Ye()),this.enableDamping?(l.theta+=p.theta*this.dampingFactor,l.phi+=p.phi*this.dampingFactor):(l.theta+=p.theta,l.phi+=p.phi);let P=this.minAzimuthAngle,C=this.maxAzimuthAngle;return isFinite(P)&&isFinite(C)&&(P<-Math.PI?P+=D:P>Math.PI&&(P-=D),C<-Math.PI?C+=D:C>Math.PI&&(C-=D),P<=C?l.theta=Math.max(P,Math.min(C,l.theta)):l.theta=l.theta>(P+C)/2?Math.max(P,l.theta):Math.min(C,l.theta)),l.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,l.phi)),l.makeSafe(),l.radius*=g,l.radius=Math.max(this.minDistance,Math.min(this.maxDistance,l.radius)),this.enableDamping===!0?this.target.addScaledVector(f,this.dampingFactor):this.target.add(f),s.setFromSpherical(l),s.applyQuaternion(v),ge.copy(this.target).add(s),this.object.lookAt(this.target),this.enableDamping===!0?(p.theta*=1-this.dampingFactor,p.phi*=1-this.dampingFactor,f.multiplyScalar(1-this.dampingFactor)):(p.set(0,0,0),f.set(0,0,0)),g=1,m||x.distanceToSquared(this.object.position)>h||8*(1-E.dot(this.object.quaternion))>h?(this.dispatchEvent({type:"change"}),x.copy(this.object.position),E.copy(this.object.quaternion),m=!1,!0):!1}})();const i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=i.NONE;const h=1e-6,l=new t.Spherical,p=new t.Spherical;let g=1;const f=new t.Vector3;let m=!1;const w=new t.Vector2,S=new t.Vector2,b=new t.Vector2,T=new t.Vector2,M=new t.Vector2,R=new t.Vector2,V=new t.Vector2,A=new t.Vector2,k=new t.Vector2,y=[],I={},Ye=()=>2*Math.PI/60/60*this.autoRotateSpeed,G=()=>Math.pow(.95,this.zoomSpeed),F=s=>{p.theta-=s},ie=s=>{p.phi-=s},se=function(){const s=new t.Vector3;return function(v,x){s.setFromMatrixColumn(x,0),s.multiplyScalar(-v),f.add(s)}}(),oe=(()=>{const s=new t.Vector3;return(u,v)=>{this.screenSpacePanning===!0?s.setFromMatrixColumn(v,1):(s.setFromMatrixColumn(v,0),s.crossVectors(this.object.up,s)),s.multiplyScalar(u),f.add(s)}})(),_=(()=>{const s=new t.Vector3;return(u,v)=>{const x=this.domElement;if(this.object instanceof t.PerspectiveCamera){const E=this.object.position;s.copy(E).sub(this.target);let D=s.length();D*=Math.tan(this.object.fov/2*Math.PI/180),se(2*u*D/x.clientHeight,this.object.matrix),oe(2*v*D/x.clientHeight,this.object.matrix)}else this.object instanceof t.OrthographicCamera?(se(u*(this.object.right-this.object.left)/this.object.zoom/x.clientWidth,this.object.matrix),oe(v*(this.object.top-this.object.bottom)/this.object.zoom/x.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}})(),Y=s=>{this.object instanceof t.PerspectiveCamera?g/=s:this.object instanceof t.OrthographicCamera?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*s)),this.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)},ne=s=>{this.object instanceof t.PerspectiveCamera?g*=s:this.object instanceof t.OrthographicCamera?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/s)),this.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)};function re(s){w.set(s.clientX,s.clientY)}function We(s){V.set(s.clientX,s.clientY)}function ae(s){T.set(s.clientX,s.clientY)}const Qe=s=>{S.set(s.clientX,s.clientY),b.subVectors(S,w).multiplyScalar(this.rotateSpeed);const u=this.domElement;F(2*Math.PI*b.x/u.clientHeight),ie(2*Math.PI*b.y/u.clientHeight),w.copy(S),this.update()},Xe=s=>{A.set(s.clientX,s.clientY),k.subVectors(A,V),k.y>0?Y(G()):k.y<0&&ne(G()),V.copy(A),this.update()},Ze=s=>{M.set(s.clientX,s.clientY),R.subVectors(M,T).multiplyScalar(this.panSpeed),_(R.x,R.y),T.copy(M),this.update()},$e=s=>{s.deltaY<0?ne(G()):s.deltaY>0&&Y(G()),this.update()},qe=s=>{let u=!1;switch(s.code){case this.keys.UP:_(0,this.keyPanSpeed),u=!0;break;case this.keys.BOTTOM:_(0,-this.keyPanSpeed),u=!0;break;case this.keys.LEFT:_(this.keyPanSpeed,0),u=!0;break;case this.keys.RIGHT:_(-this.keyPanSpeed,0),u=!0;break}u&&(s.preventDefault(),this.update())};function le(){if(y.length===1)w.set(y[0].pageX,y[0].pageY);else{const s=.5*(y[0].pageX+y[1].pageX),u=.5*(y[0].pageY+y[1].pageY);w.set(s,u)}}function he(){if(y.length===1)T.set(y[0].pageX,y[0].pageY);else{const s=.5*(y[0].pageX+y[1].pageX),u=.5*(y[0].pageY+y[1].pageY);T.set(s,u)}}function ce(){const s=y[0].pageX-y[1].pageX,u=y[0].pageY-y[1].pageY,v=Math.sqrt(s*s+u*u);V.set(0,v)}const Ke=()=>{this.enableZoom&&ce(),this.enablePan&&he()},Je=()=>{this.enableZoom&&ce(),this.enableRotate&&le()},ue=s=>{if(y.length==1)S.set(s.pageX,s.pageY);else{const v=Q(s),x=.5*(s.pageX+v.x),E=.5*(s.pageY+v.y);S.set(x,E)}b.subVectors(S,w).multiplyScalar(this.rotateSpeed);const u=this.domElement;F(2*Math.PI*b.x/u.clientHeight),ie(2*Math.PI*b.y/u.clientHeight),w.copy(S)},de=s=>{if(y.length===1)M.set(s.pageX,s.pageY);else{const u=Q(s),v=.5*(s.pageX+u.x),x=.5*(s.pageY+u.y);M.set(v,x)}R.subVectors(M,T).multiplyScalar(this.panSpeed),_(R.x,R.y),T.copy(M)},me=s=>{const u=Q(s),v=s.pageX-u.x,x=s.pageY-u.y,E=Math.sqrt(v*v+x*x);A.set(0,E),k.set(0,Math.pow(A.y/V.y,this.zoomSpeed)),Y(k.y),V.copy(A)},et=s=>{this.enableZoom&&me(s),this.enablePan&&de(s)},tt=s=>{this.enableZoom&&me(s),this.enableRotate&&ue(s)};this.onPointerDown=s=>{this.enabled!==!1&&(y.length===0&&(this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp)),lt(s),s.pointerType==="touch"?nt(s):it(s))};let W=!1;this.onPointerMove=s=>{this.enabled!==!1&&(W||(this.domElement.setPointerCapture(s.pointerId),W=!0),s.pointerType==="touch"?rt(s):st(s))},this.onPointerUp=s=>{this.enabled!==!1&&(W=!1,s.pointerType==="touch"?at():ot(),pe(s),y.length===0&&(this.domElement.releasePointerCapture(s.pointerId),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)))},this.onPointerCancel=s=>{pe(s)};const it=s=>{let u;switch(s.button){case 0:u=this.mouseButtons.LEFT;break;case 1:u=this.mouseButtons.MIDDLE;break;case 2:u=this.mouseButtons.RIGHT;break;default:u=-1}switch(u){case t.MOUSE.DOLLY:if(this.enableZoom===!1)return;We(s),a=i.DOLLY;break;case t.MOUSE.ROTATE:if(s.ctrlKey||s.metaKey||s.shiftKey){if(this.enablePan===!1)return;ae(s),a=i.PAN}else{if(this.enableRotate===!1)return;re(s),a=i.ROTATE}break;case t.MOUSE.PAN:if(s.ctrlKey||s.metaKey||s.shiftKey){if(this.enableRotate===!1)return;re(s),a=i.ROTATE}else{if(this.enablePan===!1)return;ae(s),a=i.PAN}break;default:a=i.NONE}a!==i.NONE&&this.dispatchEvent({type:"start"})},st=s=>{if(this.enabled!==!1)switch(a){case i.ROTATE:if(this.enableRotate===!1)return;Qe(s);break;case i.DOLLY:if(this.enableZoom===!1)return;Xe(s);break;case i.PAN:if(this.enablePan===!1)return;Ze(s);break}},ot=s=>{this.dispatchEvent({type:"end"}),a=i.NONE};this.onMouseWheel=s=>{this.enabled===!1||this.enableZoom===!1||a!==i.NONE||(s.preventDefault(),this.dispatchEvent({type:"start"}),$e(s),this.dispatchEvent({type:"end"}))},this.onKeyDown=s=>{this.enabled===!1||this.enablePan===!1||qe(s)};const nt=s=>{switch(fe(s),y.length){case 1:switch(this.touches.ONE){case t.TOUCH.ROTATE:if(this.enableRotate===!1)return;le(),a=i.TOUCH_ROTATE;break;case t.TOUCH.PAN:if(this.enablePan===!1)return;he(),a=i.TOUCH_PAN;break;default:a=i.NONE}break;case 2:switch(this.touches.TWO){case t.TOUCH.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;Ke(),a=i.TOUCH_DOLLY_PAN;break;case t.TOUCH.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;Je(),a=i.TOUCH_DOLLY_ROTATE;break;default:a=i.NONE}break;default:a=i.NONE}a!==i.NONE&&this.dispatchEvent({type:"start"})},rt=s=>{switch(fe(s),a){case i.TOUCH_ROTATE:if(this.enableRotate===!1)return;ue(s),this.update();break;case i.TOUCH_PAN:if(this.enablePan===!1)return;de(s),this.update();break;case i.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;et(s),this.update();break;case i.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;tt(s),this.update();break;default:a=i.NONE}},at=s=>{this.dispatchEvent({type:"end"}),a=i.NONE};this.onContextMenu=s=>{this.enabled!==!1&&s.preventDefault()};function lt(s){y.push(s)}const pe=s=>{delete I[s.pointerId];for(let u=0;u<y.length;u++)if(y[u].pointerId==s.pointerId){y.splice(u,1);return}};function fe(s){let u=I[s.pointerId];u===void 0&&(u=new t.Vector2,I[s.pointerId]=u),u.set(s.pageX,s.pageY)}function Q(s){const u=s.pointerId===y[0].pointerId?y[1]:y[0];return I[u.pointerId]}this.spherical=l,this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),this.domElement.addEventListener("wheel",this.onMouseWheel,{passive:!1}),this.reset=()=>{this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent({type:"change"}),this.update(),a=i.NONE},this.update()}getPolarAngle(){return this.spherical.phi}getAzimuthalAngle(){return this.spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this.onKeyDown),this._domElementKeyEvents=e}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}setCamera(e){this.object=e}setDom(e){this.dispose(),this.domElement=e,this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),this.domElement.addEventListener("wheel",this.onMouseWheel,{passive:!1})}dispose(){this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointercancel",this.onPointerCancel),this.domElement.removeEventListener("wheel",this.onMouseWheel),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp),this._domElementKeyEvents!==null&&this._domElementKeyEvents.removeEventListener("keydown",this.onKeyDown)}}class De{}class Le{constructor(r="rgb(230, 20, 240)",e="rgba(230, 20, 240, 0.15)"){o(this,"element");o(this,"startPoint");o(this,"pointTopLeft");o(this,"pointBottomRight");o(this,"isDown");const n=document.createElement("div");n.style.pointerEvents="none",n.style.border=`1px solid ${r}`,n.style.position="fixed",n.style.zIndex="100",n.style.backgroundColor=e,this.element=n,this.startPoint=new t.Vector2,this.pointTopLeft=new t.Vector2,this.pointBottomRight=new t.Vector2,this.isDown=!1}onSelectStart(r){this.isDown=!0,document.body.appendChild(this.element),this.element.style.left=r.clientX+"px",this.element.style.top=r.clientY+"px",this.element.style.width="0px",this.element.style.height="0px",this.startPoint.x=r.clientX,this.startPoint.y=r.clientY}onSelectMove(r){!this.isDown||(this.pointBottomRight.x=Math.max(this.startPoint.x,r.clientX),this.pointBottomRight.y=Math.max(this.startPoint.y,r.clientY),this.pointTopLeft.x=Math.min(this.startPoint.x,r.clientX),this.pointTopLeft.y=Math.min(this.startPoint.y,r.clientY),this.element.style.left=this.pointTopLeft.x+"px",this.element.style.top=this.pointTopLeft.y+"px",this.element.style.width=this.pointBottomRight.x-this.pointTopLeft.x+"px",this.element.style.height=this.pointBottomRight.y-this.pointTopLeft.y+"px")}onSelectOver(r){!this.isDown||(this.isDown=!1,document.body.removeChild(this.element))}}class Oe{constructor(r){o(this,"REVISION");o(this,"dom");o(this,"addPanel");o(this,"showPanel");o(this,"begin");o(this,"end");o(this,"update");o(this,"domElement");o(this,"setMode");const e=we.default();this.REVISION=e.REVISION,this.dom=e.dom,this.domElement=e.domElement,this.begin=e.begin.bind(e),this.end=e.end.bind(e),this.update=e.update.bind(e),this.addPanel=e.addPanel.bind(e),this.showPanel=e.showPanel.bind(e),this.setMode=e.setMode.bind(e);const n=this.domElement;n.style.position="absolute",n.style.top="0",n.style.left="35px",r&&(n.style.top=`${r.top}px`,n.style.left=`${r.left}px`,n.style.right=`${r.right}px`,n.style.bottom=`${r.bottom}px`)}}var te=(d=>(d.OBJECTCHANGED="objectChanged",d))(te||{});class Be extends xe.TransformControls{constructor(e,n){!e&&(e=new t.PerspectiveCamera),!n&&(n=document.body);super(e,n);o(this,"target");o(this,"transObjectSet");this.domElement.removeEventListener("pointerdown",this._onPointerDown),this._onPointerDown=g=>{var f;!this.enabled||!((f=this.object)!=null&&f.parent)||(this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(g)),this.pointerDown(this._getPointer(g)))},this.domElement.addEventListener("pointerdown",this._onPointerDown),this.target=new t.Object3D,this.transObjectSet=new Set;let i="";const a=this.target,h=this.transObjectSet,l={x:0,y:0,z:0},p=new WeakMap;this.addEventListener("mouseDown",g=>{i=g.target.mode,i==="translate"&&(i="position"),i==="rotate"&&(i="rotation"),l.x=a[i].x,l.y=a[i].y,l.z=a[i].z,h.forEach(f=>{p.set(f,f.matrixAutoUpdate),f.matrixAutoUpdate=!1})}),this.addEventListener("objectChange",g=>{const f=a[i].x-l.x,m=a[i].y-l.y,w=a[i].z-l.z;l.x=a[i].x,l.y=a[i].y,l.z=a[i].z,h.forEach(S=>{S[i].x+=f,S[i].y+=m,S[i].z+=w,S.updateMatrix(),S.updateMatrixWorld()}),this.dispatchEvent({type:"objectChanged",transObjectSet:h,mode:i,target:a})}),this.addEventListener("mouseUp",g=>{h.forEach(f=>{f.matrixAutoUpdate=p.get(f),p.delete(f)})})}setDom(e){return this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),e.addEventListener("pointerdown",this._onPointerDown),e.addEventListener("pointermove",this._onPointerHover),e.addEventListener("pointerup",this._onPointerUp),this.domElement=e,this}setCamera(e){return this.camera=e,this}getTarget(){return this.target}getTransObjectSet(){return this.transObjectSet}setAttach(...e){if(this.transObjectSet.clear(),!e.length||!e[0])return this.detach(),this;this.attach(this.target);const n=this.target;if(e.length===1){const l=e[0];return l.matrixWorld.decompose(n.position,n.quaternion,n.scale),n.updateMatrix(),n.updateMatrixWorld(),this.transObjectSet.add(l),this}const i=[],a=[],h=[];return e.forEach(l=>{i.push(l.matrixWorld.elements[12]),a.push(l.matrixWorld.elements[13]),h.push(l.matrixWorld.elements[14])}),n.rotation.set(0,0,0),n.scale.set(0,0,0),n.position.x=(Math.max(...i)-Math.min(...i))/2+Math.min(...i),n.position.y=(Math.max(...a)-Math.min(...a))/2+Math.min(...a),n.position.z=(Math.max(...h)-Math.min(...h))/2+Math.min(...h),n.updateMatrix(),n.updateMatrixWorld(),e.forEach(l=>{this.transObjectSet.add(l)}),this}}class Re extends t.Texture{constructor(r,e,n,i,a,h,l,p,g,f){super(r,e,n,i,a,h,l,p,g,f)}}class Ve extends t.Texture{constructor(r){super(),Object.keys(r).forEach(e=>{this[e]=r[e]}),this.copy(r)}}const H=class extends Z.Pass{constructor(e=new t.Vector2(256,256),n=1,i=0,a=0,h=new t.Scene,l=new t.PerspectiveCamera,p){super();o(this,"resolution");o(this,"strength");o(this,"radius");o(this,"threshold");o(this,"selectedObjects",[]);o(this,"renderScene");o(this,"renderCamera");o(this,"clearColor",new t.Color(0,0,0));o(this,"renderTargetsHorizontal",[]);o(this,"renderTargetsVertical",[]);o(this,"nMips",5);o(this,"selectRenderTarget");o(this,"renderTargetBright");o(this,"highPassUniforms");o(this,"materialHighPassFilter");o(this,"separableBlurMaterials",[]);o(this,"compositeMaterial");o(this,"bloomTintColors");o(this,"mixMaterial");o(this,"enabled",!0);o(this,"needsSwap",!1);o(this,"_oldClearColor",new t.Color);o(this,"oldClearAlpha",1);o(this,"basic",new t.MeshBasicMaterial);o(this,"fsQuad",new Z.FullScreenQuad);o(this,"materialCache",new Map);o(this,"sceneBackgroundCache",null);o(this,"overrideBackground",new t.Color("black"));o(this,"overrideMeshMaterial",new t.MeshBasicMaterial({color:"black"}));o(this,"overrideLineMaterial",new t.LineBasicMaterial({color:"black"}));o(this,"overridePointsMaterial",new t.PointsMaterial({color:"black"}));o(this,"overrideSpriteMaterial",new t.SpriteMaterial({color:"black"}));this.resolution=e,this.strength=n,this.radius=i,this.threshold=a,this.renderScene=h,this.renderCamera=l,this.selectedObjects=p;let g=Math.round(this.resolution.x/2),f=Math.round(this.resolution.y/2);this.selectRenderTarget=new t.WebGLRenderTarget(g,f),this.selectRenderTarget.texture.name="UnrealBloomPass.selected",this.selectRenderTarget.texture.generateMipmaps=!1,this.renderTargetBright=new t.WebGLRenderTarget(g,f),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let b=0;b<this.nMips;b++){const T=new t.WebGLRenderTarget(g,f);T.texture.name="UnrealBloomPass.h"+b,T.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(T);const M=new t.WebGLRenderTarget(g,f);M.texture.name="UnrealBloomPass.v"+b,M.texture.generateMipmaps=!1,this.renderTargetsVertical.push(M),g=Math.round(g/2),f=Math.round(f/2)}$.LuminosityHighPassShader===void 0&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const m=$.LuminosityHighPassShader;this.highPassUniforms=t.UniformsUtils.clone(m.uniforms),this.highPassUniforms.luminosityThreshold.value=a,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new t.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,defines:{}});const w=[3,5,7,9,11];g=Math.round(this.resolution.x/2),f=Math.round(this.resolution.y/2);for(let b=0;b<this.nMips;b++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(w[b])),this.separableBlurMaterials[b].uniforms.texSize.value=new t.Vector2(g,f),g=Math.round(g/2),f=Math.round(f/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=n,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;const S=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=S,this.bloomTintColors=[new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,this.mixMaterial=this.getMixMaterial()}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,n){let i=Math.round(e/2),a=Math.round(n/2);this.selectRenderTarget.setSize(i,a),this.renderTargetBright.setSize(i,a);for(let h=0;h<this.nMips;h++)this.renderTargetsHorizontal[h].setSize(i,a),this.renderTargetsVertical[h].setSize(i,a),this.separableBlurMaterials[h].uniforms.texSize.value=new t.Vector2(i,a),i=Math.round(i/2),a=Math.round(a/2)}render(e,n,i,a,h){if(!this.selectedObjects.length){this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e));return}e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const l=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),h&&e.state.buffers.stencil.setTest(!1);const p=new Map;for(const m of this.selectedObjects)p.set(m,!0);const g=this.materialCache;this.renderScene.background&&(this.sceneBackgroundCache=this.renderScene.background,this.renderScene.background=this.overrideBackground),this.renderScene.traverse(m=>{!p.has(m)&&!m.isLight&&m.visible&&(g.set(m,m.material),m instanceof t.Mesh?m.material=this.overrideMeshMaterial:m instanceof t.Line?m.material=this.overrideLineMaterial:m instanceof t.Points?m.material=this.overridePointsMaterial:m instanceof t.Sprite&&(m.material=this.overrideSpriteMaterial))}),e.setRenderTarget(this.selectRenderTarget),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=this.selectRenderTarget.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=this.selectRenderTarget.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let f=this.renderTargetBright;for(let m=0;m<this.nMips;m++)this.fsQuad.material=this.separableBlurMaterials[m],this.separableBlurMaterials[m].uniforms.colorTexture.value=f.texture,this.separableBlurMaterials[m].uniforms.direction.value=H.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[m]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[m].uniforms.colorTexture.value=this.renderTargetsHorizontal[m].texture,this.separableBlurMaterials[m].uniforms.direction.value=H.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[m]),e.clear(),this.fsQuad.render(e),f=this.renderTargetsVertical[m];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.mixMaterial,this.mixMaterial.uniforms.bloom.value=this.renderTargetsHorizontal[0].texture,this.mixMaterial.uniforms.origin.value=i.texture,h&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(i),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=l;for(const m of g.entries())m[0].material=m[1];g.clear(),this.sceneBackgroundCache&&(this.renderScene.background=this.sceneBackgroundCache,this.sceneBackgroundCache=null)}getMixMaterial(){return new t.ShaderMaterial({blending:t.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0,uniforms:{bloom:{value:null},origin:{value:null}},vertexShader:`
    
        varying vec2 vUv;
    
        void main() {
    
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    
        }`,fragmentShader:`
        uniform sampler2D bloom;
        uniform sampler2D origin;
    
        varying vec2 vUv;
    
        void main() {
          vec3 bloomColor = texture2D(bloom, vUv).rgb;
          vec3 originColor = texture2D(origin, vUv).rgb;
          gl_FragColor = vec4(originColor + bloomColor, 1.0);
        }`})}getSeperableBlurMaterial(e){return new t.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new t.Vector2(.5,.5)},direction:{value:new t.Vector2(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}
				void main() {
					vec2 invSize = 1.0 / texSize;
					float fSigma = float(SIGMA);
					float weightSum = gaussianPdf(0.0, fSigma);
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianPdf(x, fSigma);
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new t.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}};let j=H;o(j,"BlurDirectionX",new t.Vector2(1,0)),o(j,"BlurDirectionY",new t.Vector2(0,1));class Ae extends K{constructor(e=document.createElement("div")){super(e);o(this,"cacheBox",new t.Box3);o(this,"viewWorldMatrix",new t.Matrix4);o(this,"mvPosition",new t.Vector3);o(this,"matrixScale",new t.Vector3);o(this,"worldScale",new t.Vector3);o(this,"vA",new t.Vector3);o(this,"vB",new t.Vector3);o(this,"vC",new t.Vector3);o(this,"alignedPosition",new t.Vector2);o(this,"rotatedPosition",new t.Vector2);o(this,"intersectPoint",new t.Vector3);this.type="CSS2DPlane",this.element.classList.add("vis-css2d","vis-css2d-plane"),new MutationObserver(()=>{this.matrixScale.set(Math.abs(this.width/100)*.1,Math.abs(this.height/100)*.1,1)}).observe(this.element,{attributeFilter:["style"]})}transformVertex(e,n,i){const a=this.alignedPosition,h=this.rotatedPosition,l=0,p=1;a.copy(e).multiply(i),h.x=p*a.x-l*a.y,h.y=l*a.x+p*a.y,e.copy(n),e.x+=h.x,e.y+=h.y,e.applyMatrix4(this.viewWorldMatrix)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),this.viewWorldMatrix.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),this.mvPosition.setFromMatrixPosition(this.modelViewMatrix),this.worldScale.copy(this.matrixScale).multiplyScalar(-this.mvPosition.z),this.transformVertex(this.vA.set(-.5,-.5,0),this.mvPosition,this.worldScale),this.transformVertex(this.vB.set(.5,-.5,0),this.mvPosition,this.worldScale),this.transformVertex(this.vC.set(.5,.5,0),this.mvPosition,this.worldScale);let i=e.ray.intersectTriangle(this.vA,this.vB,this.vC,!1,this.intersectPoint);if(i===null&&(this.transformVertex(this.vB.set(-.5,.5,0),this.mvPosition,this.worldScale),i=e.ray.intersectTriangle(this.vA,this.vC,this.vB,!1,this.intersectPoint),i===null))return;const a=e.ray.origin.distanceTo(this.intersectPoint);a<e.near||a>e.far||n.push({distance:a,point:this.intersectPoint.clone(),face:null,object:this})}}class _e extends J{constructor(e=document.createElement("div")){super(e);o(this,"cacheBox",new t.Box3);this.type="CSS3DPlane",this.element.classList.add("vis-css3d","vis-css3d-plane")}raycast(e,n){const i=this.cacheBox.copy(this.geometry.boundingBox);i.applyMatrix4(this.matrixWorld),e.ray.intersectsBox(i)&&n.push({distance:e.ray.origin.distanceTo(this.position),object:this,point:this.position})}}class Ue extends ee{constructor(r=document.createElement("div")){super(r),this.type="CSS3DSprite",this.element.classList.add("vis-css3d","vis-css3d-plane")}}class je extends t.BufferGeometry{constructor(e){super();o(this,"type","LoadBufferGeometry");e&&this.copy(e)}}class z extends t.BufferGeometry{constructor(e=[],n=36,i=!0){super();o(this,"parameters");this.type="CurveGeometry",this.parameters={path:e.map(a=>a.clone()),space:i,divisions:n}}}class ze extends z{constructor(r=[],e=36,n=!0){super(r,e,n),this.type="CubicBezierCurveGeometry";const i=new t.CurvePath;if(r.length<4){console.warn("CubicBezierCurveGeometry path length at least 4.");return}const a=4+(r.length-4)-(r.length-4)%3;for(let l=2;l<a;l+=3)i.add(new t.CubicBezierCurve3(r[l-2],r[l-1],r[l],r[l+1]));const h=i.curves.reduce((l,p)=>l+=p.arcLengthDivisions,0);if(e>h){const l=Math.ceil((e-h)/i.curves.length);i.curves.forEach(p=>{p.arcLengthDivisions=p.arcLengthDivisions*(l+1),p.updateArcLengths()})}this.setFromPoints(n?i.getSpacedPoints(e):i.getPoints(e))}}class ke extends z{constructor(r=[],e=36,n=!0){if(super(r,e,n),this.type="LineCurveGeometry",!r.length){console.warn("LineCurveGeometry path length at least 1.");return}const i=new t.CurvePath;for(let h=1;h<r.length;h+=1)i.add(new t.LineCurve3(r[h-1],r[h]));const a=i.curves.reduce((h,l)=>h+=l.arcLengthDivisions,0);if(e>a){const h=Math.ceil((e-a)/i.curves.length);i.curves.forEach(l=>{l.arcLengthDivisions=l.arcLengthDivisions*(h+1),l.updateArcLengths()})}this.setFromPoints(n?i.getSpacedPoints(e):i.getPoints(e))}}class He extends z{constructor(r=[],e=36,n=!0){super(r,e,n),this.type="QuadraticBezierCurveGeometry";const i=new t.CurvePath;if(r.length<3){console.warn("QuadraticBezierCurveGeometry path length at least 3.");return}const a=3+(r.length-3)-(r.length-3)%2;for(let l=1;l<a;l+=2)i.add(new t.QuadraticBezierCurve3(r[l-1],r[l],r[l+1]));const h=i.curves.reduce((l,p)=>l+=p.arcLengthDivisions,0);if(e>h){const l=Math.ceil((e-h)/i.curves.length);i.curves.forEach(p=>{p.arcLengthDivisions=p.arcLengthDivisions*(l+1),p.updateArcLengths()})}this.setFromPoints(n?i.getSpacedPoints(e):i.getPoints(e))}}class Ie extends z{constructor(r=[],e=36,n=!0){if(super(r,e,n),this.type="SplineCurveGeometry",!r.length){console.warn("SplineCurveGeometry path length at least 1.");return}const i=new t.CatmullRomCurve3(r);this.setFromPoints(n?i.getSpacedPoints(e):i.getPoints(e))}}class Ge extends t.ShapeBufferGeometry{constructor(r=[new t.Vector2(0,0)],e=12){const n=new t.Shape,i=r[0];if(i){n.moveTo(i.x,i.y);for(let a=1;a<r.length;a+=1)n.lineTo(r[a].x,r[a].y)}super(n,e),this.type="LineShapeGeometry"}}class Ne extends t.TubeGeometry{constructor(r=[],e=64,n=1,i=8,a=!1){if(!r.length){console.warn("LineTubeGeometry path length at least 1.");return}const h=new t.CurvePath;for(let l=1;l<r.length;l+=1)h.add(new t.LineCurve3(r[l-1],r[l]));super(h,e,n,i,a),this.type="LineTubeGeometry"}}class Fe extends t.TubeGeometry{constructor(r=[],e=64,n=1,i=8,a=!1){if(!r.length){console.warn("SplineTubeGeometry path length at least 1.");return}const h=new t.CatmullRomCurve3(r);super(h,e,n,i,a),this.type="SplineTubeGeometry"}}const B=class extends t.Loader{constructor(r){super(r)}load(r,e,n,i){this.path!==void 0&&(r=this.path+r),this.manager.itemStart(r),r=this.manager.resolveURL(r);const a=t.Cache.get(r);if(a!==void 0)return setTimeout(()=>{e&&e(a),this.manager.itemEnd(r)},0),a;const h=document.createElement("video");return h.preload=B.preload,h.autoplay=B.autoplay,h.loop=B.loop,h.muted=B.muted,h.src=r,h.style.position="fixed",h.style.top="0",h.style.left="0",h.style.zIndex="-1",document.body.appendChild(h),h.oncanplay=()=>{t.Cache.add(r,h),this.manager.itemEnd(r),e&&e(h)},h.onerror=l=>{this.manager.itemEnd(r),i&&i(l)},h}};let O=B;o(O,"autoplay",!0),o(O,"preload","auto"),o(O,"muted",!0),o(O,"loop",!0),c.CSS2DPlane=Ae,c.CSS3DPlane=_e,c.CSS3DSprite=Ue,c.CubicBezierCurveGeometry=ze,c.CurveGeometry=z,c.ENGINE_EVENT=q,c.Engine=Me,c.EventDispatcher=N,c.ImageTexture=Re,c.LineCurveGeometry=ke,c.LineShapeGeometry=Ge,c.LineTubeGeometry=Ne,c.LoadGeometry=je,c.LoadTexture=Ve,c.QuadraticBezierCurveGeometry=He,c.SelectiveBloomPass=j,c.SplineCurveGeometry=Ie,c.SplineTubeGeometry=Fe,c.TRANSFORMEVENT=te,c.VideoLoader=O,c.VideoTexture=Ce,c.VisCSS2DObject=K,c.VisCSS3DObject=J,c.VisCSS3DSprite=ee,c.VisOrbitControls=Ee,c.VisSelectionBox=De,c.VisSelectionHelper=Le,c.VisStats=Oe,c.VisTransformControls=Be,c.definePlugin=Pe,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
