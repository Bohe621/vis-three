(function(c,t){typeof exports=="object"&&typeof module!="undefined"?t(exports,require("three"),require("three/examples/jsm/lights/RectAreaLightUniformsLib.js"),require("three/src/lights/LightShadow"),require("three/examples/jsm/renderers/CSS2DRenderer"),require("three/examples/jsm/renderers/CSS3DRenderer"),require("three/examples/jsm/libs/stats.module"),require("three/examples/jsm/controls/TransformControls"),require("three/examples/jsm/postprocessing/Pass"),require("three/examples/jsm/shaders/LuminosityHighPassShader")):typeof define=="function"&&define.amd?define(["exports","three","three/examples/jsm/lights/RectAreaLightUniformsLib.js","three/src/lights/LightShadow","three/examples/jsm/renderers/CSS2DRenderer","three/examples/jsm/renderers/CSS3DRenderer","three/examples/jsm/libs/stats.module","three/examples/jsm/controls/TransformControls","three/examples/jsm/postprocessing/Pass","three/examples/jsm/shaders/LuminosityHighPassShader"],t):(c=typeof globalThis!="undefined"?globalThis:c||self,t((c.VIS=c.VIS||{},c.VIS.core={}),c.three,c.RectAreaLightUniformsLib_js,c.LightShadow,c.CSS2DRenderer,c.CSS3DRenderer,c.Stats,c.TransformControls,c.Pass,c.LuminosityHighPassShader))})(this,function(c,t,D,ge,ye,X,be,ve,Z,$){"use strict";var ht=Object.defineProperty;var ct=(c,t,D)=>t in c?ht(c,t,{enumerable:!0,configurable:!0,writable:!0,value:D}):c[t]=D;var n=(c,t,D)=>(ct(c,typeof t!="symbol"?t+"":t,D),D);function xe(d){return d&&typeof d=="object"&&"default"in d?d:{default:d}}var Se=xe(be);const Te="0.5.0";window.__THREE__||console.error("vis-three dependent on three.js module, pleace run 'npm i three' first."),window.__VIS__?console.warn("Duplicate vis-three frames are introduced"):window.__VIS__=Te;const U=new ge.LightShadow(new t.OrthographicCamera(-256,256,256,-256));U.autoUpdate=!1,U.needsUpdate=!1,t.AmbientLight.prototype.shadow=U,t.RectAreaLight.prototype.shadow=U,t.HemisphereLight.prototype.shadow=U,D.RectAreaLightUniformsLib.init();class I{constructor(){n(this,"listeners",new Map)}addEventListener(r,e){const o=this.listeners;o.has(r)||o.set(r,new Set),o.get(r).add(e)}hasEventListener(r,e){const o=this.listeners;return o.has(r)?o.get(r).has(e):!1}removeEventListener(r,e){const o=this.listeners;!o.has(r)||!o.get(r).has(e)||o.get(r).delete(e)}dispatchEvent(r){var i;const e=r.type,o=this.listeners;if(o.has(e))try{(i=o.get(e))==null||i.forEach(a=>{a.call(this,r)})}catch(a){console.error(a)}}clear(){this.listeners.clear()}useful(){return Boolean([...this.listeners.keys()].length)}once(r,e){const o=function(i){e.call(this,i),this.removeEventListener(r,o)};this.addEventListener(r,o)}emit(r,e={}){var i;const o=this.listeners;if(o.has(r))try{(i=o.get(r))==null||i.forEach(a=>{a.call(this,e)})}catch(a){console.error(a)}}on(r,e){this.addEventListener(r,e)}has(r,e){return this.hasEventListener(r,e)}off(r,e){if(e)this.removeEventListener(r,e);else{const o=this.listeners;if(!o.has(r))return;o.delete(r)}}}var q=(d=>(d.SETDOM="setDom",d.SETSIZE="setSize",d.SETCAMERA="setCamera",d.SETSCENE="setScene",d.DISPOSE="dispose",d))(q||{});class we extends I{constructor(){super();n(this,"pluginTables",new Map);n(this,"strategyTables",new Map);n(this,"dom",document.createElement("div"));n(this,"camera",new t.PerspectiveCamera);n(this,"scene",new t.Scene);n(this,"render");this.render=function(){console.warn("can not install some plugin")}}install(e){if(this.pluginTables.has(e.name))return console.warn("This plugin already exists",e.name),this;const o=i=>this.pluginTables.has(i)?!0:(console.error(`${e.name} must install this plugin before: ${i}`),!1);if(e.deps)if(Array.isArray(e.deps))for(const i of e.deps)o(i);else o(e.deps);return e.install(this),this.pluginTables.set(e.name,e),this}unistall(e){return this.pluginTables.has(e)?(this.pluginTables.get(e).dispose(this),this.pluginTables.delete(e),this):this}exec(e){const o=this.strategyTables;return o.has(e.name)?(console.warn("This strategy already exists",e.name),this):(e.exec(this),o.set(e.name,e),this)}rollback(e){const o=this.strategyTables;return o.has(e)?(o.get(e).rollback(this),o.delete(e),this):this}setDom(e){return this.dom=e,this.dispatchEvent({type:"setDom",dom:e}),this}setSize(e,o){var i,a;return e&&e<=0||o&&o<=0?(console.warn(`you must be input width and height bigger then zero, width: ${e}, height: ${o}`),this):(!e&&(e=((i=this.dom)==null?void 0:i.offsetWidth)||window.innerWidth),!o&&(o=((a=this.dom)==null?void 0:a.offsetHeight)||window.innerHeight),this.dispatchEvent({type:"setSize",width:e,height:o}),this)}setCamera(e,o){return this.dispatchEvent({type:"setCamera",camera:e,oldCamera:this.camera,options:Object.assign({orbitControls:!0,transformControls:!0},o||{})}),this.camera=e,this}setScene(e){return this.dispatchEvent({type:"setScene",scene:e,oldScene:this.scene}),this.scene=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}}const Me=function(d){return()=>d};class Pe extends t.Texture{constructor(e,o,i,a,h,l,p,g,f){super(e,o,i,a,h,l,p,g,f);n(this,"isVideoTexture",!0);this.format=p!==void 0?p:t.RGBFormat,this.minFilter=l!==void 0?l:t.LinearFilter,this.magFilter=h!==void 0?h:t.LinearFilter,this.generateMipmaps=!1}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image,o="requestVideoFrameCallback"in e;o?this.needsUpdate=!0:o===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class K extends ye.CSS2DObject{constructor(e=document.createElement("div")){const o=document.createElement("div"),i=50,a=50;o.style.width=`${i}px`,o.style.height=`${a}px`,o.appendChild(e);super(o);n(this,"geometry");n(this,"_width");n(this,"_height");this.geometry=new t.PlaneBufferGeometry(i,a),this.geometry.computeBoundingBox(),this._width=i,this._height=a}get width(){return this._width}set width(e){this.geometry.dispose(),this.geometry=new t.PlaneBufferGeometry(e,this._height),this.geometry.computeBoundingBox(),this.element.style.width=`${e}px`,this._width=e}get height(){return this._height}set height(e){this.geometry.dispose(),this.geometry=new t.PlaneBufferGeometry(this._width,e),this.geometry.computeBoundingBox(),this.element.style.height=`${e}px`,this._height=e}}class J extends X.CSS3DObject{constructor(e=document.createElement("div")){const o=document.createElement("div"),i=50,a=50;o.style.width=`${i}px`,o.style.height=`${a}px`,o.appendChild(e);super(o);n(this,"geometry");n(this,"_width");n(this,"_height");this.geometry=new t.PlaneBufferGeometry(i,a),this.geometry.computeBoundingBox(),this._width=i,this._height=a}get width(){return this._width}set width(e){this.geometry.dispose(),this.geometry=new t.PlaneBufferGeometry(e,this._height),this.geometry.computeBoundingBox(),this.element.style.width=`${e}px`,this._width=e}get height(){return this._height}set height(e){this.geometry.dispose(),this.geometry=new t.PlaneBufferGeometry(this._width,e),this.geometry.computeBoundingBox(),this.element.style.height=`${e}px`,this._height=e}}class ee extends X.CSS3DSprite{constructor(e=document.createElement("div")){const o=document.createElement("div"),i=50,a=50;o.style.width=`${i}px`,o.style.height=`${a}px`,o.appendChild(e),e.classList.add("vis-css3d","vis-css3d-sprite");super(o);n(this,"geometry");n(this,"_width");n(this,"_height");n(this,"cacheBox",new t.Box3);n(this,"cachePosition",new t.Vector3);n(this,"cacheQuaternion",new t.Quaternion);n(this,"cacheScale",new t.Vector3);n(this,"cacheMatrix4",new t.Matrix4);n(this,"rotateMatrix4",new t.Matrix4);this.geometry=new t.PlaneBufferGeometry(i,a),this.geometry.computeBoundingBox(),this._width=i,this._height=a,this.type="CSS3DSprite"}get width(){return this._width}set width(e){this.geometry.dispose(),this.geometry=new t.PlaneBufferGeometry(e,this._height),this.geometry.computeBoundingBox(),this.element.style.width=`${e}px`,this._width=e}get height(){return this._height}set height(e){this.geometry.dispose(),this.geometry=new t.PlaneBufferGeometry(this._width,e),this.geometry.computeBoundingBox(),this.element.style.height=`${e}px`,this._height=e}raycast(e,o){const i=this.cacheBox.copy(this.geometry.boundingBox);this.matrixWorld.decompose(this.cachePosition,this.cacheQuaternion,this.cacheScale);const a=this.rotateMatrix4.lookAt(this.position,e.camera.position,this.up);this.cacheQuaternion.setFromRotationMatrix(a),this.cacheMatrix4.compose(this.cachePosition,this.cacheQuaternion,this.cacheScale),i.applyMatrix4(this.cacheMatrix4),e.ray.intersectsBox(i)&&o.push({distance:e.ray.origin.distanceTo(this.position),object:this,point:this.position})}}class Ee extends I{constructor(e,o){super();n(this,"object");n(this,"domElement");n(this,"enabled",!0);n(this,"target",new t.Vector3);n(this,"minDistance",0);n(this,"maxDistance",1/0);n(this,"minZoom",0);n(this,"maxZoom",1/0);n(this,"minPolarAngle",0);n(this,"maxPolarAngle",Math.PI);n(this,"minAzimuthAngle",-1/0);n(this,"maxAzimuthAngle",1/0);n(this,"enableDamping",!1);n(this,"dampingFactor",.05);n(this,"enableZoom",!0);n(this,"zoomSpeed",1);n(this,"enableRotate",!0);n(this,"rotateSpeed",1);n(this,"enablePan",!0);n(this,"panSpeed",1);n(this,"screenSpacePanning",!0);n(this,"keyPanSpeed",7);n(this,"autoRotate",!1);n(this,"autoRotateSpeed",2);n(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"});n(this,"mouseButtons",{LEFT:null,MIDDLE:t.MOUSE.DOLLY,RIGHT:t.MOUSE.ROTATE});n(this,"touches",{ONE:t.TOUCH.ROTATE,TWO:t.TOUCH.DOLLY_PAN});n(this,"target0");n(this,"position0");n(this,"zoom0");n(this,"_domElementKeyEvents",null);n(this,"spherical");n(this,"reset");n(this,"update");n(this,"onContextMenu");n(this,"onPointerDown");n(this,"onPointerCancel");n(this,"onMouseWheel");n(this,"onPointerMove");n(this,"onPointerUp");n(this,"onKeyDown");this.object=e||new t.PerspectiveCamera,this.domElement=o||document.createElement("div"),this.domElement.style.touchAction="none",this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.update=(()=>{const s=new t.Vector3,u=new t.Quaternion().setFromUnitVectors(this.object.up,new t.Vector3(0,1,0)),b=u.clone().invert(),x=new t.Vector3,C=new t.Quaternion,L=2*Math.PI;return()=>{const fe=this.object.position;s.copy(fe).sub(this.target),s.applyQuaternion(u),l.setFromVector3(s),this.autoRotate&&a===i.NONE&&F(Ye()),this.enableDamping?(l.theta+=p.theta*this.dampingFactor,l.phi+=p.phi*this.dampingFactor):(l.theta+=p.theta,l.phi+=p.phi);let P=this.minAzimuthAngle,E=this.maxAzimuthAngle;return isFinite(P)&&isFinite(E)&&(P<-Math.PI?P+=L:P>Math.PI&&(P-=L),E<-Math.PI?E+=L:E>Math.PI&&(E-=L),P<=E?l.theta=Math.max(P,Math.min(E,l.theta)):l.theta=l.theta>(P+E)/2?Math.max(P,l.theta):Math.min(E,l.theta)),l.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,l.phi)),l.makeSafe(),l.radius*=g,l.radius=Math.max(this.minDistance,Math.min(this.maxDistance,l.radius)),this.enableDamping===!0?this.target.addScaledVector(f,this.dampingFactor):this.target.add(f),s.setFromSpherical(l),s.applyQuaternion(b),fe.copy(this.target).add(s),this.object.lookAt(this.target),this.enableDamping===!0?(p.theta*=1-this.dampingFactor,p.phi*=1-this.dampingFactor,f.multiplyScalar(1-this.dampingFactor)):(p.set(0,0,0),f.set(0,0,0)),g=1,m||x.distanceToSquared(this.object.position)>h||8*(1-C.dot(this.object.quaternion))>h?(this.dispatchEvent({type:"change"}),x.copy(this.object.position),C.copy(this.object.quaternion),m=!1,!0):!1}})();const i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=i.NONE;const h=1e-6,l=new t.Spherical,p=new t.Spherical;let g=1;const f=new t.Vector3;let m=!1;const T=new t.Vector2,S=new t.Vector2,v=new t.Vector2,w=new t.Vector2,M=new t.Vector2,R=new t.Vector2,A=new t.Vector2,V=new t.Vector2,N=new t.Vector2,y=[],G={},Ye=()=>2*Math.PI/60/60*this.autoRotateSpeed,H=()=>Math.pow(.95,this.zoomSpeed),F=s=>{p.theta-=s},te=s=>{p.phi-=s},ie=function(){const s=new t.Vector3;return function(b,x){s.setFromMatrixColumn(x,0),s.multiplyScalar(-b),f.add(s)}}(),se=(()=>{const s=new t.Vector3;return(u,b)=>{this.screenSpacePanning===!0?s.setFromMatrixColumn(b,1):(s.setFromMatrixColumn(b,0),s.crossVectors(this.object.up,s)),s.multiplyScalar(u),f.add(s)}})(),_=(()=>{const s=new t.Vector3;return(u,b)=>{const x=this.domElement;if(this.object instanceof t.PerspectiveCamera){const C=this.object.position;s.copy(C).sub(this.target);let L=s.length();L*=Math.tan(this.object.fov/2*Math.PI/180),ie(2*u*L/x.clientHeight,this.object.matrix),se(2*b*L/x.clientHeight,this.object.matrix)}else this.object instanceof t.OrthographicCamera?(ie(u*(this.object.right-this.object.left)/this.object.zoom/x.clientWidth,this.object.matrix),se(b*(this.object.top-this.object.bottom)/this.object.zoom/x.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}})(),Y=s=>{this.object instanceof t.PerspectiveCamera?g/=s:this.object instanceof t.OrthographicCamera?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*s)),this.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)},oe=s=>{this.object instanceof t.PerspectiveCamera?g*=s:this.object instanceof t.OrthographicCamera?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/s)),this.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)};function ne(s){T.set(s.clientX,s.clientY)}function We(s){A.set(s.clientX,s.clientY)}function re(s){w.set(s.clientX,s.clientY)}const Qe=s=>{S.set(s.clientX,s.clientY),v.subVectors(S,T).multiplyScalar(this.rotateSpeed);const u=this.domElement;F(2*Math.PI*v.x/u.clientHeight),te(2*Math.PI*v.y/u.clientHeight),T.copy(S),this.update()},Xe=s=>{V.set(s.clientX,s.clientY),N.subVectors(V,A),N.y>0?Y(H()):N.y<0&&oe(H()),A.copy(V),this.update()},Ze=s=>{M.set(s.clientX,s.clientY),R.subVectors(M,w).multiplyScalar(this.panSpeed),_(R.x,R.y),w.copy(M),this.update()},$e=s=>{s.deltaY<0?oe(H()):s.deltaY>0&&Y(H()),this.update()},qe=s=>{let u=!1;switch(s.code){case this.keys.UP:_(0,this.keyPanSpeed),u=!0;break;case this.keys.BOTTOM:_(0,-this.keyPanSpeed),u=!0;break;case this.keys.LEFT:_(this.keyPanSpeed,0),u=!0;break;case this.keys.RIGHT:_(-this.keyPanSpeed,0),u=!0;break}u&&(s.preventDefault(),this.update())};function ae(){if(y.length===1)T.set(y[0].pageX,y[0].pageY);else{const s=.5*(y[0].pageX+y[1].pageX),u=.5*(y[0].pageY+y[1].pageY);T.set(s,u)}}function le(){if(y.length===1)w.set(y[0].pageX,y[0].pageY);else{const s=.5*(y[0].pageX+y[1].pageX),u=.5*(y[0].pageY+y[1].pageY);w.set(s,u)}}function he(){const s=y[0].pageX-y[1].pageX,u=y[0].pageY-y[1].pageY,b=Math.sqrt(s*s+u*u);A.set(0,b)}const Ke=()=>{this.enableZoom&&he(),this.enablePan&&le()},Je=()=>{this.enableZoom&&he(),this.enableRotate&&ae()},ce=s=>{if(y.length==1)S.set(s.pageX,s.pageY);else{const b=Q(s),x=.5*(s.pageX+b.x),C=.5*(s.pageY+b.y);S.set(x,C)}v.subVectors(S,T).multiplyScalar(this.rotateSpeed);const u=this.domElement;F(2*Math.PI*v.x/u.clientHeight),te(2*Math.PI*v.y/u.clientHeight),T.copy(S)},ue=s=>{if(y.length===1)M.set(s.pageX,s.pageY);else{const u=Q(s),b=.5*(s.pageX+u.x),x=.5*(s.pageY+u.y);M.set(b,x)}R.subVectors(M,w).multiplyScalar(this.panSpeed),_(R.x,R.y),w.copy(M)},de=s=>{const u=Q(s),b=s.pageX-u.x,x=s.pageY-u.y,C=Math.sqrt(b*b+x*x);V.set(0,C),N.set(0,Math.pow(V.y/A.y,this.zoomSpeed)),Y(N.y),A.copy(V)},et=s=>{this.enableZoom&&de(s),this.enablePan&&ue(s)},tt=s=>{this.enableZoom&&de(s),this.enableRotate&&ce(s)};this.onPointerDown=s=>{this.enabled!==!1&&(y.length===0&&(this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp)),lt(s),s.pointerType==="touch"?nt(s):it(s))};let W=!1;this.onPointerMove=s=>{this.enabled!==!1&&(W||(this.domElement.setPointerCapture(s.pointerId),W=!0),s.pointerType==="touch"?rt(s):st(s))},this.onPointerUp=s=>{this.enabled!==!1&&(W=!1,s.pointerType==="touch"?at():ot(),me(s),y.length===0&&(this.domElement.releasePointerCapture(s.pointerId),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)))},this.onPointerCancel=s=>{me(s)};const it=s=>{let u;switch(s.button){case 0:u=this.mouseButtons.LEFT;break;case 1:u=this.mouseButtons.MIDDLE;break;case 2:u=this.mouseButtons.RIGHT;break;default:u=-1}switch(u){case t.MOUSE.DOLLY:if(this.enableZoom===!1)return;We(s),a=i.DOLLY;break;case t.MOUSE.ROTATE:if(s.ctrlKey||s.metaKey||s.shiftKey){if(this.enablePan===!1)return;re(s),a=i.PAN}else{if(this.enableRotate===!1)return;ne(s),a=i.ROTATE}break;case t.MOUSE.PAN:if(s.ctrlKey||s.metaKey||s.shiftKey){if(this.enableRotate===!1)return;ne(s),a=i.ROTATE}else{if(this.enablePan===!1)return;re(s),a=i.PAN}break;default:a=i.NONE}a!==i.NONE&&this.dispatchEvent({type:"start"})},st=s=>{if(this.enabled!==!1)switch(a){case i.ROTATE:if(this.enableRotate===!1)return;Qe(s);break;case i.DOLLY:if(this.enableZoom===!1)return;Xe(s);break;case i.PAN:if(this.enablePan===!1)return;Ze(s);break}},ot=s=>{this.dispatchEvent({type:"end"}),a=i.NONE};this.onMouseWheel=s=>{this.enabled===!1||this.enableZoom===!1||a!==i.NONE||(s.preventDefault(),this.dispatchEvent({type:"start"}),$e(s),this.dispatchEvent({type:"end"}))},this.onKeyDown=s=>{this.enabled===!1||this.enablePan===!1||qe(s)};const nt=s=>{switch(pe(s),y.length){case 1:switch(this.touches.ONE){case t.TOUCH.ROTATE:if(this.enableRotate===!1)return;ae(),a=i.TOUCH_ROTATE;break;case t.TOUCH.PAN:if(this.enablePan===!1)return;le(),a=i.TOUCH_PAN;break;default:a=i.NONE}break;case 2:switch(this.touches.TWO){case t.TOUCH.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;Ke(),a=i.TOUCH_DOLLY_PAN;break;case t.TOUCH.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;Je(),a=i.TOUCH_DOLLY_ROTATE;break;default:a=i.NONE}break;default:a=i.NONE}a!==i.NONE&&this.dispatchEvent({type:"start"})},rt=s=>{switch(pe(s),a){case i.TOUCH_ROTATE:if(this.enableRotate===!1)return;ce(s),this.update();break;case i.TOUCH_PAN:if(this.enablePan===!1)return;ue(s),this.update();break;case i.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;et(s),this.update();break;case i.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;tt(s),this.update();break;default:a=i.NONE}},at=s=>{this.dispatchEvent({type:"end"}),a=i.NONE};this.onContextMenu=s=>{this.enabled!==!1&&s.preventDefault()};function lt(s){y.push(s)}const me=s=>{delete G[s.pointerId];for(let u=0;u<y.length;u++)if(y[u].pointerId==s.pointerId){y.splice(u,1);return}};function pe(s){let u=G[s.pointerId];u===void 0&&(u=new t.Vector2,G[s.pointerId]=u),u.set(s.pageX,s.pageY)}function Q(s){const u=s.pointerId===y[0].pointerId?y[1]:y[0];return G[u.pointerId]}this.spherical=l,this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),this.domElement.addEventListener("wheel",this.onMouseWheel,{passive:!1}),this.reset=()=>{this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent({type:"change"}),this.update(),a=i.NONE},this.update()}getPolarAngle(){return this.spherical.phi}getAzimuthalAngle(){return this.spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this.onKeyDown),this._domElementKeyEvents=e}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}setCamera(e){this.object=e}setDom(e){this.dispose(),this.domElement=e,this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),this.domElement.addEventListener("wheel",this.onMouseWheel,{passive:!1})}dispose(){this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointercancel",this.onPointerCancel),this.domElement.removeEventListener("wheel",this.onMouseWheel),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp),this._domElementKeyEvents!==null&&this._domElementKeyEvents.removeEventListener("keydown",this.onKeyDown)}}class Ce{}class Le{constructor(r="rgb(230, 20, 240)",e="rgba(230, 20, 240, 0.15)"){n(this,"element");n(this,"startPoint");n(this,"pointTopLeft");n(this,"pointBottomRight");n(this,"isDown");const o=document.createElement("div");o.style.pointerEvents="none",o.style.border=`1px solid ${r}`,o.style.position="fixed",o.style.zIndex="100",o.style.backgroundColor=e,this.element=o,this.startPoint=new t.Vector2,this.pointTopLeft=new t.Vector2,this.pointBottomRight=new t.Vector2,this.isDown=!1}onSelectStart(r){this.isDown=!0,document.body.appendChild(this.element),this.element.style.left=r.clientX+"px",this.element.style.top=r.clientY+"px",this.element.style.width="0px",this.element.style.height="0px",this.startPoint.x=r.clientX,this.startPoint.y=r.clientY}onSelectMove(r){!this.isDown||(this.pointBottomRight.x=Math.max(this.startPoint.x,r.clientX),this.pointBottomRight.y=Math.max(this.startPoint.y,r.clientY),this.pointTopLeft.x=Math.min(this.startPoint.x,r.clientX),this.pointTopLeft.y=Math.min(this.startPoint.y,r.clientY),this.element.style.left=this.pointTopLeft.x+"px",this.element.style.top=this.pointTopLeft.y+"px",this.element.style.width=this.pointBottomRight.x-this.pointTopLeft.x+"px",this.element.style.height=this.pointBottomRight.y-this.pointTopLeft.y+"px")}onSelectOver(r){!this.isDown||(this.isDown=!1,document.body.removeChild(this.element))}}class De{constructor(r){n(this,"REVISION");n(this,"dom");n(this,"addPanel");n(this,"showPanel");n(this,"begin");n(this,"end");n(this,"update");n(this,"domElement");n(this,"setMode");const e=Se.default();this.REVISION=e.REVISION,this.dom=e.dom,this.domElement=e.domElement,this.begin=e.begin.bind(e),this.end=e.end.bind(e),this.update=e.update.bind(e),this.addPanel=e.addPanel.bind(e),this.showPanel=e.showPanel.bind(e),this.setMode=e.setMode.bind(e);const o=this.domElement;o.style.position="absolute",o.style.top="0",o.style.left="35px",r&&(o.style.top=`${r.top}px`,o.style.left=`${r.left}px`,o.style.right=`${r.right}px`,o.style.bottom=`${r.bottom}px`)}}c.TRANSFORM_EVENT=void 0,function(d){d.CHANGED="changed",d.MOUSE_DOWN="mouseDown",d.CHANGEING="changing",d.MOUSE_UP="mouseUp"}(c.TRANSFORM_EVENT||(c.TRANSFORM_EVENT={}));class Oe extends ve.TransformControls{constructor(e,o){!e&&(e=new t.PerspectiveCamera),!o&&(o=document.body);super(e,o);n(this,"target");n(this,"transObjectSet");this.domElement.removeEventListener("pointerdown",this._onPointerDown),this._onPointerDown=g=>{var f;!this.enabled||!((f=this.object)!=null&&f.parent)||(this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(g)),this.pointerDown(this._getPointer(g)))},this.domElement.addEventListener("pointerdown",this._onPointerDown),this.target=new t.Object3D,this.transObjectSet=new Set;let i="";const a=this.target,h=this.transObjectSet,l={x:0,y:0,z:0},p=new WeakMap;this.addEventListener(c.TRANSFORM_EVENT.MOUSE_DOWN,g=>{i=g.target.mode,i==="translate"&&(i="position"),i==="rotate"&&(i="rotation"),l.x=a[i].x,l.y=a[i].y,l.z=a[i].z,h.forEach(f=>{p.set(f,f.matrixAutoUpdate),f.matrixAutoUpdate=!1})}),this.addEventListener(c.TRANSFORM_EVENT.CHANGEING,g=>{const f=a[i].x-l.x,m=a[i].y-l.y,T=a[i].z-l.z;l.x=a[i].x,l.y=a[i].y,l.z=a[i].z,h.forEach(S=>{S[i].x+=f,S[i].y+=m,S[i].z+=T,S.updateMatrix(),S.updateMatrixWorld()}),this.dispatchEvent({type:c.TRANSFORM_EVENT.CHANGED,transObjectSet:h,mode:i,target:a})}),this.addEventListener(c.TRANSFORM_EVENT.MOUSE_UP,g=>{h.forEach(f=>{f.matrixAutoUpdate=p.get(f),p.delete(f)})})}setDom(e){return this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),e.addEventListener("pointerdown",this._onPointerDown),e.addEventListener("pointermove",this._onPointerHover),e.addEventListener("pointerup",this._onPointerUp),this.domElement=e,this}setCamera(e){return this.camera=e,this}getTarget(){return this.target}getTransObjectSet(){return this.transObjectSet}setAttach(...e){if(this.transObjectSet.clear(),!e.length||!e[0])return this.detach(),this;this.attach(this.target);const o=this.target;if(e.length===1){const l=e[0];return l.matrixWorld.decompose(o.position,o.quaternion,o.scale),o.updateMatrix(),o.updateMatrixWorld(),this.transObjectSet.add(l),this}const i=[],a=[],h=[];return e.forEach(l=>{i.push(l.matrixWorld.elements[12]),a.push(l.matrixWorld.elements[13]),h.push(l.matrixWorld.elements[14])}),o.rotation.set(0,0,0),o.scale.set(0,0,0),o.position.x=(Math.max(...i)-Math.min(...i))/2+Math.min(...i),o.position.y=(Math.max(...a)-Math.min(...a))/2+Math.min(...a),o.position.z=(Math.max(...h)-Math.min(...h))/2+Math.min(...h),o.updateMatrix(),o.updateMatrixWorld(),e.forEach(l=>{this.transObjectSet.add(l)}),this}}class Be extends t.Texture{constructor(r,e,o,i,a,h,l,p,g,f){super(r,e,o,i,a,h,l,p,g,f)}}class Re extends t.Texture{constructor(r){super(),Object.keys(r).forEach(e=>{this[e]=r[e]}),this.copy(r)}}const k=class extends Z.Pass{constructor(e=new t.Vector2(256,256),o=1,i=0,a=0,h=new t.Scene,l=new t.PerspectiveCamera,p){super();n(this,"resolution");n(this,"strength");n(this,"radius");n(this,"threshold");n(this,"selectedObjects",[]);n(this,"renderScene");n(this,"renderCamera");n(this,"clearColor",new t.Color(0,0,0));n(this,"renderTargetsHorizontal",[]);n(this,"renderTargetsVertical",[]);n(this,"nMips",5);n(this,"selectRenderTarget");n(this,"renderTargetBright");n(this,"highPassUniforms");n(this,"materialHighPassFilter");n(this,"separableBlurMaterials",[]);n(this,"compositeMaterial");n(this,"bloomTintColors");n(this,"mixMaterial");n(this,"enabled",!0);n(this,"needsSwap",!1);n(this,"_oldClearColor",new t.Color);n(this,"oldClearAlpha",1);n(this,"basic",new t.MeshBasicMaterial);n(this,"fsQuad",new Z.FullScreenQuad);n(this,"materialCache",new Map);n(this,"sceneBackgroundCache",null);n(this,"overrideBackground",new t.Color("black"));n(this,"overrideMeshMaterial",new t.MeshBasicMaterial({color:"black"}));n(this,"overrideLineMaterial",new t.LineBasicMaterial({color:"black"}));n(this,"overridePointsMaterial",new t.PointsMaterial({color:"black"}));n(this,"overrideSpriteMaterial",new t.SpriteMaterial({color:"black"}));this.resolution=e,this.strength=o,this.radius=i,this.threshold=a,this.renderScene=h,this.renderCamera=l,this.selectedObjects=p;let g=Math.round(this.resolution.x/2),f=Math.round(this.resolution.y/2);this.selectRenderTarget=new t.WebGLRenderTarget(g,f),this.selectRenderTarget.texture.name="UnrealBloomPass.selected",this.selectRenderTarget.texture.generateMipmaps=!1,this.renderTargetBright=new t.WebGLRenderTarget(g,f),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let v=0;v<this.nMips;v++){const w=new t.WebGLRenderTarget(g,f);w.texture.name="UnrealBloomPass.h"+v,w.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(w);const M=new t.WebGLRenderTarget(g,f);M.texture.name="UnrealBloomPass.v"+v,M.texture.generateMipmaps=!1,this.renderTargetsVertical.push(M),g=Math.round(g/2),f=Math.round(f/2)}$.LuminosityHighPassShader===void 0&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const m=$.LuminosityHighPassShader;this.highPassUniforms=t.UniformsUtils.clone(m.uniforms),this.highPassUniforms.luminosityThreshold.value=a,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new t.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,defines:{}});const T=[3,5,7,9,11];g=Math.round(this.resolution.x/2),f=Math.round(this.resolution.y/2);for(let v=0;v<this.nMips;v++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(T[v])),this.separableBlurMaterials[v].uniforms.texSize.value=new t.Vector2(g,f),g=Math.round(g/2),f=Math.round(f/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=o,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;const S=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=S,this.bloomTintColors=[new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,this.mixMaterial=this.getMixMaterial()}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,o){let i=Math.round(e/2),a=Math.round(o/2);this.selectRenderTarget.setSize(i,a),this.renderTargetBright.setSize(i,a);for(let h=0;h<this.nMips;h++)this.renderTargetsHorizontal[h].setSize(i,a),this.renderTargetsVertical[h].setSize(i,a),this.separableBlurMaterials[h].uniforms.texSize.value=new t.Vector2(i,a),i=Math.round(i/2),a=Math.round(a/2)}render(e,o,i,a,h){if(!this.selectedObjects.length){this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e));return}e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const l=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),h&&e.state.buffers.stencil.setTest(!1);const p=new Map;for(const m of this.selectedObjects)p.set(m,!0);const g=this.materialCache;this.renderScene.background&&(this.sceneBackgroundCache=this.renderScene.background,this.renderScene.background=this.overrideBackground),this.renderScene.traverse(m=>{!p.has(m)&&!m.isLight&&m.visible&&(g.set(m,m.material),m instanceof t.Mesh?m.material=this.overrideMeshMaterial:m instanceof t.Line?m.material=this.overrideLineMaterial:m instanceof t.Points?m.material=this.overridePointsMaterial:m instanceof t.Sprite&&(m.material=this.overrideSpriteMaterial))}),e.setRenderTarget(this.selectRenderTarget),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=this.selectRenderTarget.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=this.selectRenderTarget.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let f=this.renderTargetBright;for(let m=0;m<this.nMips;m++)this.fsQuad.material=this.separableBlurMaterials[m],this.separableBlurMaterials[m].uniforms.colorTexture.value=f.texture,this.separableBlurMaterials[m].uniforms.direction.value=k.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[m]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[m].uniforms.colorTexture.value=this.renderTargetsHorizontal[m].texture,this.separableBlurMaterials[m].uniforms.direction.value=k.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[m]),e.clear(),this.fsQuad.render(e),f=this.renderTargetsVertical[m];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.mixMaterial,this.mixMaterial.uniforms.bloom.value=this.renderTargetsHorizontal[0].texture,this.mixMaterial.uniforms.origin.value=i.texture,h&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(i),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=l;for(const m of g.entries())m[0].material=m[1];g.clear(),this.sceneBackgroundCache&&(this.renderScene.background=this.sceneBackgroundCache,this.sceneBackgroundCache=null)}getMixMaterial(){return new t.ShaderMaterial({blending:t.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0,uniforms:{bloom:{value:null},origin:{value:null}},vertexShader:`
    
        varying vec2 vUv;
    
        void main() {
    
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    
        }`,fragmentShader:`
        uniform sampler2D bloom;
        uniform sampler2D origin;
    
        varying vec2 vUv;
    
        void main() {
          vec3 bloomColor = texture2D(bloom, vUv).rgb;
          vec3 originColor = texture2D(origin, vUv).rgb;
          gl_FragColor = vec4(originColor + bloomColor, 1.0);
        }`})}getSeperableBlurMaterial(e){return new t.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new t.Vector2(.5,.5)},direction:{value:new t.Vector2(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}
				void main() {
					vec2 invSize = 1.0 / texSize;
					float fSigma = float(SIGMA);
					float weightSum = gaussianPdf(0.0, fSigma);
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianPdf(x, fSigma);
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new t.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}};let j=k;n(j,"BlurDirectionX",new t.Vector2(1,0)),n(j,"BlurDirectionY",new t.Vector2(0,1));class Ae extends K{constructor(e=document.createElement("div")){super(e);n(this,"cacheBox",new t.Box3);n(this,"viewWorldMatrix",new t.Matrix4);n(this,"mvPosition",new t.Vector3);n(this,"matrixScale",new t.Vector3);n(this,"worldScale",new t.Vector3);n(this,"vA",new t.Vector3);n(this,"vB",new t.Vector3);n(this,"vC",new t.Vector3);n(this,"alignedPosition",new t.Vector2);n(this,"rotatedPosition",new t.Vector2);n(this,"intersectPoint",new t.Vector3);this.type="CSS2DPlane",this.element.classList.add("vis-css2d","vis-css2d-plane"),new MutationObserver(()=>{this.matrixScale.set(Math.abs(this.width/100)*.1,Math.abs(this.height/100)*.1,1)}).observe(this.element,{attributeFilter:["style"]})}transformVertex(e,o,i){const a=this.alignedPosition,h=this.rotatedPosition,l=0,p=1;a.copy(e).multiply(i),h.x=p*a.x-l*a.y,h.y=l*a.x+p*a.y,e.copy(o),e.x+=h.x,e.y+=h.y,e.applyMatrix4(this.viewWorldMatrix)}raycast(e,o){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),this.viewWorldMatrix.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),this.mvPosition.setFromMatrixPosition(this.modelViewMatrix),this.worldScale.copy(this.matrixScale).multiplyScalar(-this.mvPosition.z),this.transformVertex(this.vA.set(-.5,-.5,0),this.mvPosition,this.worldScale),this.transformVertex(this.vB.set(.5,-.5,0),this.mvPosition,this.worldScale),this.transformVertex(this.vC.set(.5,.5,0),this.mvPosition,this.worldScale);let i=e.ray.intersectTriangle(this.vA,this.vB,this.vC,!1,this.intersectPoint);if(i===null&&(this.transformVertex(this.vB.set(-.5,.5,0),this.mvPosition,this.worldScale),i=e.ray.intersectTriangle(this.vA,this.vC,this.vB,!1,this.intersectPoint),i===null))return;const a=e.ray.origin.distanceTo(this.intersectPoint);a<e.near||a>e.far||o.push({distance:a,point:this.intersectPoint.clone(),face:null,object:this})}}class Ve extends J{constructor(e=document.createElement("div")){super(e);n(this,"cacheBox",new t.Box3);this.type="CSS3DPlane",this.element.classList.add("vis-css3d","vis-css3d-plane")}raycast(e,o){const i=this.cacheBox.copy(this.geometry.boundingBox);i.applyMatrix4(this.matrixWorld),e.ray.intersectsBox(i)&&o.push({distance:e.ray.origin.distanceTo(this.position),object:this,point:this.position})}}class _e extends ee{constructor(r=document.createElement("div")){super(r),this.type="CSS3DSprite",this.element.classList.add("vis-css3d","vis-css3d-plane")}}class Ue extends t.BufferGeometry{constructor(e){super();n(this,"type","LoadBufferGeometry");e&&this.copy(e)}}class z extends t.BufferGeometry{constructor(e=[],o=36,i=!0){super();n(this,"parameters");this.type="CurveGeometry",this.parameters={path:e.map(a=>a.clone()),space:i,divisions:o}}}class je extends z{constructor(r=[],e=36,o=!0){super(r,e,o),this.type="CubicBezierCurveGeometry";const i=new t.CurvePath;if(r.length<4){console.warn("CubicBezierCurveGeometry path length at least 4.");return}const a=4+(r.length-4)-(r.length-4)%3;for(let l=2;l<a;l+=3)i.add(new t.CubicBezierCurve3(r[l-2],r[l-1],r[l],r[l+1]));const h=i.curves.reduce((l,p)=>l+=p.arcLengthDivisions,0);if(e>h){const l=Math.ceil((e-h)/i.curves.length);i.curves.forEach(p=>{p.arcLengthDivisions=p.arcLengthDivisions*(l+1),p.updateArcLengths()})}this.setFromPoints(o?i.getSpacedPoints(e):i.getPoints(e))}}class ze extends z{constructor(r=[],e=36,o=!0){if(super(r,e,o),this.type="LineCurveGeometry",!r.length){console.warn("LineCurveGeometry path length at least 1.");return}const i=new t.CurvePath;for(let h=1;h<r.length;h+=1)i.add(new t.LineCurve3(r[h-1],r[h]));const a=i.curves.reduce((h,l)=>h+=l.arcLengthDivisions,0);if(e>a){const h=Math.ceil((e-a)/i.curves.length);i.curves.forEach(l=>{l.arcLengthDivisions=l.arcLengthDivisions*(h+1),l.updateArcLengths()})}this.setFromPoints(o?i.getSpacedPoints(e):i.getPoints(e))}}class Ne extends z{constructor(r=[],e=36,o=!0){super(r,e,o),this.type="QuadraticBezierCurveGeometry";const i=new t.CurvePath;if(r.length<3){console.warn("QuadraticBezierCurveGeometry path length at least 3.");return}const a=3+(r.length-3)-(r.length-3)%2;for(let l=1;l<a;l+=2)i.add(new t.QuadraticBezierCurve3(r[l-1],r[l],r[l+1]));const h=i.curves.reduce((l,p)=>l+=p.arcLengthDivisions,0);if(e>h){const l=Math.ceil((e-h)/i.curves.length);i.curves.forEach(p=>{p.arcLengthDivisions=p.arcLengthDivisions*(l+1),p.updateArcLengths()})}this.setFromPoints(o?i.getSpacedPoints(e):i.getPoints(e))}}class ke extends z{constructor(r=[],e=36,o=!0){if(super(r,e,o),this.type="SplineCurveGeometry",!r.length){console.warn("SplineCurveGeometry path length at least 1.");return}const i=new t.CatmullRomCurve3(r);this.setFromPoints(o?i.getSpacedPoints(e):i.getPoints(e))}}class Ge extends t.ShapeBufferGeometry{constructor(r=[new t.Vector2(0,0)],e=12){const o=new t.Shape,i=r[0];if(i){o.moveTo(i.x,i.y);for(let a=1;a<r.length;a+=1)o.lineTo(r[a].x,r[a].y)}super(o,e),this.type="LineShapeGeometry"}}class He extends t.TubeGeometry{constructor(r=[],e=64,o=1,i=8,a=!1){if(!r.length){console.warn("LineTubeGeometry path length at least 1.");return}const h=new t.CurvePath;for(let l=1;l<r.length;l+=1)h.add(new t.LineCurve3(r[l-1],r[l]));super(h,e,o,i,a),this.type="LineTubeGeometry"}}class Ie extends t.TubeGeometry{constructor(r=[],e=64,o=1,i=8,a=!1){if(!r.length){console.warn("SplineTubeGeometry path length at least 1.");return}const h=new t.CatmullRomCurve3(r);super(h,e,o,i,a),this.type="SplineTubeGeometry"}}const B=class extends t.Loader{constructor(r){super(r)}load(r,e,o,i){this.path!==void 0&&(r=this.path+r),this.manager.itemStart(r),r=this.manager.resolveURL(r);const a=t.Cache.get(r);if(a!==void 0)return setTimeout(()=>{e&&e(a),this.manager.itemEnd(r)},0),a;const h=document.createElement("video");return h.preload=B.preload,h.autoplay=B.autoplay,h.loop=B.loop,h.muted=B.muted,h.src=r,h.style.position="fixed",h.style.top="0",h.style.left="0",h.style.zIndex="-1",document.body.appendChild(h),h.oncanplay=()=>{t.Cache.add(r,h),this.manager.itemEnd(r),e&&e(h)},h.onerror=l=>{this.manager.itemEnd(r),i&&i(l)},h}};let O=B;n(O,"autoplay",!0),n(O,"preload","auto"),n(O,"muted",!0),n(O,"loop",!0);const Fe=function(d){return()=>d};c.CSS2DPlane=Ae,c.CSS3DPlane=Ve,c.CSS3DSprite=_e,c.CubicBezierCurveGeometry=je,c.CurveGeometry=z,c.ENGINE_EVENT=q,c.Engine=we,c.EventDispatcher=I,c.ImageTexture=Be,c.LineCurveGeometry=ze,c.LineShapeGeometry=Ge,c.LineTubeGeometry=He,c.LoadGeometry=Ue,c.LoadTexture=Re,c.QuadraticBezierCurveGeometry=Ne,c.SelectiveBloomPass=j,c.SplineCurveGeometry=ke,c.SplineTubeGeometry=Ie,c.VideoLoader=O,c.VideoTexture=Pe,c.VisCSS2DObject=K,c.VisCSS3DObject=J,c.VisCSS3DSprite=ee,c.VisOrbitControls=Ee,c.VisSelectionBox=Ce,c.VisSelectionHelper=Le,c.VisStats=De,c.VisTransformControls=Oe,c.definePlugin=Me,c.defineStrategy=Fe,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
