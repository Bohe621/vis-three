(function(i,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("@vis-three/tdcm"),require("three"),require("@vis-three/utils")):typeof define=="function"&&define.amd?define(["exports","@vis-three/tdcm","three","@vis-three/utils"],t):(i=typeof globalThis<"u"?globalThis:i||self,t((i["vis-three"]=i["vis-three"]||{},i["vis-three"]["module-animation-action"]={}),i.tdcm,i.three,i.utils))})(this,function(i,t,d,p){"use strict";const s=function(){return Object.assign(t.getBasicConfig(),{mixer:"",clip:"",clampWhenFinished:!0,enabled:!0,loop:d.LoopRepeat,paused:!1,repetitions:1/0,timeScale:1,weight:1,zeroSlopeAtEnd:!0,zeroSlopeAtStart:!0})},f=t.defineModel({type:"AnimationAction",config:s,commands:{set:{clip({model:e,target:n,config:o,value:r,engine:c,compiler:m}){n.getMixer().uncacheAction(n.getClip()),m.symbolMap.delete(n);const l=c.getObjectBySymbol(o.mixer);if(!l){console.warn(`animation action model can not found animation mixer in engine: ${o.mixer}`);return}const u=c.getObjectBySymbol(r);u||console.warn(`animation action model can not found animation clip in engine: ${r}`);const a=l.clipAction(u);a.play(),e.puppet=a,m.symbolMap.set(a,o.vid)}}},create({config:e,engine:n}){if(!e.mixer)return console.warn("animation action model must have mixer"),{};if(!e.clip)return{};const o=n.getObjectBySymbol(e.mixer);if(!o)return console.warn(`animation action model can not found animation mixer in engine: ${e.mixer}`),{};const r=n.getObjectBySymbol(e.clip);if(!r)return console.warn(`animation action model can not found animation clip in engine: ${e.clip}`),{};const c=o.clipAction(r);return p.syncObject(e,c,{clip:!0,mixer:!0}),c.play(),c},dispose({target:e}){const n=e.getMixer();n.uncacheAction(e.getClip()),n.uncacheClip(e.getClip())}}),h=t.defineModule({type:"animationAction",models:[f],lifeOrder:t.SUPPORT_LIFE_CYCLE.NINE+1});i.default=h,i.getAnimationActionConfig=s,Object.defineProperties(i,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
