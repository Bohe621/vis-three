(function(r,n){typeof exports=="object"&&typeof module!="undefined"?n(exports,require("@vis-three/middleware"),require("@vis-three/module-object"),require("three")):typeof define=="function"&&define.amd?define(["exports","@vis-three/middleware","@vis-three/module-object","three"],n):(r=typeof globalThis!="undefined"?globalThis:r||self,n((r["vis-three"]=r["vis-three"]||{},r["vis-three"]["module-camera"]={}),r.middleware,r.moduleObject,r.three))})(this,function(r,n,s,f){"use strict";var P=Object.defineProperty;var j=(r,n,s)=>n in r?P(r,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[n]=s;var u=(r,n,s)=>(j(r,typeof n!="symbol"?n+"":n,s),s);class p extends s.ObjectCompiler{constructor(){super();u(this,"cacheCameraMap",new WeakMap)}}function w(e){e.setCameraBySymbol=function(t){const i=this.compilerManager.getCompiler(n.MODULETYPE.CAMERA);return i.map.has(t)?this.setCamera(i.map.get(t)):console.warn("can not found camera",t),this}}const v=function(e,t){s.ObjectRule(e,t)},m=function(){return Object.assign(s.getObjectConfig(),{adaptiveWindow:!1,fov:45,aspect:1920/1080,near:5,far:50})},C=function(){return Object.assign(s.getObjectConfig(),{adaptiveWindow:!1,left:-window.innerWidth,right:window.innerWidth,top:window.innerHeight,bottom:-window.innerHeight,near:5,far:50,zoom:1})};var M=n.defineProcessor({type:"OrthographicCamera",config:C,commands:{add:{scale(){},...s.objectCommands.add},set:{scale(){},adaptiveWindow({target:e,value:t,engine:i,compiler:a}){if(t){if(!a.cacheCameraMap.has(t)){const o=c=>{const d=c.width,h=c.height;e.left=-d,e.right=d,e.top=h,e.bottom=-h,e.updateProjectionMatrix()};a.cacheCameraMap.set(e,o),i.addEventListener("setSize",o),o({type:"setSize",width:i.dom.offsetWidth,height:i.dom.offsetHeight})}}else{const o=a.cacheCameraMap.get(e);o&&(i.removeEventListener("setSize",o),a.cacheCameraMap.delete(e))}},...s.objectCommands.set,$reg:[{reg:new RegExp("left|right|top|bottom|near|far|zoom"),handler({target:e,key:t,value:i}){e[t]=i,e.updateProjectionMatrix()}}]},delete:{scale(){},...s.objectCommands.delete}},create(e,t,i){const a=new f.OrthographicCamera(-50,50,50,-50);if(s.objectCreate(a,e,{scale:!0,adaptiveWindow:!0},t),a.updateProjectionMatrix(),e.adaptiveWindow){const o=c=>{const d=c.width,h=c.height;a.left=-d,a.right=d,a.top=h,a.bottom=-h,a.updateProjectionMatrix()};i.cacheCameraMap.set(a,o),t.addEventListener("setSize",o),o({type:"setSize",width:t.dom.offsetWidth,height:t.dom.offsetHeight})}return a},dispose(e,t,i){i.cacheCameraMap.delete(e),s.objectDispose(e)}}),g=n.defineProcessor({type:"PerspectiveCamera",config:m,commands:{add:{scale(){},...s.objectCommands.add},set:{scale(){},adaptiveWindow({target:e,value:t,engine:i,compiler:a}){if(t){if(!a.cacheCameraMap.has(t)){const o=c=>{e.aspect=c.width/c.height,e.updateProjectionMatrix()};a.cacheCameraMap.set(e,o),i.addEventListener("setSize",o),o({type:"setSize",width:i.dom.offsetWidth,height:i.dom.offsetHeight})}}else{const o=a.cacheCameraMap.get(e);o&&(i.removeEventListener("setSize",o),a.cacheCameraMap.delete(e))}},...s.objectCommands.set,$reg:[{reg:new RegExp("fov|aspect|near|far"),handler({target:e,key:t,value:i}){e[t]=i,e.updateProjectionMatrix()}}]},delete:{scale(){},...s.objectCommands.delete}},create(e,t,i){const a=new f.PerspectiveCamera;if(s.objectCreate(a,e,{scale:!0,adaptiveWindow:!0},t),a.updateProjectionMatrix(),e.adaptiveWindow){const o=c=>{a.aspect=c.width/c.height,a.updateProjectionMatrix()};i.cacheCameraMap.set(a,o),t.addEventListener("setSize",o),o({type:"setSize",width:t.dom.offsetWidth,height:t.dom.offsetHeight})}return a},dispose(e,t,i){i.cacheCameraMap.delete(e),s.objectDispose(e)}}),l={type:"camera",object:!0,compiler:p,rule:v,processors:[M,g],extend:w,lifeOrder:n.SUPPORT_LIFE_CYCLE.THREE};r.CameraCompiler=p,r.default=l,r.getOrthographicCameraConfig=C,r.getPerspectiveCameraConfig=m,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
