(function(e,s){typeof exports=="object"&&typeof module!="undefined"?s(exports,require("@vis-three/middleware"),require("uuid"),require("three")):typeof define=="function"&&define.amd?define(["exports","@vis-three/middleware","uuid","three"],s):(e=typeof globalThis!="undefined"?globalThis:e||self,s((e["vis-three"]=e["vis-three"]||{},e["vis-three"]["module-curve"]={}),e.middleware,e.uuid,e.three))})(this,function(e,s,u,r){"use strict";var X=Object.defineProperty;var b=(e,s,u)=>s in e?X(e,s,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[s]=u;var d=(e,s,u)=>(b(e,typeof s!="symbol"?s+"":s,u),u);class h extends s.Compiler{constructor(){super()}}const R=function(t,c,o=u.validate){s.Rule(t,c,o)},C=function(){return Object.assign(s.getSymbolConfig(),{arcLengthDivisions:200})},p=function(){return Object.assign(C(),{startX:0,startY:0,vertical:5,clockwise:!1,endX:10,endY:10})},f=function(){return Object.assign(C(),{startX:0,startY:0,endX:10,endY:10})};class g extends r.EllipseCurve{constructor(o,a,n,v,y,w){super(0,0,1,1,0,Math.PI*2,!1,0);d(this,"start",new r.Vector2);d(this,"end",new r.Vector2);d(this,"vertical",0);d(this,"center",new r.Vector2);d(this,"tempVector",new r.Vector2);this.start.set(o,a),this.end.set(y,w),this.vertical=n;const l=this.tempVector,Y=this.start,V=this.end,O=new r.Vector2((y+o)/2,(w+a)/2),i=this.center.copy(this.end).sub(this.start);i.set(-i.y,i.x).negate().normalize().multiplyScalar(n).add(O),this.aX=i.x,this.aY=i.y,this.xRadius=l.copy(V).sub(i).length(),this.yRadius=this.xRadius,this.aStartAngle=l.copy(Y).sub(i).angle(),this.aEndAngle=l.copy(V).sub(i).angle(),this.aClockwise=v}}const m={reg:new RegExp(".*"),handler({config:t,target:c,processor:o,engine:a,compiler:n}){const v=o.create(t,a,n);n.map.set(t.vid,v),n.weakMap.set(v,t.vid),n.weakMap.delete(c),o.dispose(c,a,n)}};var A=s.defineProcessor({type:"ArcCurve",config:p,commands:{add:{},set:{$reg:[m]},delete:{}},create(t,c){return new g(t.startX,t.startY,t.vertical,t.clockwise,t.endX,t.endY)},dispose(){}}),L=s.defineProcessor({type:"LineCurve",config:f,commands:{add:{},set:{$reg:[m]},delete:{}},create(t,c){return new r.LineCurve(new r.Vector2(t.startX,t.startY),new r.Vector2(t.endX,t.endY))},dispose(){}}),P={type:"curve",compiler:h,rule:R,processors:[A,L],lifeOrder:s.SUPPORT_LIFE_CYCLE.ZERO-1};e.ArcCurve=g,e.CurveCompiler=h,e.default=P,e.getArcCurveConfig=p,e.getCurveConfig=C,e.getLineCurveConfig=f,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
