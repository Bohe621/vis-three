(function(s,i){typeof exports=="object"&&typeof module!="undefined"?i(exports,require("@vis-three/middleware"),require("@vis-three/module-solid-object"),require("three"),require("@vis-three/module-object")):typeof define=="function"&&define.amd?define(["exports","@vis-three/middleware","@vis-three/module-solid-object","three","@vis-three/module-object"],i):(s=typeof globalThis!="undefined"?globalThis:s||self,i((s["vis-three"]=s["vis-three"]||{},s["vis-three"]["module-line"]={}),s.middleware,s.moduleSolidObject,s.three,s.moduleObject))})(this,function(s,i,o,u,p){"use strict";class f extends o.SolidObjectCompiler{constructor(){super()}}const h=function(){return Object.assign(o.getSolidObjectConfig(),{geometry:"",material:"",dashed:!1})},r=new WeakMap,c=new WeakMap,d=function(e,n,t){c.has(n)?console.warn("Line processor has already exist geometry cache"):(c.set(n,t),i.Bus.compilerEvent.on(n,i.COMPILER_EVENT.UPDATE,t),r.set(e,n))},l=function(e,n){if(!c.has(n)){console.warn("Line processor found an error can not found cache geometry:",n);return}i.Bus.compilerEvent.off(n,i.COMPILER_EVENT.UPDATE,c.get(n)),c.delete(n),r.get(e)===n&&r.delete(e)},m=function(e,n){const t=r.get(e);if(!t){console.warn("line processor can not change line geometry");return}const a=c.get(t);l(e,t),d(e,n,a)};var L=i.defineProcessor({type:"Line",config:h,commands:{add:o.solidObjectCommands.add,set:{...o.solidObjectCommands.set,dashed({target:e,value:n}){if(e.material instanceof u.LineDashedMaterial&&n){const t=()=>{e.computeLineDistances()};d(e,e.geometry,t),t();return}n||l(e,e.geometry)},geometry(e){o.geometryHandler(e),m(e.target,e.target.geometry)}},delete:o.solidObjectCommands.delete},create(e,n){const t=o.solidObjectCreate(new u.Line,e,{dashed:!0},n);if(t.material instanceof u.LineDashedMaterial&&e.dashed){const a=()=>{t.computeLineDistances()};d(t,t.geometry,a),a()}return t},dispose:o.solidObjectDispose}),C={type:"line",object:!0,compiler:f,rule:function(e,n){p.ObjectRule(e,n)},processors:[L],lifeOrder:i.SUPPORT_LIFE_CYCLE.THREE};s.LineCompiler=f,s.default=C,s.getLineConfig=h,Object.defineProperties(s,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
