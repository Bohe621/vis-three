(function(e,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t(require("@vis-three/middleware"),require("uuid"),require("three")):typeof define=="function"&&define.amd?define(["@vis-three/middleware","uuid","three"],t):(e=typeof globalThis!="undefined"?globalThis:e||self,e["vis-three"]=e["vis-three"]||{},e["vis-three"]["module-shape"]=t(e.middleware,e.uuid,e.three))})(this,function(e,t,h){"use strict";class u extends e.Compiler{constructor(){super()}}const i=function(s,n,o=t.validate){e.Rule(s,n,o)},a=function(){return Object.assign(e.getSymbolConfig(),{shape:"",holes:[]})};var f=e.defineProcessor({type:"Shape",config:a,commands:{add:{holes({target:s,engine:n,value:o}){const r=n.compilerManager.getObjectfromModule(e.MODULETYPE.PATH,o);if(!r){console.warn(`shape processor can not found path: ${o}`);return}s.holes.push(r)}},set:{shape({target:s,engine:n,value:o}){const r=n.compilerManager.getObjectfromModule(e.MODULETYPE.PATH,o);r?s.curves=r.curves:console.warn(`shape processor can not found path: ${o}`)},holes({target:s,engine:n,path:o,value:r}){const c=Number(o[1]);if(!Number.isInteger(c)){console.warn("shape processor: delete holes error:",o);return}const p=n.compilerManager.getObjectfromModule(e.MODULETYPE.PATH,r);if(!p){console.warn(`shape processor can not found path: ${r}`);return}s.holes[c]=p}},delete:{holes({target:s,path:n}){const o=Number(n[1]);if(!Number.isInteger(o)){console.warn("shape processor: delete holes error:",n);return}s.holes.splice(o,1)}}},create(s,n){const o=new h.Shape;if(s.shape){const r=n.compilerManager.getObjectfromModule(e.MODULETYPE.PATH,s.shape);r?o.curves=r.curves:console.warn(`shape processor can not found path: ${s.shape}`)}if(s.holes.length)for(const r of s.holes){const c=n.compilerManager.getObjectfromModule(e.MODULETYPE.PATH,r);c?o.holes.push(c):console.warn(`shape processor can not found path: ${r}`)}return o},dispose(s){s.curves=[],s.holes=[]}}),l={type:"shape",compiler:u,rule:i,processors:[f],lifeOrder:e.SUPPORT_LIFE_CYCLE.ONE};return l});
