(function(t,r){typeof exports=="object"&&typeof module!="undefined"?module.exports=r(require("@vis-three/middleware"),require("@vis-three/module-object"),require("uuid"),require("three/examples/jsm/objects/Water"),require("three")):typeof define=="function"&&define.amd?define(["@vis-three/middleware","@vis-three/module-object","uuid","three/examples/jsm/objects/Water","three"],r):(t=typeof globalThis!="undefined"?globalThis:t||self,t["vis-three"]=t["vis-three"]||{},t["vis-three"]["module-water"]=r(t.middleware,t.moduleObject,t.uuid,t.Water,t.three))})(this,function(t,r,a,n,s){"use strict";class l extends r.ObjectCompiler{constructor(){super()}}const m=function(e,o,u=a.validate){r.ObjectRule(e,o,u)},c=function(){return Object.assign(r.getObjectConfig(),{geometry:"",textureWidth:512,textureHeight:512,waterNormals:"",waterColor:"rgb(127, 127, 127)",sunColor:"rgb(255, 255, 255)",sunDirection:{x:.70707,y:.70707,z:0},size:1,alpha:1,time:0,distortionScale:20,eye:{x:0,y:0,z:0},fog:!1})};new s.Color;var d=t.defineProcessor({type:"DeepWater",config:c,commands:{set:{geometry({value:e,target:o,engine:u}){const i=u.getObjectfromModule(t.MODULETYPE.GEOMETRY,e);if(!i){console.warn(`DeepWater processor: can not found geometry with:${e}`);return}o.geometry=i},waterNormals({value:e,target:o,engine:u}){const i=u.getObjectfromModule(t.MODULETYPE.TEXTURE,e);if(!i){console.warn(`DeepWater processor: can not found texture with:${e}`);return}o.material.uniforms.normalSampler.value=i},time(e){e.target.material.uniforms.time.value=e.value},size(e){e.target.material.uniforms.size.value=e.value},alpha(e){e.target.material.uniforms.alpha.value=e.value},distortionScale(e){e.target.material.uniforms.distortionScale.value=e.value},waterColor(e){e.target.material.uniforms.waterColor.value.setStyle(e.value)},sunColor(e){e.target.material.uniforms.waterColor.value.setStyle(e.value)},sunDirection(e){e.target.material.uniforms.sunDirection.value[e.key]=e.value},eye(e){e.target.material.uniforms.eye.value[e.key]=e.value}}},create(e,o){const u=new n.Water(o.getObjectfromModule(t.MODULETYPE.GEOMETRY,e.geometry),{textureWidth:e.textureWidth||512,textureHeight:e.textureHeight||512,waterNormals:o.getObjectfromModule(t.MODULETYPE.TEXTURE,e.waterNormals),waterColor:e.waterColor,sunColor:e.sunColor,sunDirection:new s.Vector3(e.sunDirection.x,e.sunDirection.y,e.sunDirection.z),alpha:e.alpha,time:e.time,distortionScale:e.distortionScale,eye:new s.Vector3(e.eye.x,e.eye.y,e.eye.z),fog:e.fog});return r.objectCreate(u,e,{geometry:!0,textureWidth:!0,textureHeight:!0,waterNormals:!0,waterColor:!0,sunColor:!0,sunDirection:!0,alpha:!0,time:!0,distortionScale:!0,eye:!0,fog:!0},o)},dispose(e){e.onBeforeRender=()=>{},e.material.dispose(),e.geometry=null,r.objectDispose(e)}}),h={type:"water",object:!0,compiler:l,rule:m,processors:[d],lifeOrder:t.SUPPORT_LIFE_CYCLE.THREE};return h});
