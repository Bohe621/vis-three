(function(r,s){typeof exports=="object"&&typeof module!="undefined"?s(exports,require("@vis-three/utils"),require("@vis-three/core"),require("keyboardjs")):typeof define=="function"&&define.amd?define(["exports","@vis-three/utils","@vis-three/core","keyboardjs"],s):(r=typeof globalThis!="undefined"?globalThis:r||self,s((r["vis-three"]=r["vis-three"]||{},r["vis-three"]["plugin-keyboard-manager"]={}),r.utils,r.core,r.keyboardjs))})(this,function(r,s,n,l){"use strict";var b=Object.defineProperty;var g=(r,s,n)=>s in r?b(r,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[s]=n;var c=(r,s,n)=>(g(r,typeof s!="symbol"?s+"":s,n),n);function y(a){return a&&typeof a=="object"&&"default"in a?a:{default:a}}var o=y(l);const f="@vis-three/plugin-keyboard-manager";class u extends n.EventDispatcher{constructor(){super();c(this,"map",new Map)}generateSymbol(e){return Array.isArray(e)?e.join(" + "):e.shortcutKey.join(" + ")}watch(e){return e?o.default.watch(void 0,e):o.default.watch(),this}register(e){const t=this.generateSymbol(e);return this.map.has(t)?(console.warn(`KeyboardManager: shortcutKey already exist: ${t}. desp: ${this.map.get(t).desp}`),this):(o.default.bind(t,e.keydown||null,e.keyup),this.map.set(t,e),this)}update(e){const t=this.generateSymbol(e);return this.map.has(t)?(this.cancel(e.shortcutKey),this.register(e),this):(console.warn("KeyboardManager: shortcutKey unregister then exec register function"),this.register(e),this)}cancel(e){const t=this.generateSymbol(e);if(this.map.has(t)){const d=this.map.get(t);o.default.unbind(t,d.keydown||null,d.keyup),this.map.delete(t)}return this}checkRepeat(e){const t=this.generateSymbol(e);return this.map.has(t)}getDocs(){const e=[];return this.map.forEach(t=>{e.push({shortcutKey:[].concat(t.shortcutKey),desp:t.desp})}),e}}const h=s.transPkgName(f),p=function(a){return{name:h,install(i){i.keyboardManager=new u,a&&a.keyboards&&a.keyboards.forEach(e=>{i.keyboardManager.register(e)})},dispose(i){i.keyboardManager.clear(),delete i.keyboardManager}}};r.KEYBOARD_MANAGER_PLUGIN=h,r.KeyboardManager=u,r.KeyboardManagerPlugin=p,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
