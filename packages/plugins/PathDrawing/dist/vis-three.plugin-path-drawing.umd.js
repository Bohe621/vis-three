(function(t,r){typeof exports=="object"&&typeof module!="undefined"?r(exports,require("@vis-three/core"),require("@vis-three/utils"),require("@vis-three/plugin-pointer-manager"),require("three")):typeof define=="function"&&define.amd?define(["exports","@vis-three/core","@vis-three/utils","@vis-three/plugin-pointer-manager","three"],r):(t=typeof globalThis!="undefined"?globalThis:t||self,r((t["vis-three"]=t["vis-three"]||{},t["vis-three"]["plugin-path-drawing"]={}),t.core,t.utils,t.pluginPointerManager,t.three))})(this,function(t,r,s,u,a){"use strict";var m=Object.defineProperty;var w=(t,r,s)=>r in t?m(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s;var h=(t,r,s)=>(w(t,typeof r!="symbol"?r+"":r,s),s);const c="@vis-three/plugin-path-drawing";class d extends r.EventDispatcher{constructor(){super();h(this,"camera",new a.OrthographicCamera(-window.innerWidth,window.innerWidth,window.innerHeight,-window.innerHeight,0,1e4));h(this,"plane",new a.Plane(new a.Vector3(0,0,1),0));h(this,"helper",new a.Mesh(new a.PlaneBufferGeometry(150,150),new a.MeshBasicMaterial({transparent:!0,opacity:.2,color:"rgb(64, 255, 242)"})));this.helper.raycast=()=>{},this.helper.matrixAutoUpdate=!1,this.setHelperMatrix()}offsetCamera(e){e.normalize().applyQuaternion(new a.Quaternion().setFromUnitVectors(new a.Vector3(0,1,0),this.plane.normal)),this.camera.position.copy(this.plane.normal).multiplyScalar(this.plane.constant).add(e),this.helper.position.add(e),this.helper.updateMatrix(),this.helper.updateMatrixWorld(!0)}setDrawPlane(e,o=0){return this.plane.set(e,o),this.setHelperMatrix(),this}setDrawPlaneByFace(e){return this.plane.setFromCoplanarPoints(e.a,e.b,e.c),this.setHelperMatrix(),this}setHelperMatrix(){const e=this.helper;e.position.copy(this.plane.normal).multiplyScalar(this.plane.constant),e.applyQuaternion(new a.Quaternion().setFromUnitVectors(new a.Vector3(0,0,1),this.plane.normal)),e.updateMatrix(),e.updateMatrixWorld(!0)}dispose(){this.helper.removeFromParent(),this.helper.geometry.dispose(),this.helper.material.dispose()}}const l=s.transPkgName(c),P=function(){return{name:l,deps:[u.POINTER_MANAGER_PLUGIN],install(i){const n=new d;i.pathSketcher=n,i.drawPathByPlane=function(e=new a.Vector3(0,0,1),o=0,p=new a.Vector3(0,50,0)){return n.setDrawPlane(e,o).offsetCamera(p),this.setCamera(n.camera),this},i.drawPathByFace=function(e,o=new a.Vector3(0,50,0)){return n.setDrawPlaneByFace(e).offsetCamera(o),this.setCamera(n.camera),this},i.getPathPoint=function(e){return this.pointerManager.intersectPlane(n.camera,n.plane,e||new a.Vector3)},i.getRelativePathPoint=function(e,o){const p=this.getPathPoint(o);return p&&p.applyMatrix4(e.invert())},i.addEventListener(r.ENGINE_EVENT.SETSCENE,e=>{e.scene.add(n.helper)})},dispose(i){i.pathSketcher.dispose(),delete i.pathSketcher,delete i.drawPathByPlane,delete i.getPathPoint,delete i.getRelativePathPoint}}};t.PATH_DRAWING_PLUGIN=l,t.PathDrawingPlugin=P,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
