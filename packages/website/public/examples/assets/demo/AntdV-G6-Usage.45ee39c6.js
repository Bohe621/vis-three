import"../modulepreload-polyfill.b7f2da20.js";import{aS as U}from"../three.53c13b85.js";import{C as $}from"../index.b0fe2ce4.js";import"../TextureDisplayer.d47ce54e.js";import{D as X}from"../index.cea36728.js";import{E as l,g as i,v as Z}from"../index.f4616ae6.js";import{d as J}from"../index.8051b4a0.js";import"../index.553ea369.js";import"../index.322afd23.js";import"../index.b6f9a1a5.js";import"../index.54dc275e.js";import{f as ee,m as te,b as ae,c as oe}from"../vector3To.8d7c08bb.js";import{r as re,d as se,G as W}from"../G6.cf5ff0af.js";import"../index.6949873b.js";import"../index.40bdee24.js";import"../index.e35148e2.js";import"../index.dc401cd6.js";import"../index.0ac2cd23.js";import"../index.d5cadf5a.js";import"../index.73cd6fe7.js";import"../index.c5c75baa.js";import"../index.d9d3455e.js";import"../UnrealBloomPass.3e69e790.js";import"../index.8445d065.js";import"../index.adb60d71.js";import"../index.26301b51.js";import"../Antdv.35288747.js";const ne={name:"addClass",params:{target:"",className:"",delay:0}},ie=function(e,t){const o=t.params,r=[];if(o.target==="all")e.scene.traverse(a=>{a instanceof J&&r.push(a)});else if(Array.isArray(o.target))o.target.forEach(a=>{const c=e.getObjectBySymbol(a);c?r.push(c):console.warn(`basic event AddClass: can not found vid object: ${o.target}`)});else{const a=e.getObjectBySymbol(o.target);if(!a)return console.warn(`basic event AddClass: can not found vid object: ${o.target}`),()=>{};if(!(a instanceof J))return console.warn("basic event AddClass: object is not a CSS3DObject."),()=>{};r.push(a)}return r.length?()=>{setTimeout(()=>{r.forEach(a=>{a.element.classList.add(o.className)})},o.delay)}:(console.warn(`basic event AddClass: can not found vid object: ${o.target}`),()=>{})};var le=Object.freeze(Object.defineProperty({__proto__:null,config:ne,generator:ie},Symbol.toStringTag,{value:"Module"}));const ce={name:"visibleObject",params:{target:"",visible:!0,delay:0}},de=function(e,t){const o=t.params,r=e.getObjectBySymbol(o.target);return r?()=>{setTimeout(()=>{r.visible=o.visible},o.delay)}:(console.warn(`basic event visibleObject: can not found vid object: ${o.target}`),()=>{})};var pe=Object.freeze(Object.defineProperty({__proto__:null,config:ce,generator:de},Symbol.toStringTag,{value:"Module"})),me=function(e){var t=typeof e;return e!==null&&t==="object"||t==="function"};const ge={A:"#9CFC72",B:"#44A5FF",C:"#FFBE4C"},fe={nodes:[{id:"1",label:"Company1"},{id:"2",label:"Company2"},{id:"3",label:"Company3"},{id:"4",label:"Company4"},{id:"5",label:"Company5"},{id:"8",label:"Company8"},{id:"9",label:"Company9"}],edges:[{source:"1",target:"2",data:{type:"A",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"1",target:"3",data:{type:"B",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"2",target:"5",data:{type:"C",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"3",target:"4",data:{type:"C",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"1",target:"8",data:{type:"B",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"1",target:"9",data:{type:"C",amount:"100,000 Yuan",date:"2019-08-03"}}]};re("round-rect",{drawShape:function(t,o){const r=t.style.width,a=t.style.stroke,c=o.addShape("rect",{attrs:{x:-r/2,y:-15,width:r,height:30,radius:15,stroke:a,lineWidth:3,fillOpacity:1},name:"rect-shape"});return o.addShape("circle",{attrs:{x:-r/2,y:0,r:3,fill:a},name:"circle-shape"}),o.addShape("circle",{attrs:{x:r/2,y:0,r:3,fill:a},name:"circle-shape2"}),c},getAnchorPoints:function(){return[[0,.5],[1,.5]]},update:function(t,o){const a=o.getContainer().get("children"),c=a[0],g=a[1],p=a[2],m=t.style.stroke;m&&(c.attr("stroke",m),g.attr("fill",m),p.attr("fill",m))}},"single-node");se("fund-polyline",{itemType:"edge",draw:function(t,o){const r=t.startPoint,a=t.endPoint,c=a.y-r.y,g=c!==0?Math.min(500/Math.abs(c),20):0,p=g>15?0:16,m=c<0?p:-p,u={x:r.x+g,y:a.y+m},h={x:u.x+p,y:a.y},N={x:(u.x-r.x)*(a.y-r.y)/(u.y-r.y)+r.x,y:a.y};let T=[["M",r.x,r.y],["L",u.x,u.y],["Q",N.x,N.y,h.x,h.y],["L",a.x,a.y]];Math.abs(c)<=5&&(T=[["M",r.x,r.y],["L",a.x,a.y]]);const M=(t==null?void 0:t.style)&&t.style.endArrow?t.style.endArrow:!1;me(M)&&(M.fill=stroke);const j=o.addShape("path",{attrs:{path:T,stroke:ge[t.data&&t.data.type],lineWidth:3,endArrow:M},name:"path-shape"}),b=0,k=8,_=o.addShape("text",{attrs:{text:t.data&&t.data.amount,x:h.x+b,y:a.y-k-2,fontSize:14,textAlign:"left",textBaseline:"middle",fill:"white"},name:"text-shape-amount"});return o.addShape("text",{attrs:{text:t.data&&t.data.type,x:h.x+b,y:a.y-k-_.getBBox().height-2,fontSize:10,textAlign:"left",textBaseline:"middle",fill:"white"},name:"text-shape-type"}),o.addShape("text",{attrs:{text:t.data&&t.data.date,x:h.x+b,y:a.y+k+4,fontSize:12,fontWeight:300,textAlign:"left",textBaseline:"middle",fill:"white"},name:"text-shape-date"}),j}});const v=document.createElement("div");v.style.width="1024px";v.style.height="1024px";v.style.position="absolute";v.style.opacity=0;v.className="g6-tree";document.body.appendChild(v);const F=new W({container:v,layout:{type:"dagre",rankdir:"LR",nodesep:30,ranksep:100},fitView:!0,modes:{default:["drag-canvas"]},defaultNode:{type:"round-rect",labelCfg:{style:{fill:"white",fontSize:10}},style:{stroke:"#72CC4A",width:150}},defaultEdge:{type:"fund-polyline"}});F.data(fe);F.render();const B=["rgb(91, 143, 249)","rgb(90, 216, 166)","rgb(93, 112, 146)","rgb(246, 189, 22)","rgb(232, 104, 74)","rgb(109, 200, 236)","rgb(146, 112, 202)","rgb(255, 157, 77)","rgb(38, 154, 153)","rgb(227, 137, 163)"],x=document.createElement("div");x.style.width="1024px";x.style.height="1024px";x.style.position="absolute";x.style.opacity=0;x.className="g6-tree";document.body.appendChild(x);const f=new W({container:x,linkCenter:!0,fitView:!0,modes:{default:[{type:"edge-tooltip",formatText:function(t){return"source: "+t.sourceName+"<br/> target: "+t.targetName}}]},defaultNode:{style:{opacity:.8,lineWidth:1,stroke:"#999"}},defaultEdge:{size:1,color:"#e2e2e2",style:{opacity:.6,lineAppendWidth:3}}});f.on("edge:mouseenter",function(e){const t=e.item;f.setItemState(t,"hover",!0)});f.on("edge:mouseleave",function(e){const t=e.item;f.setItemState(t,"hover",!1)});const ye=1024,Y=1024;fetch("https://gw.alipayobjects.com/os/basement_prod/70cde3be-22e8-4291-98f1-4d5a5b75b62f.json").then(e=>e.json()).then(e=>{const t=e.edges,o=e.nodes,r=new Map,a=new Map;let c=0;const g=o.length,p=10,m=[p,Y*.7],u=[ye-p,Y*.7],h=u[0]-m[0],N=u[1]-m[1],T=h/g,M=N/g;o.forEach(function(s,C){s.x=m[0]+C*T,s.y=m[1]+C*M,r.set(s.id,s),s.cluster&&a.get(s.cluster)===void 0&&(a.set(s.cluster,c),c++);const z=a.get(s.cluster);s.style?s.style.fill=B[z%B.length]:s.style={fill:B[z%B.length]},s.label=s.name,s.labelCfg={position:"bottom",offset:5,style:{rotate:Math.PI/2,textAlign:"start",fill:"white"}}}),t.forEach(s=>{s.type="arc";const C=r.get(s.source),z=r.get(s.target),I=(z.x-C.x)/T,K=(I<0?-1:1)*10*Math.ceil(Math.abs(I));s.curveOffset=K,s.color=C.style.fill,s.sourceName=C.name,s.targetName=z.name});let j=-9999,b=9999;o.forEach(function(s){j<s.value&&(j=s.value),b>s.value&&(b=s.value)}),ue(o,"size","value",[b,j],[3,25]),f.data(e),f.render(),typeof window!="undefined"&&(window.onresize=()=>{!f||f.get("destroyed")})});function ue(e,t,o,r,a){const c=a[1]-a[0],g=r[1]-r[0];e.forEach(function(p){p[t]=(p[o]-r[0])*c/g+a[0]})}const he=new $({width:512,height:256,bgColor:"rgb(0, 0, 0)"}).draw(e=>{e.textBaseline="middle",e.textAlign="center",e.fillStyle="rgb(0, 255, 0)",e.font=" bold 54px \u5FAE\u8F6F\u96C5\u9ED1",e.fillText("\u6811\u67B6\u6784\u56FE\u8C31",256,128)}),be=new $({width:512,height:256,bgColor:"rgb(0, 0, 0)"}).draw(e=>{e.textBaseline="middle",e.textAlign="center",e.fillStyle="rgb(0, 255, 0)",e.font=" bold 54px \u5FAE\u8F6F\u96C5\u9ED1",e.fillText("\u98DE\u7EBF\u67B6\u6784\u56FE\u8C31",256,128)});l.register(ee).register(te).register(ae).register(oe).register(pe).register(le);const ve=new $({width:256,height:256,bgColor:"rgb(0, 0, 0)"}).draw(e=>{const t=e.createLinearGradient(0,0,0,256);t.addColorStop(0,"rgb(0, 0, 255)"),t.addColorStop(1,"rgb(0, 100, 0)"),e.fillStyle=t,e.fillRect(0,0,256,256)}),A=new X().setDom(document.getElementById("app")).setSize().play();A.registerResources({hookAlpha:ve.getDom(),treeGraph:F.get("canvas").cfg.el,arcGraph:f.get("canvas").cfg.el,treeTips:he.getDom(),arcTips:be.getDom()});i.injectEngine=A;const xe=i("PerspectiveCamera",{far:1e4,position:{x:500,y:-300,z:500}});A.setCameraBySymbol(xe.vid).setSize();const Ce=i("Scene");A.setSceneBySymbol(Ce.vid);i.injectScene=!0;i("AmbientLight");const R=70,w=70,n=R/2,d=10,y=w*2,Se=i("CustomGeometry",{attribute:{position:[-n,0,-n,n,0,-n,n,0,n,-n,0,n,-n*d,y,-n*d,n*d,y,-n*d,n*d,y,n*d,-n*d,y,n*d],uv:[0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1],index:[0,4,5,5,1,0,1,5,6,6,2,1,2,6,7,7,3,2,3,7,4,4,0,3]},rotation:{x:Math.PI/2},position:{z:1}}),we=i("CanvasTexture",{url:"hookAlpha"}),Oe=i("MeshBasicMaterial",{color:"rgb(53, 193, 221)",side:U,alphaMap:we.vid,transparent:!0}),V=i("Mesh",{geometry:Se.vid,material:Oe.vid,visible:!1}),H=i("PlaneGeometry",{width:100,height:50,rotation:{x:Math.PI/2}}),Te=i("CanvasTexture",{url:"treeTips"}),Me=i("MeshBasicMaterial",{alphaMap:Te.vid,transparent:!0}),L=i("Mesh",{geometry:H.vid,material:Me.vid,position:{z:y+10,y:-n*d+20,x:n*d-50},visible:!1}),P=i("CSS3DPlane",{element:"treeGraph",width:1024,height:1024,scale:{x:.7,y:.7,z:.7},position:{z:y+10},visible:!1}),je=i("CanvasTexture",{url:"arcTips"}),ze=i("MeshBasicMaterial",{alphaMap:je.vid,transparent:!0}),D=i("Mesh",{geometry:H.vid,material:ze.vid,position:{z:y+120,y:-n*d+20,x:n*d-50},visible:!1}),O=i("CSS3DPlane",{element:"arcGraph",width:1024,height:1024,scale:{x:.7,y:.7,z:.7},position:{z:y+120},visible:!1}),Pe=i("Group",{children:[V.vid,L.vid,P.vid,D.vid,O.vid]}),E=6,S=10,G=5,Q=[],q=[];for(let e=0;e<=E*S-1;e+=1){const t=document.createElement("div");t.className="app-brick",t.innerHTML=`<span class="title">title:${e}</span>
        <span class="tips">tips:${e}</span>`,document.body.appendChild(t),A.registerResources({[`dom${e}`]:t});const o=Z();Q.push(o);const r={x:S*(w+G)*(e%S/S)-S*(w+G)/2,y:E*(w+G)*(Math.floor(e/S)/E)-E*(w+G)/2,z:0},a=i("CSS3DPlane",{vid:o,element:`dom${e}`,width:R,height:w,position:r,click:[l.generateConfig("focusObject",{params:{target:o,space:"local",offset:{y:-850,z:500}},back:!1}),l.generateConfig("moveTo",{params:{target:Pe.vid,position:{x:r.x,y:r.y,z:r.z},duration:0}}),l.generateConfig("moveFromTo",{params:{target:O.vid,to:{x:0,y:0,z:y+120},delay:500}}),l.generateConfig("moveFromTo",{params:{target:L.vid,to:JSON.parse(JSON.stringify(L.position)),delay:500}}),l.generateConfig("moveFromTo",{params:{target:P.vid,to:JSON.parse(JSON.stringify(P.position)),delay:500}}),l.generateConfig("moveFromTo",{params:{target:D.vid,to:JSON.parse(JSON.stringify(D.position)),delay:500}}),l.generateConfig("moveFromTo",{params:{target:O.vid,to:JSON.parse(JSON.stringify(O.position)),delay:500}}),l.generateConfig("fadeObject",{params:{target:V.vid,direction:"in",delay:500}}),l.generateConfig("fadeObject",{params:{target:D.vid,direction:"in",delay:500}}),l.generateConfig("visibleObject",{params:{target:O.vid,visible:!1}}),l.generateConfig("visibleObject",{params:{target:O.vid,visible:!0,delay:500}}),l.generateConfig("fadeObject",{params:{target:L.vid,direction:"in",delay:500}}),l.generateConfig("visibleObject",{params:{target:P.vid,visible:!1}}),l.generateConfig("visibleObject",{params:{target:P.vid,visible:!0,delay:500}}),l.generateConfig("addClass",{params:{target:o,className:"app-brick-focus"}})]});q.push(a)}q.forEach(e=>{const t=l.generateConfig("addClass",{params:{target:Q.filter(o=>o!==e.vid),className:"app-brick-fade"}});e.click.push(t)});
