import"../modulepreload-polyfill.b7f2da20.js";import{l as B}from"../loadingTips.44bbf382.js";import{K as M,t as E,bv as b,M as x,af as _,am as G,h as u,aj as R,aw as W,a as L}from"../three.53c13b85.js";import{m as z,M as A}from"../index.72f1cbc0.js";import{W as O,C as k}from"../index.40bdee24.js";import{R as H}from"../index.54dc275e.js";import{E as K}from"../index.0ac2cd23.js";import{b as I}from"../index.553ea369.js";import{O as T}from"../index.d5cadf5a.js";import{K as j,a as D}from"../index.c1c104be.js";import{S as U}from"../index.382e9bf2.js";import{E as q}from"../index.73cd6fe7.js";import{O as F}from"../index.c5c75baa.js";import{S as J}from"../index.0e5858b5.js";import{u as N}from"../index.8051b4a0.js";/* empty css               */import"../Antdv.35288747.js";const v=new u,P=new u,g=new M;new E;const l=new b,S=5,Q=20;let h=!1;const r=new x(new _(.5,.5,1),new G({color:"red"})),c=new u;r.geometry.translate(0,-.5,0);const y={radius:.5,segment:new b(new u,new u(0,-1,0))},a=N({plugins:[H({}),O({antialias:!0,alpha:!0}),K({WebGLMultisampleRenderTarget:!0}),k(),I({path:"/vis-three/examples/"}),T(),U(),A({visualizer:!0,shapecast:{intersectsBounds:o=>o.intersectsBox(g),intersectsTriangle:o=>{const i=v,s=P,d=o.closestPointToSegment(l,i,s);if(d<y.radius){const t=y.radius-d,n=s.sub(i).normalize();l.start.addScaledVector(n,t),l.end.addScaledVector(n,t)}}}}),j({target:r,movementSpeed:10,quickenSpeed:10,space:"world",extendKeyDown:o=>{switch(o.code){case"Space":h&&(c.y=Q);break}},beforeUpdate:({delta:o})=>{c.y+=h?0:o*-30,r.position.addScaledVector(c,o)}})],strategy:[q(),F(),D(),J()]}).setDom(document.getElementById("app")).setSize().setStats(!0);B(a);const C=()=>{c.y=0,r.position.set(47,0,90),a.camera.position.set(0,5,15),a.orbitControls.target.set(0,0,0)},V=new R("white",7);V.position.set(-5,5,10);a.scene.add(r,V);C();const X=new u;a.keyboardMoveControls.forwrad=o=>X.set(0,0,-1).applyAxisAngle(o.up,a.orbitControls.getAzimuthalAngle());const Y=o=>{r.updateMatrixWorld();const i=a.camera,s=a.orbitControls;g.makeEmpty(),l.copy(y.segment),l.start.applyMatrix4(r.matrixWorld),l.end.applyMatrix4(r.matrixWorld),g.expandByPoint(l.start),g.expandByPoint(l.end),g.min.addScalar(-y.radius),g.max.addScalar(y.radius),a.meshBVHManager.shapecast();const d=v;d.copy(l.start);const t=P;t.subVectors(d,r.position),h=t.y>Math.abs(o*c.y*.25);const n=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(n),r.position.add(t),h?c.set(0,0,0):(t.normalize(),c.addScaledVector(t,-t.dot(c))),r.position.y<-80&&C(),i.position.sub(s.target),s.target.copy(r.position),i.position.add(r.position)};a.keyboardMoveControls.addEventListener("afterUpdate",o=>{for(let i=0;i<S;i+=1)Y(o.delta/S)});a.loadResourcesAsync(["/model/glb/dungeon_low_poly_game_level_challenge/scene.gltf"]).then(o=>{const s=o.resourceMap.get("/model/glb/dungeon_low_poly_game_level_challenge/scene.gltf").scene;s.scale.setScalar(.03);const d=new M;d.setFromObject(s),d.getCenter(s.position).negate(),s.updateMatrixWorld(!0);const t={};s.traverse(e=>{if(!(/Boss/.test(e.name)||/Enemie/.test(e.name)||/Shield/.test(e.name)||/Sword/.test(e.name)||/Character/.test(e.name)||/Gate/.test(e.name)||/Cube/.test(e.name)||e.material&&e.material.color.r===1)&&e.isMesh){const f=e.material.color.getHex();t[f]=t[f]||[],t[f].push(e)}});const n=new W;for(const e in t){const f=t[e],w=[];if(f.forEach(p=>{if(p.material.emissive.r!==0)n.attach(p);else{const m=p.geometry.clone();m.applyMatrix4(p.matrixWorld),w.push(m)}}),w.length){const p=z(w),m=new x(p,new L({color:parseInt(e),shadowSide:2}));m.castShadow=!0,m.receiveShadow=!0,m.material.shadowSide=2,n.add(m)}}n.updateMatrixWorld(!0),n.traverse(e=>{e.geometry&&a.addBVH(e)}),a.scene.add(n),a.play()});window.engine=a;
