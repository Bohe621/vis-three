var m=Object.defineProperty;var v=(c,i,n)=>i in c?m(c,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):c[i]=n;var a=(c,i,n)=>(v(c,typeof i!="symbol"?i+"":i,n),n);import{a as f}from"./index.263b27ed.js";import{e as b,t as j,a as u}from"./index.4424140c.js";import{_ as y}from"./three.c9232d79.js";var E;(function(c){c.POINTERDOWN="pointerdown",c.POINTERUP="pointerup",c.POINTERMOVE="pointermove",c.POINTERENTER="pointerenter",c.POINTERLEAVE="pointerleave",c.CLICK="click",c.DBLCLICK="dblclick",c.CONTEXTMENU="contextmenu"})(E||(E={}));class O extends b{constructor(n){super();a(this,"raycaster");a(this,"scene");a(this,"camera");a(this,"filter",new Set);a(this,"recursive",!1);a(this,"penetrate",!1);a(this,"propagation",!1);a(this,"delegation",!1);this.raycaster=new y,this.camera=n.camera,this.scene=n.scene,n.recursive&&(this.recursive=n.recursive),n.penetrate&&(this.penetrate=n.penetrate)}setScene(n){return this.scene=n,this}setCamera(n){return this.camera=n,this}addFilterObject(n){return this.filter.add(n),this}removeFilterObject(n){return this.filter.delete(n),this}intersectObject(n){this.raycaster.setFromCamera(n,this.camera);const t=this.filter,l=this.scene.children.filter(p=>!t.has(p));return this.raycaster.intersectObjects(l,this.recursive)}use(n){const t=function(s,r){return Object.assign({},s,r)},l=(s,r)=>{const e=this.intersectObject(s.mouse);if(e.length)if(this.penetrate)for(const d of e)d.object.dispatchEvent(t(s,{type:r,intersection:d}));else{const d=e[0];d.object.dispatchEvent(t(s,{type:r,intersection:d}))}this.dispatchEvent(t(s,{type:r,intersections:e}))},p=["pointerdown","pointerup","mousedown","mouseup","pointermove","click","dblclick","contextmenu"];for(const s of p)n.addEventListener(s,r=>{l(r,s)});const h=new Map;let o=null;return n.addEventListener("pointermove",s=>{const r=this.intersectObject(s.mouse);if(this.penetrate){if(!r.length){h.forEach(e=>{e.object.dispatchEvent(t(s,{type:"pointerleave",intersection:e})),e.object.dispatchEvent(t(s,{type:"mouseleave",intersection:e}))}),h.clear();return}for(const e of r)h.has(e.object)?(e.object.dispatchEvent(t(s,{type:"pointermove",intersection:e})),e.object.dispatchEvent(t(s,{type:"mousemove",intersection:e})),h.delete(e.object)):(e.object.dispatchEvent(t(s,{type:"pointerenter",intersection:e})),e.object.dispatchEvent(t(s,{type:"mouseenter",intersection:e})));for(const e of h.values())e.object.dispatchEvent(t(s,{type:"pointerleave",intersection:e})),e.object.dispatchEvent(t(s,{type:"mouseleave",intersection:e}));h.clear();for(const e of r)h.set(e.object,e)}else{if(!r.length){o&&(o.object.dispatchEvent(t(s,{type:"pointerleave",intersection:o})),o.object.dispatchEvent(t(s,{type:"mouseleave",intersection:o})),o=null);return}const e=r[0];if(!o){e.object.dispatchEvent(t(s,{type:"pointerenter",intersection:e})),e.object.dispatchEvent(t(s,{type:"mouseenter",intersection:e})),o=e;return}if(e.object!==o.object){o.object.dispatchEvent(t(s,{type:"pointerleave",intersection:e})),o.object.dispatchEvent(t(s,{type:"mouseleave",intersection:e})),e.object.dispatchEvent(t(s,{type:"pointerenter",intersection:e})),e.object.dispatchEvent(t(s,{type:"mouseenter",intersection:e})),o=e;return}e.object===o.object&&(e.object.dispatchEvent(t(s,{type:"pointermove",intersection:e})),e.object.dispatchEvent(t(s,{type:"mousemove",intersection:e})))}this.dispatchEvent(t(s,{type:"pointermove",intersections:r})),this.dispatchEvent(t(s,{type:"mousemove",intersections:r}))}),this}}const C="@vis-three/event-manager-plugin",g=j(C),S=function(c){let i,n;return{name:g,deps:f,install(t){const l=new O(Object.assign({scene:t.scene,camera:t.camera},c));l.use(t.pointerManager),t.eventManager=l,i=p=>{t.eventManager.setCamera(p.camera)},n=p=>{t.eventManager.setScene(p.scene)},t.addEventListener(u.SETCAMERA,i),t.addEventListener(u.SETSCENE,n)},dispose(t){t.removeEventListener(u.SETCAMERA,i),t.removeEventListener(u.SETSCENE,n),i=void 0,n=void 0}}};export{S as E,E as a,g as b};
